!
! TEMPLATE NAME: FW VERSION 13 6300_us_mdf -- VERSION: 105 -- PILOT_BRANCH
!
hostname %_site_type%%_site_number%-MDF
allow-unsupported-transceiver
configuration-lockout central managed

user admin group administrators password ciphertext %adminpw%
user operator group operators password ciphertext %operpw%
user thd-operator group operators password ciphertext %thdoperpw%
user htsse group administrators password ciphertext AQBapfVQ+q3FO8cKuJ3kZYUt1Iq4f2RgbcHxUcSqUt6i+espYgAAAMkaDg3lq0utG9ucAAimcmUEecpiMFD6XADO/DiBZRMOtWmvGsIi5EHhrsK43/Kr4vdzfG1EpqUT2Cl66tlDefounAzQBub7C415c2tDcYM462cH87Uj4kgdAfsDlsUWrJk7


clock timezone %timezone%
router vrrp enable
router graceful-restart disable
%if is_badusb=Y%
no usb
%endif%
vrf broadband
vrf internet
ntp server %ntp_server_1% iburst
ntp enable
cli-session
    timeout 5
!
!
!-----Authentication Server-------
radius-server timeout 10
radius-server retries 2
radius-server tracking interval 60
aaa radius-attribute group radius
!
!-------NaaS Mgmt Radsec Servers--------
radius-server service-type in-access-request
radius-server host %radsec_server_1% tls tracking enable
!
!-------NaaS Mgmt Server Group--------
aaa group server radius thd-naas
    server %radsec_server_1% tls
crypto pki application radsec-client certificate device-identity
crypto pki ta-profile CPPM-ROOT-CA-THD
    ta-certificate
        -----BEGIN CERTIFICATE-----
        MIIDdzCCAl+gAwIBAgIQN6JSkcG1xpBNhRq7+j3mJjANBgkqhkiG9w0BAQsFADBC
        MRMwEQYKCZImiZPyLGQBGRYDb3JnMRMwEQYKCZImiZPyLGQBGRYDYW1zMRYwFAYD
        VQQDEw1hbXMtQUxGREMyLUNBMB4XDTIxMDcyMDE2NDcxM1oXDTI3MDcyMDE2NTcx
        MVowQjETMBEGCgmSJomT8ixkARkWA29yZzETMBEGCgmSJomT8ixkARkWA2FtczEW
        MBQGA1UEAxMNYW1zLUFMRkRDMi1DQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
        AQoCggEBAMs7PFx8Jzi2pdgVyfw6K8lYnj9E93pFh3Sldka34XCp0lJAsYLvAcoI
        JOldqJbFYGM/yeAcYl8S20DqmerIo8ZwWojq2R/j6T7GdkiGr1CWEVDWZr3ue1qv
        D0POYsCr7vjn/evfcHs4nEhyQcwbk5xCz2R7gm7T8pBDGMr5FUf8lBiWN5ZuoZJA
        yK7/XHuKz1kX+CxY4E0IJqM4YjHW2J0eleJpF6ErLkxBhiw5px4RGsM6cL7dM0Re
        ak5DkUjwPPKJQqlwlGfNfrcmGShT074m7i3MaEaO3br7oZ3PfkTDqw0ZJAMJ6sIT
        aPTj/NVyttSUtRIMfaMUZITktcLsZWsCAwEAAaNpMGcwEwYJKwYBBAGCNxQCBAYe
        BABDAEEwDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYE
        FGNVAK4pBqfuWIZ959Qwi44MS9FXMBAGCSsGAQQBgjcVAQQDAgEAMA0GCSqGSIb3
        DQEBCwUAA4IBAQApLtzKDms7AKwkWzCBtktmZsdv11ZqjL3TMvz+mXopxpMQG9Ac
        XBcN2FHM4JjQGXg/Iav9qkY1Cy2YBCSusxsiIE6oGJrlnDo1t9V2bSYsY32WZ2cK
        k/gMoOiinKLR8qXGN797qBSZrK0H7jdfDeOPTmDEWDZZWkFN97dXLo1wT9NjawVW
        dpK58GDFmzKSpIetLdB49wWOu94ASzudqz6okFptaREpQ5CVhslnQmv7AtZn9uuh
        oPYsR9BY2Mxi6oJ7zzLw1emiDliNjjAK4iUUhKjeN4p3oB2KlospazGioG1+Gm7p
        hAHdljkCYAiEnyJux6B6mQS8OLfJv6IcQnA5
        -----END CERTIFICATE-----
        END_OF_CERTIFICATE
aaa radius-attribute group thd-naas
    tunnel-private-group-id value static
    tunnel-private-group-id request-type both
    nas-ip-addr request-type both
    nas-ip-addr service-type user-management
!
aaa authentication allow-fail-through
aaa authentication login console group local thd-naas
aaa authentication login https-server group local thd-naas
aaa authentication login ssh group local thd-naas
aaa accounting all-mgmt ssh start-stop group thd-naas
!
logging %syslog_server_1%
ssh server vrf default
ssh server vrf mgmt
vsf split-detect mgmt
vsf secondary-member 2
vsf member 1
    type jl658a
    link 1 1/1/26
    link 2 1/1/25
vsf member 2
    type jl658a
    link 1 2/1/25
    link 2 2/1/26
banner motd #
No unauthorized changes should be made during store operational hours.
All after hour changes should go through the change notification process.
Please contact The Network Operation Center (x. 10110) or The Store
Network Engineering Team if you have any questions.#
banner exec #
*******************************************************************************
                                  WARNING:
           THIS SYSTEM IS PRIVATE PROPERTY FOR THE USE OF THE COMPANY
                       **** AUTHORIZED USERS ONLY! ****
Any use of this computer system shall be deemed to be express consent
to monitoring of such use and to such additional monitoring as may be necessary
to identify any unauthorized user. The system administrator or other
representatives of the system owner may monitor system use at any time without
further notice or consent. Unauthorized use of this system and any other
criminal conduct revealed by such use is subject to disclosure to law
enforcement officials and prosecution to the full extent of the law.
Unauthorized access is a violation of state and federal, civil and criminal
laws.
*******************************************************************************#
object-group port GENTEC-VMS-PORTS 
    1 eq 5500 
    2 eq 554 
    3 eq 556 
    4 eq 560 
    5 eq 960 
    6 eq 555 
    7 eq 605
object-group ip address DC-SERVER-CAMERA 
    10 10.72.233.195 
    20 10.72.236.229 
    30 10.72.237.253 
    40 10.72.227.206 

object-group ip address AD_SERVER
    10 151.140.0.131
    20 151.140.0.132
    30 151.140.0.133
    40 151.140.0.134
    50 151.140.0.135
    60 151.140.0.136
    70 151.140.105.64
    80 151.140.105.65
    90 151.140.107.218
    100 151.140.48.217
    110 151.140.48.218
    120 151.140.48.219
    130 151.140.77.9
    140 165.130.143.238
    150 165.130.143.29
    160 165.130.150.20
    170 165.130.204.211
    180 165.130.204.94
    190 165.130.208.217
    200 165.130.210.127
    210 165.130.210.130
    220 165.130.218.179
    230 165.130.218.180
    240 165.130.218.181
    250 165.130.218.182
    260 165.130.218.4
    270 165.130.218.5
    280 165.130.65.9
    290 165.130.73.10
    300 165.130.73.9
    310 172.16.144.13
    320 172.16.160.16
    330 172.16.184.14
    340 172.26.242.50
    350 172.30.59.18
    360 172.31.38.22
    370 151.140.107.219
    380 151.140.49.88
    390 151.140.77.12
    400 165.130.150.25
    410 165.130.208.218
    420 165.130.209.145
    430 165.130.65.7
    440 165.130.65.8
    450 165.130.73.7
    460 165.130.73.8
    470 151.140.107.21
    480 165.130.208.21
    490 165.130.73.12
    500 165.130.65.12
    510 151.140.49.87
    520 165.130.190.41
    530 165.130.73.11
    540 172.16.136.138
    550 172.16.152.118
    560 10.66.16.0/25
    570 10.74.16.0/25
    580 10.66.22.0/25
    590 10.74.22.0/25
object-group ip address AD_SERVER_18-1
    10 10.66.195.128/27
    20 10.74.195.0/27
    30 10.66.16.0/25
    40 10.74.16.0/25
    50 10.66.22.0/25
    60 10.74.22.0/25
object-group ip address AIRWATCH
    10 209.208.230.0/23
    20 192.30.64.0/20
    30 205.139.50.0/23
object-group ip address CROWDSTRIKE1
    10 13.56.121.58
    20 13.56.127.239
    30 13.57.54.63
    40 4.67.17.131
    50 50.18.194.39
    60 50.18.198.237
    70 52.52.117.52
    80 52.52.119.33
    90 52.52.149.168
    100 52.52.239.58
    110 52.53.77.89
    120 52.8.134.130
    130 52.8.141.1
    140 52.8.160.82
    150 52.8.172.89
    160 52.8.173.58
    170 52.8.19.75
    180 52.8.32.113
    190 52.8.45.162
    200 52.8.5.240
    210 52.8.54.244
    220 52.8.61.206
    230 52.9.104.148
    240 52.9.212.176
    250 52.9.77.209
    260 52.9.82.94
    270 52.9.87.98
    280 54.183.105.3
    290 54.183.120.141
    300 54.183.122.156
    310 54.183.135.80
    320 54.183.140.32
    330 54.183.142.105
    340 54.183.148.116
    350 54.183.148.43
    360 54.183.215.154
    370 54.183.234.42
    380 54.183.24.162
    390 54.183.252.86
    400 54.183.34.154
    410 54.183.39.68
    420 54.183.51.31
    430 54.183.51.69
    440 54.183.52.221
    450 54.193.117.199
    460 54.193.27.226
    470 54.193.29.47
    480 54.193.67.98
    490 54.193.86.245
    500 54.193.87.57
    510 54.193.90.171
    520 54.193.93.19
    530 54.215.131.232
    540 54.215.154.80
    550 54.215.169.199
    560 54.215.169.38
    570 54.215.170.42
    580 54.215.176.108
    590 54.215.183.157
    600 54.215.226.55
object-group ip address CROWDSTRIKE2
    10 54.219.140.50
    20 54.219.141.250
    30 54.219.145.181
    40 54.219.147.253
    50 54.219.148.161
    60 54.219.149.89
    70 54.219.149.92
    80 54.219.151.1
    90 54.219.151.27
    100 54.219.153.248
    110 54.219.158.53
    120 54.219.159.84
    130 54.219.161.141
    140 54.219.179.25
    150 54.241.138.180
    160 54.241.146.67
    170 54.241.148.127
    180 54.241.150.134
    190 54.241.161.242
    200 54.241.161.60
    210 54.241.162.180
    220 54.241.162.64
    230 54.241.164.212
    240 54.241.175.140
    250 54.241.175.52
    260 54.241.179.52
    270 54.241.181.242
    280 54.241.181.78
    290 54.241.182.78
    300 54.241.183.151
    310 54.241.183.229
    320 54.241.183.232
    330 54.241.184.161
    340 54.241.185.201
    350 54.241.186.124
    360 54.241.197.58
    370 54.67.105.202
    380 54.67.108.17
    390 54.67.114.188
    400 54.67.119.89
    410 54.67.122.238
    420 54.67.123.150
    430 54.67.123.234
    440 54.67.24.156
    450 54.67.26.184
    460 54.67.33.233
    470 54.67.4.108
    480 54.67.41.192
    490 54.67.48.56
    500 54.67.5.136
    510 54.67.51.32
    520 54.67.54.116
    530 54.67.6.201
    540 54.67.68.88
    550 54.67.72.218
    560 54.67.78.134
    570 54.67.92.206
    580 54.67.96.255
    590 54.67.99.247
    600 52.43.73.53
object-group ip address CROWDSTRIKE3
    10 54.219.112.243
    20 54.219.115.12
    30 54.219.137.54
    40 35.164.23.230
object-group ip address CYBERARK_PSM_RDP
    10 10.69.129.64/27
    20 10.77.129.64/27
    30 10.69.107.0/27
    40 10.77.107.0/27
    50 10.69.129.128/27
    60 10.77.129.128/27
    70 10.69.129.192/27
    80 10.77.129.192/27
    90 10.69.102.128/27
    100 10.77.102.128/27
    110 10.69.130.0/27
    120 10.77.130.0/27
object-group ip address DHCP_SERVER
    10 151.140.3.18
    20 151.140.48.237
    30 151.140.76.177
    40 151.140.107.119
    50 255.255.255.255
    60 %acl_dhcp_server_1%
    70 %acl_dhcp_server_2%
    80 %acl_dhcp_server_3%
object-group ip address DNS_SERVER
    10 165.130.1.9
    20 151.140.45.135
    30 151.140.45.136
    40 151.140.45.18
    50 165.130.128.196
    60 %dns_server_primary%
object-group ip address DNS_SERVER_18-1
    10 165.130.1.9
    20 151.140.45.135
    30 151.140.45.136
object-group ip address KMS_SERVER
    10 151.140.0.177
    20 151.140.104.251
object-group ip address KMS_SERVER_18-1
    10 151.140.0.177
    20 151.140.104.251
object-group ip address MANAGEMENT_POINT
    10 151.140.77.1
object-group ip address MOZY_BACKUPS
    10 65.44.121.0/24
    20 74.112.144.0/21
    30 173.243.48.0/20
    40 193.120.226.0/24
    50 193.120.29.220/30
    60 193.120.29.224/30
object-group ip address NTP_SERVER
    10 165.130.1.7
object-group ip address NTP_SERVER_18-1
    10 165.130.1.7
object-group ip address RUBRIK_BACKUPS
    10 10.72.64.0/24
    20 10.64.64.0/24
object-group ip address SCCM_DP_18-1
    10 151.140.2.235
    20 151.140.2.248
    30 151.140.48.248
    40 151.140.48.249
    50 151.140.76.111
    60 151.140.78.5
    70 151.140.79.143
    80 151.140.107.38
    90 151.140.50.130
object-group ip address SCCM_MP_18-1
    10 151.140.2.234
    20 151.140.2.245
    30 151.140.2.246
    40 151.140.48.247
    50 151.140.48.246
    60 151.140.76.109
    70 151.140.76.112
    80 151.140.76.113
    90 151.140.77.1
    100 151.140.107.48
    110 151.140.107.49
object-group ip address SCCM_SERVER
    10 151.140.2.234
    20 151.140.2.235
    30 151.140.2.245
    40 151.140.2.246
    50 151.140.2.248
    60 151.140.48.247
    70 151.140.48.246
    80 151.140.48.248
    90 151.140.48.249
    100 151.140.49.83
    110 151.140.49.95
    120 151.140.76.109
    130 151.140.76.110
    140 151.140.76.111
    150 151.140.76.112
    160 151.140.76.113
    170 151.140.76.173
    180 151.140.76.175
    190 151.140.78.5
    200 151.140.79.143
    210 151.140.107.38
    220 151.140.107.48
    230 151.140.107.49
    240 151.140.50.130
    250 172.19.80.16
    260 151.140.85.216
    270 %acl_sccm_server_1%
    280 %acl_sccm_server_2%
    290 %acl_sccm_server_3%
    300 10.66.200.0/25
    310 10.74.200.0/25
    320 10.66.2.0/26
    330 10.74.2.0/26
    340 10.66.129.128/26
    350 10.74.129.128/26
object-group ip address SCCM_SERVER_18-1
    10 10.66.200.0/25
    20 10.74.200.0/25
    30 10.66.2.0/26
    40 10.74.2.0/26
    50 10.66.129.128/26
    60 10.74.129.128/26
    70 151.140.76.175
    80 151.140.49.95
    90 165.130.174.46
object-group ip address SCCM_SERVER_2
    10 10.66.17.7
    20 10.66.17.8
    30 10.66.17.9
    40 10.66.17.10
    50 10.66.17.11
object-group ip address SCCM_SERVER_3
    10 10.66.17.15
    20 10.66.17.16
    30 10.66.17.17
object-group ip address SCCM_SUP_18-1
    10 151.140.49.83
    20 151.140.49.95
    30 151.140.76.110
    40 151.140.76.173
    50 151.140.76.175
object-group ip address SCCM_SortingHat_19-1
    10 165.130.131.124
    20 165.130.181.48
    30 165.130.228.45
    40 165.130.235.45
    50 151.140.85.216
object-group ip address SDWAN-INTERNET-HUBS
    10 207.11.17.13
    20 207.11.17.14
    30 207.11.17.15
    40 207.11.17.16
    50 207.11.17.17
    60 207.11.17.18
    70 207.11.17.19
    80 207.11.17.20
    90 207.11.48.13
    100 207.11.48.14
    110 207.11.48.15
    120 207.11.48.16
    130 207.11.48.17
    140 207.11.48.18
    150 207.11.48.19
    160 207.11.48.20
    170 207.11.71.32/29
    180 207.11.72.32/29
    190 207.11.73.32/29
    200 207.11.74.32/29
    210 207.11.75.32/29
object-group ip address SDWAN-MPLS-HUBS
    10 172.29.191.64/30
    20 172.29.191.68/30
    30 172.29.191.72/30
    40 172.29.191.76/30
    50 172.29.191.80/30
    60 172.29.191.84/30
    70 172.29.191.88/30
    80 172.29.191.92/30
    90 172.29.197.64/30
    100 172.29.197.68/30
    110 172.29.197.72/30
    120 172.29.197.76/30
    130 172.29.197.80/30
    140 172.29.197.84/30
    150 172.29.197.88/30
    160 172.29.197.92/30
    170 172.29.191.128/29
    180 172.29.191.136/29
    190 172.29.191.144/29
    200 172.29.191.152/29
    210 172.29.191.160/29
    220 10.23.20.211
    230 10.23.20.212
    240 10.23.20.213
    250 10.23.20.214
    260 10.33.20.211
    270 10.33.20.212
    280 10.33.20.213
    290 10.33.20.214
object-group ip address SYMANTEC
    10 151.140.2.1
    20 151.140.3.90
    30 151.140.3.91
    40 151.140.12.154
    50 151.140.12.155
    60 151.140.12.156
    70 151.140.12.157
    80 151.140.12.158
    90 151.140.67.11
    100 151.140.77.58
    110 151.140.77.59
    120 151.140.101.134
    130 151.140.101.135
    140 151.140.101.136
    150 151.140.101.137
    160 151.140.101.138
object-group ip address TACACS
    10 151.140.107.1
    20 151.140.2.230
object-group ip address VPN_CLIENTS
    10 172.19.174.0/24
    20 172.19.175.64/26
    30 172.19.190.0/24
    40 172.19.191.64/26
    50 172.19.206.0/24
    60 172.19.207.64/26
    70 172.19.222.0/24
    80 172.19.223.64/26
    90 10.97.0.0/16
    100 10.98.0.0/16 
    110 10.99.0.0/16 
    130 10.101.0.0/16 
    140 10.102.0.0/16
    150 10.103.0.0/16
object-group ip address VPN_CLIENTS_18-1
    10 172.19.174.0/24
    20 172.19.175.64/26
    30 172.19.190.0/24
    40 172.19.191.64/26
    50 172.19.206.0/24
    60 172.19.207.64/26
    70 172.19.222.0/24
    80 172.19.223.64/26
    90 10.97.0.0/16
    100 10.98.0.0/16 
    110 10.99.0.0/16 
    130 10.101.0.0/16 
    140 10.102.0.0/16
    150 10.103.0.0/16
object-group ip address ZEBRACONNECTSSL
    10 104.43.137.98
    20 40.77.86.240
    30 20.114.141.221
    40 20.110.124.146
    50 40.122.109.203
    60 40.122.111.126
    70 52.165.156.238
    80 40.122.254.103
    90 20.122.2.233
    100 20.114.197.183
    110 40.122.50.157
    120 40.75.114.173
    130 13.86.24.118
    140 54.215.171.160
    150 40.69.147.36
    160 104.43.220.82
    170 20.109.102.12
    180 40.77.110.129
    190 13.67.199.39
    200 52.184.158.53
    210 20.98.185.109
    220 52.162.199.50
    230 20.75.44.109
    240 20.98.185.177
    250 20.98.179.254
    260 20.62.48.223
    270 20.221.100.193
    280 20.62.81.90
    290 20.221.91.35
    300 52.159.118.20
object-group ip address ZEBRAMQTT
    10 52.162.199.50
    20 52.162.199.50
    30 20.75.44.109
    40 20.98.185.177
    50 20.98.179.254
    60 20.62.48.223
    70 20.221.100.193
    80 20.62.81.90
    90 20.221.91.35
object-group ip address ZEBRASIGNALCTRL
    10 52.184.152.221
    20 104.43.135.25
    30 104.43.130.122
    40 168.61.186.80
    50 52.173.132.150
    60 20.119.234.52
    70 20.110.147.147
    80 23.99.231.96
    90 40.77.96.54
    100 52.165.152.237
    110 52.165.153.142
    120 52.184.158.232
object-group ip address SCCM_SERVER_4
  10 10.66.200.0/255.255.255.128
  20 10.74.200.0/255.255.255.128
object-group ip address SCCM_SERVER_5
  10 10.66.2.0/255.255.255.128
  20 10.74.2.0/255.255.255.128
object-group ip address ENCASE_01
  10 10.69.113.0/255.255.255.224
  20 10.69.105.0/255.255.255.224
  30 10.69.97.0/255.255.255.224
object-group ip address TANIUM_01
  10 10.69.107.72
  20 10.77.107.74
object-group ip address TANIUM_02
  10 10.69.107.73
  20 10.77.107.75
object-group ip address FORCEPOINT_01
  10 10.72.169.229
  20 10.72.169.78
  30 10.72.168.68
  40 10.69.120.70
  50 10.69.120.71
  60 10.69.120.72
  70 10.77.120.70
  80 10.77.120.71
  90 192.168.55.14
  100 192.168.55.15
  110 192.168.55.16
  120 192.168.105.10
  130 192.168.105.11
  140 207.11.34.143
object-group ip address PEWEBSERVER_01
  10 10.77.102.137/255.255.255.192
  20 10.69.102.138/255.255.255.224
  30 10.69.129.165/255.255.255.224
  40 10.69.129.196/255.255.255.224
  50 10.69.129.229/255.255.255.224
  60 10.77.129.135/255.255.255.224
  70 10.77.129.165/255.255.255.224
  80 10.77.129.199/255.255.255.224
  90 10.77.129.230/255.255.255.224
  100 10.77.129.229/255.255.255.224
  110 151.140.0.170/255.255.255.252
  120 151.140.102.102/255.255.255.252
  130 151.140.50.191/255.255.255.252
  140 151.140.87.140/255.255.255.252
object-group ip address T2_Jump_Hosts_18-1
  10 10.77.102.128/255.255.255.192
  20 10.69.129.160/255.255.255.224
  30 10.69.129.192/255.255.255.224
  40 10.69.129.224/255.255.255.224
  50 10.69.130.0/255.255.255.224
  60 10.69.102.128/255.255.255.224
  70 10.77.129.128/255.255.255.224
  80 10.77.129.160/255.255.255.224
  90 10.77.129.192/255.255.255.224
  100 10.77.129.224/255.255.255.224
  110 10.77.130.0/255.255.255.224
  120 151.140.0.0/255.255.252.0
  130 151.140.100.0/255.255.252.0
  140 151.140.48.0/255.255.252.0
  150 151.140.84.0/255.255.252.0
object-group ip address GOOGLE-NETS
  10 34.64.0.0/255.192.0.0          
  20 34.128.0.0/255.192.0.0         
  30 34.32.0.0/255.224.0.0          
  40 34.16.0.0/255.240.0.0          
  50 35.208.0.0/255.240.0.0         
  60 35.224.0.0/255.240.0.0         
  70 34.8.0.0/255.248.0.0           
  80 35.184.0.0/255.248.0.0         
  90 35.200.0.0/255.248.0.0         
  100 35.240.0.0/255.248.0.0         
  110 34.4.0.0/255.252.0.0           
  120 35.192.0.0/255.252.0.0         
  130 104.196.0.0/255.252.0.0        
  140 34.0.0.0/255.254.0.0           
  150 35.196.0.0/255.254.0.0         
  160 104.154.0.0/255.254.0.0        
  170 142.250.0.0/255.254.0.0        
  180 192.178.0.0/255.254.0.0        
  190 34.2.0.0/255.255.0.0           
  200 35.198.0.0/255.255.0.0         
  210 74.125.0.0/255.255.0.0         
  220 130.211.0.0/255.255.0.0        
  230 172.217.0.0/255.255.0.0        
  240 172.253.0.0/255.255.0.0        
  250 173.194.0.0/255.255.0.0        
  260 34.3.128.0/255.255.128.0       
  270 35.199.0.0/255.255.128.0       
  280 108.177.0.0/255.255.128.0      
  290 146.148.0.0/255.255.128.0      
  300 209.85.128.0/255.255.128.0     
  310 34.3.64.0/255.255.192.0        
  320 35.199.128.0/255.255.192.0     
  330 72.14.192.0/255.255.192.0      
  340 107.178.192.0/255.255.192.0    
  350 108.170.192.0/255.255.192.0    
  360 23.251.128.0/255.255.224.0     
  370 34.3.32.0/255.255.224.0        
  380 64.233.160.0/255.255.224.0     
  390 66.249.64.0/255.255.224.0      
  400 70.32.128.0/255.255.224.0      
  410 104.237.160.0/255.255.224.0    
  420 107.167.160.0/255.255.224.0    
  430 208.117.224.0/255.255.224.0    
  440 216.58.192.0/255.255.224.0     
  450 216.239.32.0/255.255.224.0     
  460 8.34.208.0/255.255.240.0       
  470 8.35.192.0/255.255.240.0       
  480 23.236.48.0/255.255.240.0      
  490 34.3.16.0/255.255.240.0        
  500 64.15.112.0/255.255.240.0      
  510 66.102.0.0/255.255.240.0       
  520 108.59.80.0/255.255.240.0      
  530 173.255.112.0/255.255.240.0    
  540 207.223.160.0/255.255.240.0    
  550 216.73.80.0/255.255.240.0      
  560 34.3.8.0/255.255.248.0         
  570 162.222.176.0/255.255.248.0    
  580 172.110.32.0/255.255.248.0     
  590 199.223.232.0/255.255.248.0    
  600 162.216.148.0/255.255.252.0    
  610 192.158.28.0/255.255.252.0     
  620 199.192.112.0/255.255.252.0    
  630 208.65.152.0/255.255.252.0     
  640 208.68.108.0/255.255.252.0     
  650 208.81.188.0/255.255.252.0     
  660 34.3.0.0/255.255.254.0         
  670 66.22.228.0/255.255.254.0      
  680 199.36.154.0/255.255.254.0     
  690 8.8.4.0/255.255.255.0          
  700 8.8.8.0/255.255.255.0          
  710 34.3.3.0/255.255.255.0         
  720 34.3.4.0/255.255.255.0         
  730 193.186.4.0/255.255.255.0      
  740 199.36.156.0/255.255.255.0     
object-group port PORTS-2701-3389-139-137-445-5985-5986
  10 eq 2701
  20 eq 3389
  30 eq 139
  40 eq 137
  50 eq 445
  60 eq 5985
  70 eq 5986
object-group port PORTS-80-443-10123
  10 eq 80
  20 eq 443
  30 eq 10123
object-group port PORTS-67-68-69-4011
  10 eq 67
  20 eq 68
  30 eq 69
  40 eq 4011
object-group port PORTS-445-135
  10 eq 445
  20 eq 135
object-group port PORTS-137-138
  10 eq 137
  20 eq 138
object-group port PORTS-1025-139-445-135
    10 eq 1025
    20 eq 139
    30 eq 445
    40 eq 135
object-group port PORTS-1025-49252-49253
    10 eq 1025
    20 range 49252 49253
object-group port PORTS-1034-1050-1303-1321-22-443-80-5631
    10 eq 1034
    20 eq 1050
    30 eq 1303
    40 eq 1321
    50 eq 22
    60 eq 443
    70 eq 80
    80 eq 5631
object-group port PORTS-1077-1496-1662-20000-53-137-123-514-69-5632
    10 eq 1077
    20 eq 1496
    30 eq 1662
    40 eq 20000
    50 eq 53
    60 eq 137
    70 eq 123
    80 eq 514
    90 eq 69
    100 eq 5632
object-group port PORTS-1093-1067-1064
    10 eq 1093
    20 eq 1067
    30 eq 1064
object-group port PORTS-1109-1367
    10 eq 1109
    20 eq 1367
object-group port PORTS-12000-12020-12030-12060-12070
    10 eq 12000
    20 eq 12020
    30 eq 12030
    40 eq 12060
    50 eq 12070
object-group port PORTS-12020-12030-12060-12070-FTP
    10 eq 12020
    20 eq 12030
    30 eq 12060
    40 eq 12070
    50 eq 21
object-group port PORTS-12090-12100
    10 eq 12090
    20 eq 12100
object-group port PORTS-135-139-445
    10 eq 135
    20 eq 139
    30 eq 445
object-group port PORTS-137-445-38293-2967-139-4300
    10 eq 137
    20 eq 445
    30 eq 38293
    40 eq 2967
    50 eq 139
    60 eq 4300
object-group port PORTS-139-445
    10 eq 139
    20 eq 445
object-group port PORTS-139-9100-WWW-8080
    10 eq 139
    20 eq 9100
    30 eq 80
    40 eq 8080
object-group port PORTS-1533-1503-8081-554
    10 eq 1533
    20 eq 1503
    30 eq 8081
    40 eq 554
object-group port PORTS-16992-16995
    10 range 16992 16995
object-group port PORTS-2000-4445-5631-8085-81-2187
    10 eq 2000
    20 eq 4445
    30 eq 5631
    40 eq 8085
    50 eq 81
    60 eq 2187
object-group port PORTS-2003-2378-4001
    10 eq 2003
    20 eq 2378
    30 eq 4001
object-group port PORTS-2003-2378-4001-2878
    10 eq 2003
    20 eq 2378
    30 eq 4001
    40 eq 2878
object-group port PORTS-2697-2967
    10 eq 2697
    20 eq 2967
object-group port PORTS-2967-38293
    10 eq 2967
    20 eq 38293
object-group port PORTS-3268-3269-9389-49204-49206
    10 eq 3268
    20 eq 3269
    30 eq 9389
    40 eq 49204
    50 eq 49206
object-group port PORTS-3269-9389-49204-49206
    10 eq 3269
    20 eq 9389
    30 eq 49204
    40 eq 49206
object-group port PORTS-3389-5986
    10 eq 3389
    20 eq 5986
object-group port PORTS-389-22-139-138-137-135-123-161
    10 eq 389
    20 eq 22
    30 eq 139
    40 eq 138
    50 eq 137
    60 eq 135
    70 eq 123
    80 eq 161
object-group port PORTS-4011-TFTP
    10 eq 4011
    20 eq 69
object-group port PORTS-427-1900
    10 eq 427
    20 eq 1900
object-group port PORTS-445-139
    10 eq 445
    20 eq 139
object-group port PORTS-49254-49201-1494-135
    10 eq 49254
    20 eq 49201
    30 eq 1494
    40 eq 135
object-group port PORTS-5005-6010-554-5010
    10 eq 5005
    20 eq 6010
    30 eq 554
    40 eq 5010
    50 eq 554
    60 eq 5010
object-group port PORTS-5050-5560-6010-7005-8029-8089-9541-12345-49170
    10 eq 5050
    20 eq 5560
    30 eq 6010
    40 eq 7005
    50 eq 8029
    60 eq 8089
    70 eq 9541
    80 eq 12345
    90 eq 49170
object-group port PORTS-5060-5061-5063-443
    10 eq 5060
    20 eq 5061
    30 eq 5063
    40 eq 443
object-group port PORTS-5985-5986
    10 range 5985 5986
object-group port PORTS-5985-MSRPC
    10 eq 5985
    20 eq 135
object-group port PORTS-6100-6101-9100
    10 eq 6100
    20 eq 6101
    30 eq 9100
object-group port PORTS-623-664
    10 eq 623
    20 eq 664
object-group port PORTS-623-664-5986-16992-16993-16994-16995
    10 eq 623
    20 eq 664
    30 eq 5986
    40 range 16992 16995
object-group port PORTS-623-664-5986-R16992-16995-plusmore
   10 eq 623
   20 eq 664
   30 eq 5986
   40 range 16992 16995
   50 eq 8082
   60 eq 5985
   70 eq 139
   80 eq 445
   90 eq 2701
   100 eq 2702
   110 eq 88
object-group port PORTS-7775-137-138
    10 eq 7775
    20 eq 137
    30 eq 138
    40 eq 7775
    50 eq 137
    60 eq 138
object-group port PORTS-7775-137-139-445-MSRPC-2701-2702-3389-5985-5986
    10 eq 7775
    20 eq 137
    30 eq 139
    40 eq 445
    50 eq 135
    60 range 2701 2702
    70 eq 3389
    80 range 5985 5986
object-group port PORTS-8014-9090-8443
    10 eq 8014
    20 eq 9090
    30 eq 8443
object-group port PORTS-8019-8008
    10 eq 8019
    20 eq 8008
object-group port PORTS-8019-8012
    10 eq 8019
    20 eq 8012
object-group port PORTS-8077-8079
    10 eq 8077
    20 eq 8079
object-group port PORTS-8080-3128
    10 eq 8080
    20 eq 3128
object-group port PORTS-8080-9898
    10 eq 8080
    20 eq 9898
object-group port PORTS-8106-8006-8406-8126-8026-8426-51600
    10 eq 8106
    20 eq 8006
    30 eq 8406
    40 eq 8126
    50 eq 8026
    60 eq 8426
    70 eq 51600
object-group port PORTS-8126-8426-51600
    10 eq 8126
    20 eq 8426
    30 eq 51600
object-group port PORTS-88-123-137-138-389-445-464
    10 eq 88
    20 eq 123
    30 eq 137
    40 eq 138
    50 eq 389
    60 eq 445
    70 eq 464
object-group port PORTS-88-135-139-389-445-464-636
    10 eq 88
    20 eq 135
    30 eq 139
    40 eq 389
    50 eq 445
    60 eq 464
    70 eq 636
object-group port PORTS-88-389-49201-49204-3268
    10 eq 88
    20 eq 389
    30 eq 49201
    40 eq 49204
    50 eq 3268
object-group port PORTS-88-8019-49204-445-139-1090-1025-3268
    10 eq 88
    20 eq 8019
    30 eq 49204
    40 eq 445
    50 eq 139
    60 eq 1090
    70 eq 1025
    80 eq 3268
object-group port PORTS-88-MSRPC-139-389-445-464-636
    10 eq 88
    20 eq 135
    30 eq 139
    40 eq 389
    50 eq 445
    60 eq 464
    70 eq 636
object-group port PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464
    10 eq 88
    20 eq 123
    30 eq 137
    40 eq 138
    50 eq 389
    60 eq 445
    70 eq 464
object-group port PORTS-9080-5050
    10 eq 9080
    20 eq 5050
object-group port PORTS-9220-16398
    10 eq 9220
    20 eq 16398
object-group port PORTS-9912-9902
    10 eq 9912
    20 eq 9902
object-group port PORTS-BOOTPC-BOOTPS-TFTP-135-4011
    10 eq 67
    20 eq 68
    30 eq 69
    40 eq 135
    50 eq 4011
object-group port PORTS-BOOTPS-BOOTPC
    10 eq 67
    20 eq 68
object-group port PORTS-DNS-88-MSRPC-139-389-445-464-636-3268
    10 eq 53
    20 eq 88
    30 eq 135
    40 eq 139
    50 eq 389
    60 eq 445
    70 eq 464
    80 eq 636
    90 eq 3268
object-group port PORTS-DNS-DAYTIME
    10 eq 53
    20 eq 13
object-group port PORTS-FTP-2010-5000
    10 eq 21
    20 eq 2010
    30 eq 5000
object-group port PORTS-FTPD-FTP-TELNET-WWW-554-1420-1422-1439-5005-5010
    10 eq 20
    20 eq 21
    30 eq 23
    40 eq 80
    50 eq 554
    60 eq 1420
    70 eq 1422
    80 eq 1439
    90 eq 5005
    100 eq 5010
object-group port PORTS-MSRPC-139-445-2701-2702
    10 eq 135
    20 eq 139
    30 eq 445
    40 range 2701 2702
object-group port PORTS-MSRPC-445-WWW
    10 eq 135
    20 eq 445
    30 eq 80
object-group port PORTS-NETBIOS-NS-NETBIOS-DGM
    10 eq 137
    20 eq 138
object-group port PORTS-NTP-DNS
    10 eq 123
    20 eq 53
object-group port PORTS-NTP-SNMP-NETBIOS-NS-DGM-DNS-BOOTPS-389-1311-2000-88
    10 eq 123
    20 eq 161
    30 eq 137
    40 eq 67
    50 eq 389
    60 eq 1311
    70 eq 2000
    80 eq 88
object-group port PORTS-TELNET-30010
    10 eq 23
    20 eq 30010
object-group port PORTS-TELNET-4004-137-10010-10012-10014
    10 eq 23
    20 eq 4004
    30 eq 137
    40 eq 10010
    50 eq 10012
    60 eq 10014
object-group port PORTS-TFTP-111-BOOTPC-4004
    10 eq 69
    20 eq 111
    30 eq 68
    40 eq 4004
object-group port PORTS-TFTP-2000-6969
    10 eq 69
    20 eq 2000
    30 eq 6969
object-group port PORTS-WWW-1109-1367
    10 eq 80
    20 eq 1109
    30 eq 1367
object-group port PORTS-WWW-111-DNS-13-9100-88-8080-524-445-443
    10 eq 80
    20 eq 111
    30 eq 53
    40 eq 13
    50 eq 9100
    60 eq 88
    70 eq 8080
    80 eq 524
    90 eq 445
    100 eq 443
object-group port PORTS-WWW-12120-22-500-TELNET
    10 eq 80
    20 eq 12120
    30 eq 22
    40 eq 500
    50 eq 23
object-group port PORTS-WWW-13150
    10 eq 80
    20 eq 13150
object-group port PORTS-WWW-1433
    10 eq 80
    20 eq 1433
object-group port PORTS-WWW-443
    10 eq 80
    20 eq 443
object-group port PORTS-WWW-443-10123
    10 eq 80
    20 eq 443
    30 eq 10123
object-group port PORTS-WWW-443-445
    10 eq 80
    20 eq 443
    30 eq 445
object-group port PORTS-WWW-443-64084-8082-8443-8444
    10 eq 80
    20 eq 443
    30 eq 64084
    40 eq 8082
    50 eq 8443
    60 eq 8444
object-group port PORTS-WWW-445
    10 eq 80
    20 eq 445
object-group port PORTS-WWW-8080
    10 eq 80
    20 eq 8080
object-group port PORTS-ZEBRASIGNALCTRL_TCP
    10 eq 4200
    20 eq 4300
    30 eq 4400
    40 eq 4500
    50 eq 4600
    60 eq 4700
    70 eq 443
object-group port PORTS-ZEBRASIGNALCTRL_UDP
    10 range 4200 4224
    20 range 4300 4324
    30 range 4400 4424
    40 range 4500 4524
    50 range 4600 4624
    60 range 4700 4724
object-group port PORTS-ZEBRA_SSL_TCP
    10 eq 443
    20 eq 8443
    30 eq 1883
    40 eq 8883
    50 eq 9443
%if is_qnapacl=Y%
object-group port QNAP_CLIENTS
  10 eq 8080	 	 	 	 	 	 	 
  20 eq 443	 	 	 	 	 	 	 
  30 eq 445	 	 	 	 	 	 	 
  40 eq 22
%endif%    
object-group ip address AZURE_SDWAN_CONTROL
    10 13.64.211.141
    20 20.185.225.46
    30 20.115.18.203
    40 40.83.146.205
    50 20.115.6.223
    60 20.168.231.210
    70 20.163.135.201
    80 20.168.194.58
    90 20.169.175.37
    100 172.171.100.213
    110 20.168.221.31
    120 20.29.249.88
    130 20.228.131.41
    140 20.121.14.153
    150 52.142.63.128
    160 20.85.242.87
    170 20.29.207.32
    180 20.172.192.175
    190 20.172.220.166
    200 172.174.41.25
    210 20.232.161.178
    220 4.154.136.42
object-group ip address QNAP_VLAN_2
    10 10.128.0.43/255.128.7.255
    20 10.128.0.44/255.128.7.255
    30 10.128.0.45/255.128.7.255
    40 10.128.0.46/255.128.7.255
    50 10.128.0.52/255.128.7.255
    60 10.128.0.53/255.128.7.255
    70 10.128.0.56/255.128.7.255
    80 10.128.0.57/255.128.7.255
%if is_ffirstacl=Y%	
object-group ip address O365_SERVER
   10 13.107.3.1
   20 13.107.3.2
   30 52.238.78.88
   40 104.47.51.110
   50 104.47.56.110
   60 104.47.57.110
   70 23.103.132.0/255.255.252.0
   80 23.103.136.0/255.255.248.0
   90 23.103.144.0/255.255.240.0
   100 23.103.144.0/255.255.252.0
   110 23.103.156.0/255.255.252.0
   120 23.103.191.0/255.255.255.0
   130 23.103.198.0/255.255.254.0
   140 23.103.200.0/255.255.248.0
   150 23.103.200.0/255.255.252.0
   160 23.103.212.0/255.255.252.0
   170 40.80.0.0/255.252.0.0
   180 40.82.0.0/255.252.0.0
   190 40.92.0.0/255.252.0.0
   200 40.107.0.0/255.255.0.0
   210 40.107.0.0/255.255.128.0
   220 40.107.128.0/255.255.192.0
   230 52.100.0.0/255.252.0.0
   240 64.4.22.64/255.255.255.192
   250 65.55.83.128/255.255.255.224
   260 65.55.88.0/255.255.255.0
   270 65.55.169.0/255.255.255.0
   280 94.245.120.64/255.255.255.192
   290 104.47.0.0/255.255.128.0
   300 104.212.58.0/255.255.254.0
   310 134.170.132.0/255.255.255.0
   320 134.170.140.0/255.255.255.0
   330 134.170.171.0/255.255.255.0
   340 157.55.133.0/255.255.255.128
   350 157.55.133.160/255.255.255.224
   360 157.55.158.0/255.255.254.0
   370 157.55.206.0/255.255.254.0
   380 157.55.234.0/255.255.255.0
   390 157.56.73.0/255.255.255.0
   400 157.56.87.192/255.255.255.192
   410 157.56.108.0/255.255.255.0
   420 157.56.110.0/255.255.255.254
   430 157.56.110.0/255.255.255.0
   440 157.56.111.0/255.255.255.0
   450 157.56.112.0/255.255.255.0
   460 157.56.206.0/255.255.255.0
   470 157.56.208.0/255.255.252.0
   480 207.46.51.64/255.255.255.192
   490 207.46.100.0/255.255.255.0
   500 207.46.101.128/255.255.255.192
   510 207.46.163.0/255.255.255.0
   520 213.199.154.0/255.255.255.0
   530 213.199.180.128/255.255.255.192
   540 216.32.180.0/255.255.255.254
   550 216.32.180.0/255.255.255.0
   560 216.32.181.0/255.255.255.0
%endif%    
!-----ACL Configuration-----
access-list ip CONTROLPLANE
    5 comment --- SSH Traffic ---
    10 permit tcp 192.168.112.1 any eq 22
    20 permit tcp 207.11.32.71 any eq 22
    30 permit tcp 207.11.32.85 any eq 22
    40 permit tcp 207.11.118.1 any eq 22
    50 permit tcp 207.11.32.94 any eq 22
    60 permit tcp 207.11.32.88 any eq 22
    70 permit tcp 207.11.32.91 any eq 22
    80 permit tcp 207.11.37.1 any eq 22
    90 permit tcp 192.168.128.1 any eq 22
    100 permit tcp 172.29.191.0/255.255.255.192 any eq 22
    110 permit tcp 172.29.197.0/255.255.255.192 any eq 22
    120 permit tcp 10.128.0.45/255.128.7.255 any eq 22
    130 permit tcp 10.128.0.73/255.128.7.255 any eq 22
    140 permit tcp 10.64.0.0/255.248.0.0 any eq 22             
    150 permit tcp 10.72.0.0/255.248.0.0 any eq 22
    160 permit tcp 10.69.99.0/255.255.255.0 any eq 22
    170 permit tcp 10.77.99.0/255.255.255.0 any eq 22
    180 permit tcp 151.140.0.0/255.255.0.0 any eq 22
    190 permit tcp 165.130.0.0/255.255.0.0 any eq 22
%if is_npcpacl=Y%
    195 permit tcp 10.16.42.165 any eq 22
%endif% 	
    200 permit tcp 172.18.0.0/255.255.0.0 any eq 22
    210 permit tcp 172.19.174.0/255.255.255.0 any eq 22
    220 permit tcp 172.19.175.64/255.255.255.192 any eq 22
    230 permit tcp 172.19.190.0/255.255.255.0 any eq 22
    240 permit tcp 172.19.191.64/255.255.255.192 any eq 22
    250 permit tcp 172.19.206.0/255.255.255.0 any eq 22
    260 permit tcp 172.19.207.64/255.255.255.192 any eq 22
    270 permit tcp 172.19.222.0/255.255.255.0 any eq 22
    280 permit tcp 172.19.223.64/255.255.255.192 any eq 22
    290 permit tcp 172.19.8.0/255.255.254.0 any eq 22
    300 permit tcp 172.21.128.0/255.255.192.0 any eq 22
    310 permit tcp 172.21.192.0/255.255.192.0 any eq 22
    320 permit tcp 172.26.6.0/255.255.255.0 any eq 22
    330 permit tcp 172.26.63.0/255.255.255.0 any eq 22
    340 permit tcp 192.168.50.0/255.255.255.248 any eq 22
    350 permit tcp 192.168.80.0/255.255.252.0 any eq 22
    360 permit tcp 207.11.12.0/255.255.255.0 any eq 22
    370 permit tcp 207.11.21.0/255.255.255.0 any eq 22         
    380 permit tcp 207.11.20.64/255.255.255.192 any eq 22
    390 permit tcp 207.11.33.64/255.255.255.192 any eq 22
    395 comment --GlobalProtectVPN-SSH----
    400 permit tcp 10.97.0.0/255.255.0.0 any eq 22
    410 permit tcp 10.98.0.0/255.255.0.0 any eq 22
    420 permit tcp 10.99.0.0/255.255.0.0 any eq 22
    440 permit tcp 10.101.0.0/255.255.0.0 any eq 22
    450 permit tcp 10.102.0.0/255.255.0.0 any eq 22
    460 permit tcp 10.103.0.0/255.255.0.0 any eq 22
    470 deny tcp any any eq 22 count
    505 comment --- HTTPS Traffic ---
    510 permit tcp 192.168.112.1 any eq 443
    520 permit tcp 207.11.32.71 any eq 443
    530 permit tcp 207.11.32.85 any eq 443
    540 permit tcp 207.11.118.1 any eq 443
    550 permit tcp 207.11.32.94 any eq 443
    560 permit tcp 207.11.32.88 any eq 443
    570 permit tcp 207.11.32.91 any eq 443
    580 permit tcp 207.11.37.1 any eq 443
    590 permit tcp 192.168.128.1 any eq 443
    600 permit tcp 172.29.191.0/255.255.255.192 any eq 443
    610 permit tcp 172.29.197.0/255.255.255.192 any eq 443
    620 permit tcp 10.128.0.45/255.128.7.255 any eq 443
    630 permit tcp 10.128.0.73/255.128.7.255 any eq 443
    640 permit tcp 10.64.0.0/255.248.0.0 any eq 443             
    650 permit tcp 10.72.0.0/255.248.0.0 any eq 443
    660 permit tcp 10.69.99.0/255.255.255.0 any eq 443
    670 permit tcp 10.77.99.0/255.255.255.0 any eq 443
    680 permit tcp 151.140.0.0/255.255.0.0 any eq 443
    690 permit tcp 165.130.0.0/255.255.0.0 any eq 443
    700 permit tcp 172.18.0.0/255.255.0.0 any eq 443
    710 permit tcp 172.19.174.0/255.255.255.0 any eq 443
    720 permit tcp 172.19.175.64/255.255.255.192 any eq 443
    730 permit tcp 172.19.190.0/255.255.255.0 any eq 443
    740 permit tcp 172.19.191.64/255.255.255.192 any eq 443
    750 permit tcp 172.19.206.0/255.255.255.0 any eq 443
    760 permit tcp 172.19.207.64/255.255.255.192 any eq 443
    770 permit tcp 172.19.222.0/255.255.255.0 any eq 443
    780 permit tcp 172.19.223.64/255.255.255.192 any eq 443
    790 permit tcp 172.19.8.0/255.255.254.0 any eq 443
    800 permit tcp 172.21.128.0/255.255.192.0 any eq 443
    810 permit tcp 172.21.192.0/255.255.192.0 any eq 443
    820 permit tcp 172.26.6.0/255.255.255.0 any eq 443
    830 permit tcp 172.26.63.0/255.255.255.0 any eq 443
    840 permit tcp 172.29.164.134/255.255.255.255 any eq 443 
    850 permit tcp 172.29.165.130/255.255.255.255 any eq 443 
    860 permit tcp 172.29.166.134/255.255.255.255 any eq 443 
    870 permit tcp 172.29.167.13/255.255.255.255 any eq 443 
    880 permit tcp 192.168.50.0/255.255.255.248 any eq 443
    890 permit tcp 192.168.80.0/255.255.252.0 any eq 443
    900 permit tcp 207.11.12.0/255.255.255.0 any eq 443
    910 permit tcp 207.11.21.0/255.255.255.0 any eq 443         
    920 permit tcp 207.11.20.64/255.255.255.192 any eq 443
    930 permit tcp 207.11.33.64/255.255.255.192 any eq 443
    %if is_npcpacl=Y%
    932 permit tcp 10.16.41.233 any eq 443
    %endif%
    945 comment --GlobalProtectVPN-HTTPS----
    950 permit tcp 10.97.0.0/255.255.0.0 any eq 443
    960 permit tcp 10.98.0.0/255.255.0.0 any eq 443
    970 permit tcp 10.99.0.0/255.255.0.0 any eq 443
    990 permit tcp 10.101.0.0/255.255.0.0 any eq 443
    1000 permit tcp 10.102.0.0/255.255.0.0 any eq 443
    1010 permit tcp 10.103.0.0/255.255.0.0 any eq 443
    1020 deny tcp 10.0.0.0/8 any eq 443
    1030 deny tcp 172.16.0.0/12 any eq 443 
    1040 deny tcp 192.168.0.0/16 any eq 443
    5000 permit any any any count
access-list ip FW-STAGING-VLAN-IN_18-1
    10 comment -- McAfee
    20 permit tcp any 151.140.12.165 eq 8443 count
    30 comment -- SCCM Server Subnets
    40 permit tcp any SCCM_SERVER_18-1 eq 80 count
    50 permit tcp any SCCM_SERVER_18-1 eq 443 count
    60 permit tcp any SCCM_SERVER_18-1 eq 445 count
    70 permit tcp any SCCM_SERVER_18-1 eq 135 count
    80 permit tcp any 10.77.97.84 eq 135 count
    90 permit tcp any 10.77.97.84 eq 49500 count
    100 permit tcp any 10.69.97.212 eq 135 count
    110 permit tcp any 10.69.97.212 eq 49500 count
    120 permit udp any SCCM_SERVER_18-1 eq 135 count
    130 permit udp any SCCM_SERVER_18-1 eq 67 count
    140 permit udp any SCCM_SERVER_18-1 eq 68 count
    150 permit udp any SCCM_SERVER_18-1 eq 69 count
    160 permit udp any SCCM_SERVER_18-1 eq 4011 count
    170 permit icmp any SCCM_SERVER_18-1 count
    180 permit udp any SCCM_SERVER_18-1 gt 49151 count
    190 comment -- SCCM Management Points
    200 permit tcp any SCCM_MP_18-1 eq 80 count
    210 permit tcp any SCCM_MP_18-1 eq 443 count
    220 permit tcp any SCCM_MP_18-1 eq 10123 count
    230 permit icmp any SCCM_MP_18-1 count
    240 comment -- SCCM Distribution Points
    250 permit tcp any SCCM_DP_18-1 eq 80 count
    260 permit tcp any SCCM_DP_18-1 eq 443 count
    270 permit udp any SCCM_DP_18-1 eq 67 count
    280 permit udp any SCCM_DP_18-1 eq 68 count
    290 permit udp any SCCM_DP_18-1 eq 69 count
    300 permit udp any SCCM_DP_18-1 eq 4011 count
    310 permit icmp any SCCM_DP_18-1 count
    320 comment -- SCCM Software Update Points
    330 permit tcp any SCCM_SUP_18-1 eq 80 count
    340 permit tcp any SCCM_SUP_18-1 eq 443 count
    350 permit icmp any SCCM_SUP_18-1 count
    360 comment -- SCCM SortingHat
    370 permit tcp any SCCM_SortingHat_19-1 eq 80 count
    380 permit tcp any SCCM_SortingHat_19-1 eq 443 count
    390 permit tcp any SCCM_SortingHat_19-1 eq 445 count
    400 permit tcp any SCCM_SortingHat_19-1 eq 135 count
    410 permit udp any SCCM_SortingHat_19-1 eq 135 count
    420 permit udp any SCCM_SortingHat_19-1 eq 67 count
    430 permit udp any SCCM_SortingHat_19-1 eq 68 count
    440 permit udp any SCCM_SortingHat_19-1 eq 69 count
    450 permit udp any SCCM_SortingHat_19-1 eq 4011 count
    460 permit udp any SCCM_SortingHat_19-1 gt 49152 count
    470 permit icmp any SCCM_SortingHat_19-1 count
    480 comment -- SCCM Local Configuration Manager
    490 permit tcp any 10.128.0.14/255.128.7.255 eq 80 count
    500 permit tcp any 10.128.0.14/255.128.7.255 eq 443 count
    510 permit tcp any 10.128.0.14/255.128.7.255 eq 445 count
    520 permit tcp any 10.128.0.14/255.128.7.255 eq 135 count
    530 permit udp any 10.128.0.14/255.128.7.255 eq 135 count
    540 permit udp any 10.128.0.14/255.128.7.255 eq 67 count
    550 permit udp any 10.128.0.14/255.128.7.255 eq 68 count
    560 permit udp any 10.128.0.14/255.128.7.255 eq 69 count
    570 permit udp any 10.128.0.14/255.128.7.255 eq 4011 count
    580 permit udp any 10.128.0.14/255.128.7.255 gt 49152 count
    590 permit icmp any 10.128.0.14/255.128.7.255 count
    600 comment -- EPOREPO
    610 permit tcp any 10.128.0.22/255.128.7.255 eq 80 count
    620 permit tcp any 10.128.0.22/255.128.7.255 eq 443 count
    630 permit tcp any eq 64084 10.128.0.22/255.128.7.255 count
    640 comment -- Active Directory and PKI
    650 permit udp any AD_SERVER_18-1 eq 389 count
    660 permit tcp any AD_SERVER_18-1 eq 3268 count
    670 permit udp any AD_SERVER_18-1 eq 138 count
    680 permit tcp any AD_SERVER_18-1 eq 445 count
    690 permit udp any AD_SERVER_18-1 eq 445 count
    700 permit tcp any AD_SERVER_18-1 eq 3269 count
    710 permit udp any AD_SERVER_18-1 eq 123 count
    720 permit tcp any AD_SERVER_18-1 eq 135 count
    730 permit tcp any AD_SERVER_18-1 eq 53 count
    740 permit udp any AD_SERVER_18-1 eq 53 count
    750 permit udp any AD_SERVER_18-1 eq 88 count
    760 permit udp any AD_SERVER_18-1 eq 137 count
    770 permit tcp any AD_SERVER_18-1 eq 636 count
    780 permit tcp any AD_SERVER_18-1 eq 389 count
    790 permit tcp any AD_SERVER_18-1 range 49201 50201 count
    800 permit udp any AD_SERVER_18-1 range 49201 50201 count
    810 permit tcp any AD_SERVER_18-1 eq 123 count
    820 permit tcp any AD_SERVER_18-1 eq 88 count
    830 permit tcp any AD_SERVER_18-1 eq 464 count
    840 permit udp any AD_SERVER_18-1 eq 464 count
    850 comment -- AMT
    860 permit any any 10.74.195.192/27 count
    870 permit any any 10.71.0.64/27 count
    880 permit tcp any 165.130.184.110 eq 80 count
    890 permit tcp any 165.130.184.110 eq 135 count
    900 permit tcp any 165.130.184.110 eq 5518 count
    910 permit tcp any 165.130.184.110 gt 1024 count
    920 permit udp any 165.130.184.110 eq 500 count
    930 permit tcp any 165.130.190.95 eq 135 count
    940 permit tcp any 165.130.223.95 eq 135 count
    950 permit tcp any 165.130.190.95 range 49201 50201 count
    960 permit tcp any 165.130.223.95 range 49201 50201 count
    970 permit udp any 165.130.190.95 range 49201 50201 count
    980 permit udp any 165.130.223.95 range 49201 50201 count
    990 permit tcp any eq 623 165.130.184.110 count
    1000 permit tcp any eq 664 165.130.184.110 count
    1010 permit tcp any eq 16992 165.130.184.110 count
    1020 permit tcp any eq 16993 165.130.184.110 count
    1030 permit tcp any eq 16994 165.130.184.110 count
    1040 permit tcp any eq 16995 165.130.184.110 count
    1050 permit tcp any eq 623 VPN_CLIENTS_18-1 count
    1060 permit tcp any eq 664 VPN_CLIENTS_18-1 count
    1070 permit tcp any eq 16992 VPN_CLIENTS_18-1 count
    1080 permit tcp any eq 16993 VPN_CLIENTS_18-1 count
    1090 permit tcp any eq 16994 VPN_CLIENTS_18-1 count
    1100 permit tcp any eq 16995 VPN_CLIENTS_18-1 count
    1110 comment -- DHCP
    1120 permit udp any 255.255.255.255 eq 53 count
    1130 permit udp any 255.255.255.255 eq 67 count
    1140 permit udp any 10.128.0.1/255.128.7.255 eq 53 count
    1150 permit udp any 10.128.0.1/255.128.7.255 eq 67 count
    1160 permit udp any 10.128.0.38/255.128.7.255 eq 53 count
    1170 permit udp any 10.128.0.38/255.128.7.255 eq 67 count
    1180 permit udp any 10.128.0.52/255.128.7.255 eq 53 count
    1190 permit udp any 10.128.0.52/255.128.7.255 eq 67 count
    1200 comment -- DNS
    1210 permit udp any DNS_SERVER_18-1 eq 53 count
    1220 permit tcp any DNS_SERVER_18-1 eq 53 count
    1230 permit tcp any 10.128.0.1/255.128.7.255 eq 53 count
    1240 comment -- NTP
    1250 permit udp any NTP_SERVER_18-1 eq 123 count
    1260 comment -- Key Management Servers
    1270 permit tcp any KMS_SERVER_18-1 eq 1688 count
    1280 comment -- Powershell and Remote Management
    1290 permit tcp any eq 135 VPN_CLIENTS_18-1 count
    1300 permit tcp any eq 137 VPN_CLIENTS_18-1 count
    1310 permit tcp any eq 2701 VPN_CLIENTS_18-1 count
    1320 permit tcp any eq 5985 VPN_CLIENTS_18-1 count
    1330 permit tcp any eq 135 151.140.102.102 count
    1340 permit tcp any eq 137 151.140.102.102 count
    1350 permit tcp any eq 2701 151.140.102.102 count
    1360 permit tcp any eq 5985 151.140.102.102 count
    1370 permit tcp any eq 135 151.140.50.191 count
    1380 permit tcp any eq 137 151.140.50.191 count
    1390 permit tcp any eq 2701 151.140.50.191 count
    1400 permit tcp any eq 5985 151.140.50.191 count
    1410 permit tcp any eq 135 151.140.13.5 count
    1420 permit tcp any eq 137 151.140.13.5 count
    1430 permit tcp any eq 2701 151.140.13.5 count
    1440 permit tcp any eq 5985 151.140.13.5 count
    1450 permit tcp any eq 135 151.140.0.142 count
    1460 permit tcp any eq 137 151.140.0.142 count
    1470 permit tcp any eq 2701 151.140.0.142 count
    1480 permit tcp any eq 5985 151.140.0.142 count
    1490 comment -- Local HSRP
    1500 permit udp any eq 1985 224.0.0.2 eq 1985 count
    1510 comment -- Local VRRP
    1520 permit udp any eq 1985 224.0.0.18 eq 1986 count
    1530 Comment -- VLAN 10 Standard apps security traffic 
    1540 permit tcp 10.128.4.0/255.128.7.128 SCCM_SERVER_4 group PORTS-80-443-10123 count
    1550 permit udp 10.128.4.0/255.128.7.128 SCCM_SERVER_4 group PORTS-67-68-69-4011 count
    1560 permit tcp 10.128.4.0/255.128.7.128 ENCASE_01 eq 4445 count
    1570 permit tcp 10.128.4.0/255.128.7.128 TANIUM_01 eq 17475 count 
    1580 permit tcp 10.128.4.0/255.128.7.128 TANIUM_02 eq 17472 count 
    1590 permit udp 10.128.4.0/255.128.7.128 SCCM_SERVER_5 eq 135 count
    1600 permit tcp 10.128.4.0/255.128.7.128 SCCM_SERVER_5 group PORTS-445-135 count
    1610 permit tcp 10.128.4.0/255.128.7.128 PEWEBSERVER_01 eq 8082 count
    1620 permit tcp 10.128.4.0/255.128.7.128 FORCEPOINT_01 eq 443 count
    1630 permit tcp 10.128.4.0/255.128.7.128 group PORTS-2701-3389-139-137-445-5985-5986 T2_Jump_Hosts_18-1 count
    1640 permit udp 10.128.4.0/255.128.7.128 group PORTS-137-138 T2_Jump_Hosts_18-1 count
    1650 permit icmp 10.128.4.0/255.128.7.128 T2_Jump_Hosts_18-1 count
    1660 permit tcp 10.128.4.0/255.128.7.128 CROWDSTRIKE1 eq 443 count
    1670 permit tcp 10.128.4.0/255.128.7.128 CROWDSTRIKE2 eq 443 count
    1680 permit tcp 10.128.4.0/255.128.7.128 CROWDSTRIKE3 eq 443 count
    1690 comment -- Explicit Deny All 
    1700 deny any any any log count
access-list ip FW-VLAN14-IN-CSR
    10 permit udp any 10.128.0.40/255.128.7.255 range 8000 61000 count
    20 permit tcp any any established count
    30 permit icmp any any icmp-type echo count
    40 permit icmp any any icmp-type 3 count
    50 permit icmp any any icmp-type echo-reply count
    60 permit udp any 10.121.128.0/17 range 16384 32767 count
    70 permit udp any 10.122.128.0/17 range 16384 32767 count
    80 permit udp any 10.128.6.0/255.128.7.128 range 16384 32767 count
    90 permit udp any 10.128.5.0/255.128.7.0 range 16384 32767 count
    100 permit tcp any 10.121.128.0/17 eq 2000 count
    110 permit tcp any 10.122.128.0/17 eq 2000 count
    120 permit tcp any 165.130.208.71 eq 8080 count
    130 permit tcp any 10.128.0.1/255.128.7.255 range 10000 13500 count
    140 permit tcp any 10.128.0.45/255.128.7.255 range 10000 13500 count
    150 permit udp any any eq 123 count
    160 permit udp any any eq 53 count
    170 permit udp any any eq 67 count
    180 permit tcp any any eq 53 count
    190 permit tcp any any eq 13 count
    200 permit tcp any any eq 80 count
    210 permit tcp any any eq 443 count
    220 permit udp any 10.121.128.0/17 eq 2000 count
    230 permit udp any 10.122.128.0/17 eq 2000 count
    240 permit udp any eq 161 10.128.0.0/255.128.7.0 count
    250 permit udp any eq 68 10.128.0.0/255.128.7.0 count
    260 permit any 239.192.2.0/24 any count
    270 permit any any 239.192.2.0/24 count
    280 permit udp any 224.0.0.2 eq 1985 count
    290 permit pim any any count
    300 permit igmp any any count
    310 permit udp any 10.23.20.0/24 eq 69 count
    320 permit udp any 10.23.20.0/24 eq 2000 count
    330 permit udp any 10.23.20.0/24 eq 6969 count
    340 permit udp any 10.33.20.0/24 eq 69 count
    350 permit udp any 10.33.20.0/24 eq 2000 count
    360 permit udp any 10.33.20.0/24 eq 6969 count
    370 permit tcp any 10.23.20.0/24 eq 2000 count
    380 permit tcp any 10.33.20.0/24 eq 2000 count
    390 permit udp any 10.23.20.0/24 range 5060 5100 count
    400 permit tcp any 10.23.20.0/24 range 5060 5100 count
    410 permit udp any 10.33.20.0/24 range 5060 5100 count
    420 permit tcp any 10.33.20.0/24 range 5060 5100 count
    430 permit udp any 10.23.20.0/24 range 16384 61000 count
    440 permit udp any 10.33.20.0/24 range 16384 61000 count
    450 permit udp any range 16384 61000 10.23.20.0/24 count
    460 permit udp any range 16384 61000 10.33.20.0/24 count
    470 permit tcp any 165.130.2.3 eq 2003 count
    480 comment -- Local VRRP
    490 permit udp any 224.0.0.18 eq 1985 count
    500 deny any any any log count
access-list ip FW-VLAN14-OUT-CSR
    10 permit udp 10.128.0.40/255.128.7.255 any range 8000 61000 count
    20 permit tcp any any established count
    30 permit icmp any any icmp-type echo count
    40 permit icmp any any icmp-type 3 count
    50 permit icmp any any icmp-type echo-reply count
    60 permit udp 10.128.6.0/255.128.7.128 range 16384 32767 any count
    70 permit udp 10.128.5.0/255.128.7.0 range 16384 32767 any count
    80 permit tcp 172.19.136.0/25 any eq 7775 count
    90 permit tcp 172.19.144.0/25 any eq 7775 count
    100 permit tcp 172.19.152.0/25 any eq 7775 count
    110 permit tcp 172.19.224.0/25 any eq 7775 count
    120 permit udp any eq 123 any count
    130 permit udp any eq 53 any count
    140 permit udp any eq 67 any count
    150 permit tcp 172.19.174.0/24 any eq 7775 count
    160 permit tcp 172.19.190.0/24 any eq 7775 count
    170 permit tcp 172.19.206.0/24 any eq 7775 count
    180 permit tcp 172.19.222.0/24 any eq 7775 count
    190 permit tcp 172.19.175.64/26 any eq 7775 count
    200 permit tcp 172.19.191.64/26 any eq 7775 count
    210 permit tcp 172.19.207.64/26 any eq 7775 count
    220 permit tcp 172.19.223.64/26 any eq 7775 count
    230 permit tcp 172.26.26.112/30 any eq 7775 count
    240 permit tcp 172.26.26.208/29 any eq 7775 count
    250 deny tcp any any eq 443 count
    260 permit udp 10.121.128.0/17 eq 2000 any count
    270 permit udp 10.122.128.0/17 eq 2000 any count
    280 permit udp 10.121.128.0/17 range 16384 32767 any range 16384 32767 count
    290 permit udp 10.122.128.0/17 range 16384 32767 any range 16384 32767 count
    300 permit tcp 10.128.0.45/255.128.7.255 any eq 3003 count
    310 permit udp 10.128.0.0/255.128.7.0 any eq 161 count
    320 permit udp 10.128.0.0/255.128.7.0 any eq 68 count
    330 permit tcp any eq 80 any count
    340 permit any any 239.192.2.0/24 count
    350 permit any 239.192.2.0/24 any count
    360 permit pim any any count
    370 permit igmp any any count
    380 permit udp any 224.0.0.2 eq 1985 count
    390 permit udp 10.23.20.0/24 eq 2000 any count
    400 permit udp 10.33.20.0/24 eq 2000 any count
    410 permit udp 10.23.20.0/24 range 5060 5100 any count
    420 permit tcp 10.23.20.0/24 range 5060 5100 any count
    430 permit udp 10.33.20.0/24 range 5060 5100 any count
    440 permit tcp 10.33.20.0/24 range 5060 5100 any count
    450 permit udp 10.23.20.0/24 any range 16384 61000 count
    460 permit udp 10.23.20.0/24 range 16384 61000 any count
    470 permit udp 10.33.20.0/24 any range 16384 61000 count
    480 permit udp 10.33.20.0/24 range 16384 61000 any count
    490 permit tcp 165.130.2.3 eq 2003 any count
    500 comment -- Local VRRP
    510 permit udp any 224.0.0.18 eq 1985 count
    520 permit tcp 10.97.0.0/16 any eq 7775 count
    530 permit tcp 10.98.0.0/16 any eq 7775 count
    540 permit tcp 10.99.0.0/16 any eq 7775 count
    560 permit tcp 10.101.0.0/16 any eq 7775 count
    570 permit tcp 10.102.0.0/16 any eq 7775 count
    580 permit tcp 10.103.0.0/16 any eq 7775 count
    590 deny any any any count
access-list ip FW-VLAN30-IN-CSR
    10 permit tcp any any established count
    20 permit any 10.128.6.128/255.128.7.128 10.17.64.0/255.255.254.0 count
    30 permit any 10.128.6.128/255.128.7.128 10.16.92.0/255.255.254.0 count
    40 deny tcp 10.128.6.128/255.128.7.128 10.128.0.1/255.128.7.255 group PORTS-8080-3128 log count
    50 deny tcp 10.128.6.128/255.128.7.128 10.128.0.41/255.128.7.255 group PORTS-8080-3128 log count
    60 deny tcp 10.128.6.128/255.128.7.128 10.128.0.45/255.128.7.255 group PORTS-8080-3128 log count
    70 permit tcp 10.128.6.128/255.128.7.128 CROWDSTRIKE1 eq 443 count
    80 permit tcp 10.128.6.128/255.128.7.128 CROWDSTRIKE2 eq 443 count
    90 permit tcp 10.128.6.128/255.128.7.128 CROWDSTRIKE3 eq 443 count
    95 permit tcp 10.128.6.128/255.128.7.128 GOOGLE-NETS eq 443 count
    100 permit tcp 10.128.6.128/255.128.7.128 192.168.77.5 eq 8080 count
    110 permit tcp 10.128.6.128/255.128.7.128 10.64.170.182 eq 8080 count
    120 permit tcp 10.128.6.128/255.128.7.128 10.77.96.206/255.255.255.254 group PORTS-8080-9898 count
    130 permit tcp 10.128.6.128/255.128.7.128 10.77.96.208/255.255.255.254 group PORTS-8080-9898 count
    140 permit tcp 10.128.6.128/255.128.7.128 10.77.96.210 group PORTS-8080-9898 count
    150 permit tcp 10.128.6.128/255.128.7.128 10.69.96.198/255.255.255.254 group PORTS-8080-9898 count
    160 permit tcp 10.128.6.128/255.128.7.128 10.69.96.200/255.255.255.254 group PORTS-8080-9898 count
    170 permit tcp 10.128.6.128/255.128.7.128 10.69.96.202/255.255.255.254 group PORTS-8080-9898 count
    180 permit tcp 10.128.6.128/255.128.7.128 10.69.96.204/255.255.255.254 group PORTS-8080-9898 count
    190 permit tcp 10.128.6.128/255.128.7.128 10.69.96.206/255.255.255.254 group PORTS-8080-9898 count
    200 permit tcp 10.128.6.128/255.128.7.128 10.77.96.198/255.255.255.254 group PORTS-8080-9898 count
    210 permit tcp 10.128.6.128/255.128.7.128 10.77.96.200/255.255.255.254 group PORTS-8080-9898 count
    220 permit tcp 10.128.6.128/255.128.7.128 10.77.96.202/255.255.255.254 group PORTS-8080-9898 count
    230 permit tcp 10.128.6.128/255.128.7.128 10.77.96.204/255.255.255.254 group PORTS-8080-9898 count
    240 permit tcp 10.128.6.128/255.128.7.128 151.140.102.24/255.255.255.248 group PORTS-8080-9898 count
    250 permit tcp 10.128.6.128/255.128.7.128 151.140.102.32/255.255.255.254 group PORTS-8080-9898 count
    260 permit tcp 10.128.6.128/255.128.7.128 151.140.50.132/255.255.255.252 group PORTS-8080-9898 count
    270 permit tcp 10.128.6.128/255.128.7.128 151.140.50.136/255.255.255.252 group PORTS-8080-9898 count
    280 permit tcp 10.128.6.128/255.128.7.128 151.140.50.140 group PORTS-8080-9898 count
    290 permit tcp 10.128.6.128/255.128.7.128 165.130.167.250 group PORTS-WWW-443 count
    300 permit tcp 10.128.6.128/255.128.7.128 165.130.175.250 group PORTS-WWW-443 count
    310 permit tcp 10.128.6.128/255.128.7.128 151.140.4.11 group PORTS-8077-8079 count
    320 permit tcp 10.128.6.128/255.128.7.128 151.140.4.12 group PORTS-8077-8079 count
    330 permit tcp 10.128.6.128/255.128.7.128 151.140.4.13 group PORTS-8077-8079 count
    340 permit tcp 10.128.6.128/255.128.7.128 151.140.4.14 group PORTS-8077-8079 count
    350 permit tcp 10.128.6.128/255.128.7.128 151.140.4.15 group PORTS-8077-8079 count
    360 permit tcp 10.128.6.128/255.128.7.128 151.140.4.16 group PORTS-8077-8079 count
    370 permit tcp 10.128.6.128/255.128.7.128 151.140.4.17 group PORTS-8077-8079 count
    380 permit tcp 10.128.6.128/255.128.7.128 151.140.4.19 group PORTS-8077-8079 count
    390 permit tcp 10.128.6.128/255.128.7.128 151.140.4.20 group PORTS-8077-8079 count
    400 permit tcp 10.128.6.128/255.128.7.128 151.140.4.21 group PORTS-8077-8079 count
    410 permit tcp 10.128.6.128/255.128.7.128 151.140.28.11 group PORTS-8077-8079 count
    420 permit tcp 10.128.6.128/255.128.7.128 151.140.28.12 group PORTS-8077-8079 count
    430 permit tcp 10.128.6.128/255.128.7.128 151.140.28.13 group PORTS-8077-8079 count
    440 permit tcp 10.128.6.128/255.128.7.128 151.140.28.14 group PORTS-8077-8079 count
    450 permit tcp 10.128.6.128/255.128.7.128 151.140.28.15 group PORTS-8077-8079 count
    460 permit tcp 10.128.6.128/255.128.7.128 151.140.28.16 group PORTS-8077-8079 count
    470 permit tcp 10.128.6.128/255.128.7.128 151.140.28.17 group PORTS-8077-8079 count
    480 permit tcp 10.128.6.128/255.128.7.128 151.140.28.24 group PORTS-8077-8079 count
    490 permit tcp 10.128.6.128/255.128.7.128 151.140.28.25 group PORTS-8077-8079 count
    500 permit tcp 10.128.6.128/255.128.7.128 151.140.4.18 group PORTS-8077-8079 count
    510 permit tcp 10.128.6.128/255.128.7.128 151.140.69.18 group PORTS-8077-8079 count
    520 permit tcp 10.128.6.128/255.128.7.128 151.140.79.27 group PORTS-WWW-445 count
    530 permit udp 10.128.6.128/255.128.7.128 any eq 1985 count
    540 permit udp 10.128.6.128/255.128.7.128 any eq 161 count
    550 permit udp any any group PORTS-BOOTPS-BOOTPC count
    560 permit udp 10.128.6.128/255.128.7.128 165.130.1.1 eq 162 count
    570 permit icmp 10.128.6.128/255.128.7.128 10.128.0.1/255.128.7.255 count
    580 permit icmp 10.128.6.128/255.128.7.128 10.128.0.45/255.128.7.255 count
    590 permit udp 10.128.6.128/255.128.7.128 10.128.0.1/255.128.7.255 group PORTS-NTP-DNS count
    600 permit udp 10.128.6.128/255.128.7.128 10.128.0.49/255.128.7.255 group PORTS-NTP-DNS count
    610 permit tcp 10.128.6.128/255.128.7.128 10.128.0.1/255.128.7.255 eq 53 count
    620 permit tcp 10.128.6.128/255.128.7.128 10.128.0.49/255.128.7.255 eq 53 count
    630 permit tcp 10.128.6.128/255.128.7.128 10.128.0.1/255.128.7.255 group PORTS-WWW-12120-22-500-TELNET count
    640 permit tcp 10.128.6.128/255.128.7.128 10.128.0.45/255.128.7.255 eq 80 count
    650 permit tcp 10.128.6.128/255.128.7.128 10.128.0.49/255.128.7.255 group PORTS-WWW-13150 count
    660 permit tcp 10.128.6.128/255.128.7.128 10.128.0.52/255.128.7.255 eq 80 count
    670 permit tcp 10.128.6.128/255.128.7.128 10.128.0.53/255.128.7.255 eq 80 count
    680 permit tcp 10.128.6.128/255.128.7.128 165.130.163.1 eq 80 count
    690 permit tcp 10.128.6.128/255.128.7.128 165.130.171.1 eq 80 count
    700 permit tcp 10.128.6.128/255.128.7.128 165.130.179.1 eq 80 count
    710 permit tcp 10.128.6.128/255.128.7.128 165.130.166.182 eq 80 count
    720 permit tcp 10.128.6.128/255.128.7.128 165.130.174.182 eq 80 count
    730 permit tcp 10.128.6.128/255.128.7.128 165.130.166.80 eq 443 count
    740 permit tcp 10.128.6.128/255.128.7.128 165.130.174.80 eq 443 count
    750 permit tcp 10.128.6.128/255.128.7.128 151.140.0.131 group PORTS-3269-9389-49204-49206 count
    760 permit tcp 10.128.6.128/255.128.7.128 151.140.0.132/255.255.255.254 group PORTS-3269-9389-49204-49206 count
    770 permit tcp 10.128.6.128/255.128.7.128 151.140.0.134/255.255.255.254 group PORTS-3269-9389-49204-49206 count
    780 permit tcp 10.128.6.128/255.128.7.128 151.140.0.136 group PORTS-3269-9389-49204-49206 count
    790 permit tcp 10.128.6.128/255.128.7.128 10.69.104.10 group PORTS-WWW-443-64084-8082-8443-8444 count
    800 permit tcp 10.128.6.128/255.128.7.128 151.140.105.64/255.255.255.254 group PORTS-3269-9389-49204-49206 count
    810 permit tcp 10.128.6.128/255.128.7.128 151.140.107.218 group PORTS-3269-9389-49204-49206 count
    820 permit tcp 10.128.6.128/255.128.7.128 151.140.48.217 group PORTS-3269-9389-49204-49206 count
    830 permit tcp 10.128.6.128/255.128.7.128 151.140.48.218/255.255.255.254 group PORTS-3269-9389-49204-49206 count
    840 permit tcp 10.128.6.128/255.128.7.128 151.140.77.9 group PORTS-3269-9389-49204-49206 count
    850 permit tcp 10.128.6.128/255.128.7.128 165.130.143.238 group PORTS-3269-9389-49204-49206 count
    860 permit tcp 10.128.6.128/255.128.7.128 165.130.143.29 group PORTS-3269-9389-49204-49206 count
    870 permit tcp 10.128.6.128/255.128.7.128 165.130.150.20 group PORTS-3269-9389-49204-49206 count
    880 permit tcp 10.128.6.128/255.128.7.128 165.130.204.211 group PORTS-3269-9389-49204-49206 count
    890 permit tcp 10.128.6.128/255.128.7.128 165.130.208.217 group PORTS-3269-9389-49204-49206 count
    900 permit tcp 10.128.6.128/255.128.7.128 165.130.218.4/255.255.255.254 group PORTS-3269-9389-49204-49206 count
    910 permit tcp 10.128.6.128/255.128.7.128 165.130.218.5 group PORTS-3269-9389-49204-49206 count
    920 permit tcp 10.128.6.128/255.128.7.128 165.130.132.115 eq 8087 count
    930 permit tcp 10.128.6.128/255.128.7.128 165.130.140.140 eq 88 count
    940 permit tcp 10.128.6.128/255.128.7.128 165.130.223.68 eq 80 count
    950 permit tcp 10.128.6.128/255.128.7.128 165.130.223.69 eq 80 count
    960 permit tcp 10.128.6.128/255.128.7.128 165.130.223.70 eq 80 count
    970 permit tcp 10.128.6.128/255.128.7.128 165.130.223.107 eq 80 count
    980 permit tcp 10.128.6.128/255.128.7.128 165.130.223.108 eq 80 count
    990 permit tcp 10.128.6.128/255.128.7.128 165.130.184.109 eq 80 count
    1000 permit tcp 10.128.6.128/255.128.7.128 10.69.100.140/255.255.255.254 group PORTS-8014-9090-8443 count
    1010 permit tcp 10.128.6.128/255.128.7.128 10.69.100.142/255.255.255.254 group PORTS-8014-9090-8443 count
    1020 permit tcp 10.128.6.128/255.128.7.128 10.69.100.144/255.255.255.254 group PORTS-8014-9090-8443 count
    1030 permit tcp 10.128.6.128/255.128.7.128 10.69.100.146/255.255.255.254 group PORTS-8014-9090-8443 count
    1040 permit tcp 10.128.6.128/255.128.7.128 10.77.100.140/255.255.255.254 group PORTS-8014-9090-8443 count
    1050 permit tcp 10.128.6.128/255.128.7.128 10.77.100.142/255.255.255.254 group PORTS-8014-9090-8443 count
    1060 permit tcp 10.128.6.128/255.128.7.128 10.77.100.144/255.255.255.254 group PORTS-8014-9090-8443 count
    1070 permit tcp 10.128.6.128/255.128.7.128 10.77.100.146/255.255.255.254 group PORTS-8014-9090-8443 count
    1080 permit udp 10.128.6.128/255.128.7.128 165.130.1.1 eq 50001 count
    1090 permit tcp 10.128.6.128/255.128.7.128 165.130.186.0/255.255.255.0 eq 8014 count
    1100 permit tcp 10.128.6.128/255.128.7.128 165.130.218.0/255.255.255.0 eq 8014 count
    1110 permit tcp 10.128.6.128/255.128.7.128 151.140.12.154 eq 8014 count
    1120 permit tcp 10.128.6.128/255.128.7.128 151.140.12.155 eq 8014 count
    1130 permit tcp 10.128.6.128/255.128.7.128 151.140.12.156 eq 8014 count
    1140 permit tcp 10.128.6.128/255.128.7.128 151.140.12.157 eq 8014 count
    1150 permit tcp 10.128.6.128/255.128.7.128 151.140.12.158 eq 8014 count
    1160 permit tcp 10.128.6.128/255.128.7.128 151.140.3.90 eq 8014 count
    1170 permit tcp 10.128.6.128/255.128.7.128 151.140.3.91 eq 8014 count
    1180 permit tcp 10.128.6.128/255.128.7.128 151.140.101.134 eq 8014 count
    1190 permit tcp 10.128.6.128/255.128.7.128 151.140.101.135 eq 8014 count
    1200 permit tcp 10.128.6.128/255.128.7.128 151.140.101.136 eq 8014 count
    1210 permit tcp 10.128.6.128/255.128.7.128 151.140.101.137 eq 8014 count
    1220 permit tcp 10.128.6.128/255.128.7.128 151.140.101.138 eq 8014 count
    1230 permit tcp 10.128.6.128/255.128.7.128 151.140.77.58 eq 8014 count
    1240 permit tcp 10.128.6.128/255.128.7.128 151.140.77.59 eq 8014 count
    1250 permit tcp 10.128.6.128/255.128.7.128 10.128.0.13/255.128.7.255 eq 2967 count
    1260 permit tcp 10.128.6.128/255.128.7.128 10.128.0.14/255.128.7.255 eq 2967 count
    1270 permit tcp 10.128.6.128/255.128.7.128 10.128.0.22/255.128.7.255 eq 2967 count
    1280 permit tcp 10.128.6.128/255.128.7.128 192.127.224.1 eq 443 count
    1290 permit tcp 10.128.6.128/255.128.7.128 192.127.224.16 eq 443 count
    1300 permit tcp 10.128.6.128/255.128.7.128 192.127.224.43 eq 443 count
    1310 permit tcp 10.128.6.128/255.128.7.128 10.74.16.0/255.255.255.128 group PORTS-88-MSRPC-139-389-445-464-636 count
    1320 permit tcp 10.128.6.128/255.128.7.128 10.66.16.0/255.255.255.128 group PORTS-88-MSRPC-139-389-445-464-636 count
    1330 permit tcp 10.128.6.128/255.128.7.128 10.74.16.0/255.255.255.128 group PORTS-3268-3269-9389-49204-49206 count
    1340 permit tcp 10.128.6.128/255.128.7.128 10.66.16.0/255.255.255.128 group PORTS-3268-3269-9389-49204-49206 count
    1350 permit udp 10.128.6.128/255.128.7.128 10.74.16.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    1360 permit udp 10.128.6.128/255.128.7.128 10.66.16.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    1370 permit tcp 10.128.6.128/255.128.7.128 10.74.22.0/255.255.255.128 group PORTS-88-MSRPC-139-389-445-464-636 count
    1380 permit tcp 10.128.6.128/255.128.7.128 10.66.22.0/255.255.255.128 group PORTS-88-MSRPC-139-389-445-464-636 count
    1390 permit tcp 10.128.6.128/255.128.7.128 10.74.22.0/255.255.255.128 group PORTS-3268-3269-9389-49204-49206 count
    1400 permit tcp 10.128.6.128/255.128.7.128 10.66.22.0/255.255.255.128 group PORTS-3268-3269-9389-49204-49206 count
    1410 permit udp 10.128.6.128/255.128.7.128 10.74.22.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    1420 permit udp 10.128.6.128/255.128.7.128 10.66.22.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    1430 permit tcp 10.128.6.128/255.128.7.128 165.130.143.238 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1440 permit tcp 10.128.6.128/255.128.7.128 151.140.13.125 group PORTS-WWW-443 count
    1450 permit udp 10.128.6.128/255.128.7.128 151.140.13.125 group PORTS-WWW-443 count
    1460 permit tcp 10.128.6.128/255.128.7.128 151.140.84.87 group PORTS-WWW-443 count
    1470 permit udp 10.128.6.128/255.128.7.128 151.140.84.87 group PORTS-WWW-443 count
    1480 permit tcp 10.128.6.128/255.128.7.128 165.130.143.29 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1490 permit tcp 10.128.6.128/255.128.7.128 165.130.218.182 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1500 permit tcp 10.128.6.128/255.128.7.128 165.130.218.181 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1510 permit tcp 10.128.6.128/255.128.7.128 165.130.218.180 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1520 permit tcp 10.128.6.128/255.128.7.128 165.130.218.179 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1530 permit tcp 10.128.6.128/255.128.7.128 172.26.242.50 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1540 permit tcp 10.128.6.128/255.128.7.128 165.130.150.20 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1550 permit tcp 10.128.6.128/255.128.7.128 151.140.105.64 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1560 permit tcp 10.128.6.128/255.128.7.128 151.140.105.65 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1570 permit tcp 10.128.6.128/255.128.7.128 151.140.77.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1580 permit tcp 10.128.6.128/255.128.7.128 151.140.107.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1590 permit tcp 10.128.6.128/255.128.7.128 165.130.65.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1600 permit tcp 10.128.6.128/255.128.7.128 165.130.73.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1610 permit tcp 10.128.6.128/255.128.7.128 165.130.73.10 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1620 permit tcp 10.128.6.128/255.128.7.128 172.16.184.14 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1630 permit tcp 10.128.6.128/255.128.7.128 172.31.38.22 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1640 permit tcp 10.128.6.128/255.128.7.128 172.16.144.13 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1650 permit tcp 10.128.6.128/255.128.7.128 165.130.210.130 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1660 permit tcp 10.128.6.128/255.128.7.128 165.130.210.127 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1670 permit tcp 10.128.6.128/255.128.7.128 165.130.204.94 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1680 permit tcp 10.128.6.128/255.128.7.128 172.16.152.118 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1690 permit tcp 10.128.6.128/255.128.7.128 172.16.160.16 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1700 permit tcp 10.128.6.128/255.128.7.128 172.30.59.18 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1710 permit tcp 10.128.6.128/255.128.7.128 151.140.48.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1720 permit tcp 10.128.6.128/255.128.7.128 151.140.48.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1730 permit tcp 10.128.6.128/255.128.7.128 151.140.48.219 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1740 permit tcp 10.128.6.128/255.128.7.128 165.130.208.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1750 permit tcp 10.128.6.128/255.128.7.128 165.130.204.211 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1760 permit tcp 10.128.6.128/255.128.7.128 151.140.0.131 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1770 permit tcp 10.128.6.128/255.128.7.128 165.130.218.4 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1780 permit tcp 10.128.6.128/255.128.7.128 165.130.218.5 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1790 permit tcp 10.128.6.128/255.128.7.128 151.140.0.132 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1800 permit tcp 10.128.6.128/255.128.7.128 151.140.0.133 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1810 permit tcp 10.128.6.128/255.128.7.128 151.140.0.134 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1820 permit tcp 10.128.6.128/255.128.7.128 151.140.0.135 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1830 permit tcp 10.128.6.128/255.128.7.128 151.140.0.136 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1840 permit udp 10.128.6.128/255.128.7.128 165.130.143.238 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1850 permit udp 10.128.6.128/255.128.7.128 165.130.143.29 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1860 permit udp 10.128.6.128/255.128.7.128 165.130.218.182 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1870 permit udp 10.128.6.128/255.128.7.128 165.130.218.181 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1880 permit udp 10.128.6.128/255.128.7.128 165.130.218.180 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1890 permit udp 10.128.6.128/255.128.7.128 165.130.218.179 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1900 permit udp 10.128.6.128/255.128.7.128 172.26.242.50 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1910 permit udp 10.128.6.128/255.128.7.128 165.130.150.20 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1920 permit udp 10.128.6.128/255.128.7.128 151.140.105.64 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1930 permit udp 10.128.6.128/255.128.7.128 151.140.105.65 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1940 permit udp 10.128.6.128/255.128.7.128 151.140.77.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1950 permit udp 10.128.6.128/255.128.7.128 151.140.107.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1960 permit udp 10.128.6.128/255.128.7.128 165.130.65.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1970 permit udp 10.128.6.128/255.128.7.128 165.130.73.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1980 permit udp 10.128.6.128/255.128.7.128 165.130.73.10 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    1990 permit udp 10.128.6.128/255.128.7.128 172.16.184.14 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2000 permit udp 10.128.6.128/255.128.7.128 172.31.38.22 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2010 permit udp 10.128.6.128/255.128.7.128 172.16.144.13 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2020 permit udp 10.128.6.128/255.128.7.128 165.130.210.130 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2030 permit udp 10.128.6.128/255.128.7.128 165.130.210.127 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2040 permit udp 10.128.6.128/255.128.7.128 165.130.204.94 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2050 permit udp 10.128.6.128/255.128.7.128 172.16.152.118 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2060 permit udp 10.128.6.128/255.128.7.128 172.16.160.16 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2070 permit udp 10.128.6.128/255.128.7.128 172.30.59.18 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2080 permit udp 10.128.6.128/255.128.7.128 151.140.48.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2090 permit udp 10.128.6.128/255.128.7.128 151.140.48.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2100 permit udp 10.128.6.128/255.128.7.128 151.140.48.219 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2110 permit udp 10.128.6.128/255.128.7.128 165.130.208.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2120 permit udp 10.128.6.128/255.128.7.128 165.130.204.211 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2130 permit udp 10.128.6.128/255.128.7.128 151.140.0.131 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2140 permit udp 10.128.6.128/255.128.7.128 165.130.218.4 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2150 permit udp 10.128.6.128/255.128.7.128 165.130.218.5 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2160 permit udp 10.128.6.128/255.128.7.128 151.140.0.132 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2170 permit udp 10.128.6.128/255.128.7.128 151.140.0.133 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2180 permit udp 10.128.6.128/255.128.7.128 151.140.0.134 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2190 permit udp 10.128.6.128/255.128.7.128 151.140.0.135 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2200 permit udp 10.128.6.128/255.128.7.128 151.140.0.136 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 count
    2210 permit tcp 10.128.6.128/255.128.7.128 10.128.0.13/255.128.7.255 group PORTS-WWW-443-445 count
    2220 permit tcp 10.128.6.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-WWW-443-445 count
    2230 permit tcp 10.128.6.128/255.128.7.128 10.128.0.22/255.128.7.255 group PORTS-WWW-443-445 count
    2240 permit udp 10.128.6.128/255.128.7.128 10.128.0.13/255.128.7.255 group PORTS-4011-TFTP count
    2250 permit udp 10.128.6.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-4011-TFTP count
    2260 permit udp 10.128.6.128/255.128.7.128 10.128.0.22/255.128.7.255 group PORTS-4011-TFTP count
    2270 permit tcp 10.128.6.128/255.128.7.128 10.128.0.14/255.128.7.255 eq 135 count
    2280 permit udp 10.128.6.128/255.128.7.128 10.128.0.14/255.128.7.255 eq 135 count
    2290 permit tcp 10.128.6.128/255.128.7.128 10.128.0.22/255.128.7.255 eq 135 count
    2300 permit tcp 10.128.6.128/255.128.7.128 151.140.107.49 group PORTS-WWW-443-10123 count
    2310 permit tcp 10.128.6.128/255.128.7.128 151.140.107.48 group PORTS-WWW-443-10123 count
    2320 permit tcp 10.128.6.128/255.128.7.128 151.140.76.113 group PORTS-WWW-443-10123 count
    2330 permit tcp 10.128.6.128/255.128.7.128 151.140.76.109 group PORTS-WWW-443-10123 count
    2340 permit tcp 10.128.6.128/255.128.7.128 151.140.76.112 group PORTS-WWW-443-10123 count
    2350 permit tcp 10.128.6.128/255.128.7.128 151.140.76.111 group PORTS-WWW-443 count
    2360 permit tcp 10.128.6.128/255.128.7.128 151.140.107.38 group PORTS-WWW-443 count
    2370 permit tcp 10.128.6.128/255.128.7.128 151.140.76.175 group PORTS-WWW-443 count
    2380 permit tcp 10.128.6.128/255.128.7.128 151.140.76.110 group PORTS-WWW-443 count
    2390 permit tcp 10.128.6.128/255.128.7.128 151.140.76.173 group PORTS-WWW-443 count
    2400 permit tcp 10.128.6.128/255.128.7.128 151.140.2.246 group PORTS-WWW-443-10123 count
    2410 permit tcp 10.128.6.128/255.128.7.128 151.140.48.246 group PORTS-WWW-443-10123 count
    2420 permit tcp 10.128.6.128/255.128.7.128 151.140.48.247 group PORTS-WWW-443-10123 count
    2430 permit tcp 10.128.6.128/255.128.7.128 151.140.2.245 group PORTS-WWW-443-10123 count
    2440 permit tcp 10.128.6.128/255.128.7.128 151.140.2.234 group PORTS-WWW-443-10123 count
    2450 permit tcp 10.128.6.128/255.128.7.128 151.140.2.235 group PORTS-WWW-443 count
    2460 permit tcp 10.128.6.128/255.128.7.128 151.140.2.248 group PORTS-WWW-443 count
    2470 permit tcp 10.128.6.128/255.128.7.128 151.140.48.249 group PORTS-WWW-443 count
    2480 permit tcp 10.128.6.128/255.128.7.128 151.140.49.95 group PORTS-WWW-443 count
    2490 permit tcp 10.128.6.128/255.128.7.128 151.140.49.83 group PORTS-WWW-443 count
    2500 permit tcp 10.128.6.128/255.128.7.128 151.140.48.248 group PORTS-WWW-443 count
    2510 permit tcp 10.128.6.128/255.128.7.128 165.130.184.150 eq 80 count
    2520 permit tcp 10.128.6.128/255.128.7.128 165.130.184.151 eq 80 count
    2530 permit tcp 10.128.6.128/255.128.7.128 165.130.184.208 eq 80 count
    2540 permit tcp 10.128.6.128/255.128.7.128 165.130.184.217 eq 80 count
    2550 permit tcp 10.128.6.128/255.128.7.128 165.130.184.210 eq 80 count
    2560 permit tcp 10.128.6.128/255.128.7.128 165.130.184.103 eq 80 count
    2570 permit tcp 10.128.6.128/255.128.7.128 165.130.184.102 eq 80 count
    2580 permit tcp 10.128.6.128/255.128.7.128 165.130.184.177 eq 80 count
    2590 permit tcp 10.128.6.128/255.128.7.128 165.130.184.209 eq 80 count
    2600 permit tcp 10.128.6.128/255.128.7.128 165.130.184.99 eq 80 count
    2610 permit tcp 10.128.6.128/255.128.7.128 165.130.184.115 eq 80 count
    2620 permit tcp 10.128.6.128/255.128.7.128 165.130.184.178 eq 80 count
    2630 permit tcp 10.128.6.128/255.128.7.128 165.130.184.179 eq 80 count
    2640 permit tcp 10.128.6.128/255.128.7.128 165.130.184.101 eq 80 count
    2650 permit tcp 10.128.6.128/255.128.7.128 165.130.184.100 eq 80 count
    2660 permit tcp 10.128.6.128/255.128.7.128 165.130.184.216 eq 80 count
    2670 permit tcp 10.128.6.128/255.128.7.128 165.130.223.164 eq 80 count
    2680 permit tcp 10.128.6.128/255.128.7.128 165.130.223.165 eq 80 count
    2690 permit tcp 10.128.6.128/255.128.7.128 10.66.17.7 group PORTS-WWW-443-10123 count
    2700 permit tcp 10.128.6.128/255.128.7.128 10.66.17.8 group PORTS-WWW-443-10123 count
    2710 permit tcp 10.128.6.128/255.128.7.128 10.66.17.9 group PORTS-WWW-443-10123 count
    2720 permit tcp 10.128.6.128/255.128.7.128 10.66.17.10 group PORTS-WWW-443-10123 count
    2730 permit tcp 10.128.6.128/255.128.7.128 10.66.17.11 group PORTS-WWW-443-10123 count
    2740 permit tcp 10.128.6.128/255.128.7.128 10.66.17.15 group PORTS-WWW-443 count
    2750 permit tcp 10.128.6.128/255.128.7.128 10.66.17.16 group PORTS-WWW-443 count
    2760 permit tcp 10.128.6.128/255.128.7.128 10.66.17.17 eq 80 count
    2770 permit tcp 10.128.6.128/255.128.7.128 165.130.223.166 eq 80 count
    2780 permit tcp 10.128.6.128/255.128.7.128 165.130.223.182 eq 80 count
    2790 permit tcp 10.128.6.128/255.128.7.128 165.130.223.183 eq 80 count
    2800 permit tcp 10.128.6.128/255.128.7.128 165.130.223.180 eq 80 count
    2810 permit tcp 10.128.6.128/255.128.7.128 165.130.223.181 eq 80 count
    2820 permit tcp 10.128.6.128/255.128.7.128 165.130.223.184 eq 80 count
    2830 permit tcp 10.128.6.128/255.128.7.128 165.130.223.185 eq 80 count
    2840 permit tcp 10.128.6.128/255.128.7.128 165.130.223.66 eq 80 count
    2850 permit tcp 10.128.6.128/255.128.7.128 165.130.223.65 eq 80 count
    2860 permit tcp 10.128.6.128/255.128.7.128 165.130.223.168 eq 80 count
    2870 permit tcp 10.128.6.128/255.128.7.128 165.130.223.167 eq 80 count
    2880 permit tcp 10.128.6.128/255.128.7.128 165.130.223.169 eq 80 count
    2890 permit tcp 10.128.6.128/255.128.7.128 165.130.223.67 eq 80 count
    2900 permit tcp 10.128.6.128/255.128.7.128 165.130.184.117 group PORTS-WWW-1433 count
    2910 permit tcp 10.128.6.128/255.128.7.128 165.130.184.112 group PORTS-WWW-1433 count
    2920 permit tcp 10.128.6.128/255.128.7.128 165.130.184.111 group PORTS-WWW-1433 count
    2930 deny udp 10.128.6.128/255.128.7.128 10.128.6.255/255.128.7.255 group PORTS-NETBIOS-NS-NETBIOS-DGM count
    2940 permit any 10.128.6.128/255.128.7.128 10.128.0.0/255.128.0.0 count
    2950 permit any 10.128.6.128/255.128.7.128 10.66.0.0/255.255.0.0 count
    2960 permit any 10.128.6.128/255.128.7.128 10.69.96.0/255.255.224.0 count
    2970 permit any 10.128.6.128/255.128.7.128 10.74.0.0/255.255.0.0 count
    2980 permit any 10.128.6.128/255.128.7.128 10.77.96.0/255.255.224.0 count
    2990 permit any 10.128.6.128/255.128.7.128 165.130.0.0/255.255.0.0 count
    3000 permit any 10.128.6.128/255.128.7.128 151.140.0.0/255.255.0.0 count
    3010 permit any any 151.140.4.23 count
    3020 permit udp 10.128.6.128/255.128.7.128 range 16992 16995 165.130.184.110 count
    3030 permit udp 10.128.6.128/255.128.7.128 group PORTS-623-664 165.130.184.110 count
    3040 permit udp any eq 4011 10.128.0.22/255.128.7.255 count
    3050 permit udp any eq 4011 10.128.0.14/255.128.7.255 count
    3060 permit any 165.130.184.92/255.255.255.254 any count
    3070 permit any 165.130.184.94 any count
    3080 permit any 165.130.184.57 any count
    3090 permit any 165.130.184.58 any count
    3100 permit any 207.11.0.64 any count
    3110 permit any 207.11.0.208 any count
    3120 permit any 207.11.0.252 any count
    3130 permit any 165.130.203.117 any count
    3140 permit any 165.130.203.118 any count
    3150 permit any 207.11.0.210/255.255.255.254 any count
    3160 permit udp any eq 68 10.128.0.0/255.128.7.0 count
    3170 permit udp any eq 67 10.128.0.45/255.128.7.255 eq 67 count
    3180 permit udp 10.128.6.128/255.128.7.128 eq 3389 151.140.102.102 count
    3190 permit udp 10.128.6.128/255.128.7.128 eq 3389 151.140.50.191 count
    3200 permit udp 10.128.6.128/255.128.7.128 group PORTS-7775-137-138 172.26.118.122/255.255.255.254 count
    3210 permit icmp 10.128.6.128/255.128.7.128 172.26.118.122/255.255.255.254 count
    3220 permit icmp any any icmp-type 3 count
    3230 permit icmp any any icmp-type echo-reply count
    3240 permit icmp any any icmp-type echo count
    3250 permit udp any eq 53 any count
    3260 permit udp any eq 161 any count
    3270 permit any any 10.128.0.38/255.128.7.255 count
    3280 permit any any 10.128.0.13/255.128.7.255 count
    3290 permit udp any 165.130.218.179 eq 88 count
    3300 permit udp any 165.130.218.180 eq 88 count
    3310 permit udp any 165.130.218.181 eq 88 count
    3320 permit udp any 165.130.218.182 eq 88 count
    3330 permit any 10.128.6.128/255.128.7.128 CYBERARK_PSM_RDP count
    3340 permit tcp 10.128.6.128/255.128.7.128 10.47.3.0/255.255.255.0 group PORTS-WWW-443 count
    3350 permit udp 10.128.6.128/255.128.7.128 10.47.3.0/255.255.255.0 group PORTS-WWW-443 count
    3360 deny any any any log count
access-list ip FW-VLAN30-OUT_17-7-CSR
    10 permit tcp any any established count
    20 permit any 10.17.64.0/255.255.254.0 10.128.6.128/255.128.7.128
    30 permit any 10.16.92.0/255.255.254.0 10.128.6.128/255.128.7.128
    40 permit tcp 10.69.104.10 10.128.6.128/255.128.7.128 group PORTS-WWW-443-64084-8082-8443-8444 count
    50 permit any 151.140.4.23 any count
    60 permit tcp 151.140.0.139 10.128.6.128/255.128.7.128 eq 4445 count
    70 permit tcp 151.140.102.24/255.255.255.248 10.128.6.128/255.128.7.128 eq 9898 count
    80 permit tcp 151.140.102.32/255.255.255.254 10.128.6.128/255.128.7.128 eq 9898 count
    90 permit tcp 151.140.50.132/255.255.255.252 10.128.6.128/255.128.7.128 eq 9898 count
    100 permit tcp 151.140.50.136/255.255.255.252 10.128.6.128/255.128.7.128 eq 9898 count
    110 permit tcp 151.140.50.140 10.128.6.128/255.128.7.128 eq 9898 count
    120 permit tcp 165.130.184.73 10.128.6.128/255.128.7.128 eq 4445 count
    130 permit tcp 151.140.102.102 10.128.6.128/255.128.7.128 group PORTS-5985-MSRPC count
    140 permit tcp 151.140.50.191 10.128.6.128/255.128.7.128 group PORTS-5985-MSRPC count
    150 permit tcp 151.140.13.5 10.128.6.128/255.128.7.128 group PORTS-5985-MSRPC count
    160 permit tcp 151.140.0.142 10.128.6.128/255.128.7.128 group PORTS-5985-MSRPC count
    170 permit tcp 165.130.184.110 10.128.6.128/255.128.7.128 range 16992 16995 count
    180 permit tcp 165.130.184.110 10.128.6.128/255.128.7.128 group PORTS-623-664 count
    190 permit udp 165.130.184.110 10.128.6.128/255.128.7.128 range 16992 16995 count
    200 permit udp 165.130.184.110 10.128.6.128/255.128.7.128 group PORTS-623-664 count
    210 permit tcp 172.19.174.0/255.255.255.0 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    220 permit tcp 172.19.190.0/255.255.255.0 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    230 permit tcp 172.19.206.0/255.255.255.0 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    240 permit tcp 172.19.222.0/255.255.255.0 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    250 permit tcp 172.19.175.64/255.255.255.192 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    260 permit tcp 172.19.191.64/255.255.255.192 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    270 permit tcp 172.19.207.64/255.255.255.192 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    280 permit tcp 172.19.223.64/255.255.255.192 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-16992-16993-16994-16995 count
    290 permit tcp 151.140.4.11 any eq 22201 count
    300 permit tcp 151.140.4.12 any eq 22201 count
    310 permit tcp 151.140.4.13 any eq 22201 count
    320 permit tcp 151.140.4.14 any eq 22201 count
    330 permit tcp 151.140.4.15 any eq 22201 count
    340 permit tcp 151.140.4.16 any eq 22201 count
    350 permit tcp 151.140.4.17 any eq 22201 count
    360 permit tcp 151.140.4.19 any eq 22201 count
    370 permit tcp 151.140.4.20 any eq 22201 count
    380 permit tcp 151.140.4.21 any eq 22201 count
    390 permit tcp 151.140.28.24 any eq 22201 count
    400 permit tcp 151.140.28.25 any eq 22201 count
    410 permit tcp 151.140.28.11 any eq 22201 count
    420 permit tcp 151.140.28.12 any eq 22201 count
    430 permit tcp 151.140.28.13 any eq 22201 count
    440 permit tcp 151.140.28.14 any eq 22201 count
    450 permit tcp 151.140.28.15 any eq 22201 count
    460 permit tcp 151.140.28.16 any eq 22201 count
    470 permit tcp 151.140.28.17 any eq 22201 count
    480 permit tcp 151.140.4.18 any eq 22201 count
    490 permit tcp 151.140.69.18 any eq 22201 count
    500 permit tcp 10.128.0.22/255.128.7.255 any group PORTS-1109-1367 count
    510 permit tcp 10.128.0.14/255.128.7.255 any group PORTS-1109-1367 count
    520 permit udp 10.128.0.22/255.128.7.255 any eq 4011 count
    530 permit udp 10.128.0.14/255.128.7.255 any eq 4011 count
    540 permit any any 165.130.184.92/255.255.255.254 count
    550 permit any any 165.130.184.94 count
    560 permit any any 165.130.184.57 count
    570 permit any any 165.130.184.58 count
    580 permit any any 207.11.0.64 count
    590 deny any 10.128.6.0/255.128.7.128 any count
    600 permit any any 207.11.0.208 count
    610 permit any any 207.11.0.252 count
    620 permit any any 165.130.203.117 count
    630 permit any any 165.130.203.118 count
    640 permit any any 207.11.0.210/255.255.255.254 count
    650 deny any 10.128.5.0/255.128.7.0 any count
    660 permit tcp 172.19.174.0/255.255.255.0 10.128.0.0/255.128.0.0 group PORTS-MSRPC-139-445-2701-2702 count
    670 permit tcp 172.19.190.0/255.255.255.0 10.128.0.0/255.128.0.0 group PORTS-MSRPC-139-445-2701-2702 count
    680 permit tcp 172.19.206.0/255.255.255.0 10.128.0.0/255.128.0.0 group PORTS-MSRPC-139-445-2701-2702 count
    690 permit tcp 172.19.222.0/255.255.255.0 10.128.0.0/255.128.0.0 group PORTS-MSRPC-139-445-2701-2702 count
    700 permit tcp 172.19.174.0/255.255.255.0 10.128.6.128/255.128.7.128 eq 5985 count
    710 permit tcp 172.19.190.0/255.255.255.0 10.128.6.128/255.128.7.128 eq 5985 count
    720 permit tcp 172.19.206.0/255.255.255.0 10.128.6.128/255.128.7.128 eq 5985 count
    730 permit tcp 172.19.222.0/255.255.255.0 10.128.6.128/255.128.7.128 eq 5985 count
    740 permit udp 10.128.0.0/255.128.7.0 any eq 68 count
    750 permit udp 10.128.0.45/255.128.7.255 eq 67 any eq 67 count
    760 permit tcp 151.140.102.102 10.128.6.128/255.128.7.128 group PORTS-3389-5986 count
    770 permit tcp 151.140.50.191 10.128.6.128/255.128.7.128 group PORTS-3389-5986 count
    780 permit udp 151.140.102.102 10.128.6.128/255.128.7.128 eq 3389 count
    790 permit udp 151.140.50.191 10.128.6.128/255.128.7.128 eq 3389 count
    800 permit tcp 172.26.118.122/255.255.255.254 10.128.6.128/255.128.7.128 group PORTS-7775-137-139-445-MSRPC-2701-2702-3389-5985-5986 count
    810 permit udp 172.26.118.122/255.255.255.254 10.128.6.128/255.128.7.128 group PORTS-7775-137-138 count
    820 permit icmp 172.26.118.122/255.255.255.254 10.128.6.128/255.128.7.128 count
    830 permit udp any any eq 53 count
    840 permit udp any any eq 161 count
    850 permit icmp any any icmp-type 3 count
    860 permit icmp any any icmp-type echo-reply count
    870 permit icmp any any icmp-type echo count
    880 permit tcp 151.140.77.1 any group PORTS-5985-5986 count
    890 permit tcp 151.140.77.2 any group PORTS-5985-5986 count
    900 permit any 10.128.0.38/255.128.7.255 any count
    910 permit any 10.128.0.13/255.128.7.255 any count
    920 permit tcp 10.128.0.1/255.128.7.255 any group PORTS-WWW-1109-1367 count
    930 permit tcp 10.128.0.45/255.128.7.255 any group PORTS-WWW-1109-1367 count
    940 permit tcp 10.128.0.41/255.128.7.255 any group PORTS-WWW-1109-1367 count
    950 permit tcp 10.128.0.49/255.128.7.255 any eq 8082 count
    960 permit tcp 10.128.0.52/255.128.7.255 any eq 8082 count
    970 permit tcp 10.128.0.53/255.128.7.255 any eq 8082 count
    980 permit tcp 10.128.0.54/255.128.7.255 any eq 8082 count
    990 permit tcp 10.128.0.38/255.128.7.255 any group PORTS-445-139 count
    1000 permit tcp 10.128.0.13/255.128.7.255 any group PORTS-WWW-8080 count
    1010 permit tcp 10.128.0.49/255.128.7.255 any eq 80 count
    1020 permit tcp 165.130.184.0/255.255.255.0 any group PORTS-MSRPC-139-445-2701-2702 count
    1030 permit tcp 165.130.223.0/255.255.255.0 any group PORTS-MSRPC-139-445-2701-2702 count
    1040 permit tcp 165.130.205.191 any group PORTS-MSRPC-139-445-2701-2702 count
    1050 permit tcp 165.130.186.17 any group PORTS-MSRPC-139-445-2701-2702 count
    1060 permit tcp 165.130.186.18 any group PORTS-MSRPC-139-445-2701-2702 count
    1070 permit tcp 172.19.175.64/255.255.255.192 any group PORTS-MSRPC-139-445-2701-2702 count
    1080 permit tcp 172.19.191.64/255.255.255.192 any group PORTS-MSRPC-139-445-2701-2702 count
    1090 permit tcp 172.19.207.64/255.255.255.192 any group PORTS-MSRPC-139-445-2701-2702 count
    1100 permit tcp 172.19.223.64/255.255.255.192 any group PORTS-MSRPC-139-445-2701-2702 count
    1110 permit tcp 10.66.0.0/255.255.0.0 10.128.6.128/255.128.7.128 eq 8082 count
    1120 permit tcp 10.69.96.0/255.255.224.0 10.128.6.128/255.128.7.128 eq 8082 count
    1130 permit tcp 10.74.0.0/255.255.0.0 10.128.6.128/255.128.7.128 eq 8082 count
    1140 permit tcp 10.77.96.0/255.255.224.0 10.128.6.128/255.128.7.128 eq 8082 count
    1150 permit tcp 151.140.0.0/255.255.0.0 any eq 8082 count
    1160 permit tcp 165.130.0.0/255.255.0.0 any eq 8082 count
    1170 permit tcp 207.11.0.0/255.255.0.128 any eq 8082 count
    1180 permit tcp 172.19.160.0/255.255.240.0 any eq 8082 count
    1190 permit tcp 172.19.176.0/255.255.240.0 any eq 8082 count
    1200 permit tcp 172.19.192.0/255.255.240.0 any eq 8082 count
    1210 permit tcp 172.19.208.0/255.255.240.0 any eq 8082 count
    1220 permit tcp 172.19.175.64/255.255.255.192 10.128.6.128/255.128.7.128 eq 5985 count
    1230 permit tcp 172.19.191.64/255.255.255.192 10.128.6.128/255.128.7.128 eq 5985 count
    1240 permit tcp 172.19.207.64/255.255.255.192 10.128.6.128/255.128.7.128 eq 5985 count
    1250 permit tcp 172.19.223.64/255.255.255.192 10.128.6.128/255.128.7.128 eq 5985 count
    1260 permit udp 165.130.218.179 eq 88 any count
    1270 permit udp 165.130.218.180 eq 88 any count
    1280 permit udp 165.130.218.181 eq 88 any count
    1290 permit udp 165.130.218.182 eq 88 any count
    1300 permit tcp 10.66.0.0/255.255.0.0 10.128.6.128/255.128.7.128 eq 88 count
    1310 permit tcp 10.69.96.0/255.255.224.0 10.128.6.128/255.128.7.128 eq 88 count
    1320 permit tcp 10.74.0.0/255.255.0.0 10.128.6.128/255.128.7.128 eq 88 count
    1330 permit tcp 10.77.96.0/255.255.224.0 10.128.6.128/255.128.7.128 eq 88 count
    1340 permit tcp 151.140.0.0/255.255.0.0 any eq 88 count
    1350 permit tcp 165.130.0.0/255.255.0.0 any eq 88 count
    1360 permit tcp 172.16.0.0/255.240.0.0 any eq 88 count
    1370 permit tcp 165.130.150.117 any eq 7 count
    1380 permit tcp 165.130.150.117 any eq 514 count
    1390 permit any CYBERARK_PSM_RDP 10.128.6.128/255.128.7.128 count
    1400 permit udp any eq 1985 10.128.6.128/255.128.7.128 count
    1410 permit udp any eq 161 10.128.6.128/255.128.7.128 count
    1420 permit udp any group PORTS-BOOTPS-BOOTPC any count
    1430 permit udp 165.130.1.1 eq 162 10.128.6.128/255.128.7.128 count
    1440 permit icmp 10.128.0.1/255.128.7.255 10.128.6.128/255.128.7.128 count
    1450 permit icmp 10.128.0.45/255.128.7.255 10.128.6.128/255.128.7.128 count
    1460 permit udp 10.128.0.1/255.128.7.255 group PORTS-NTP-DNS 10.128.6.128/255.128.7.128 count
    1470 permit udp 10.128.0.49/255.128.7.255 group PORTS-NTP-DNS 10.128.6.128/255.128.7.128 count
    1480 permit udp 165.130.1.1 eq 50001 10.128.6.128/255.128.7.128 count
    1490 permit udp 10.74.16.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.6.128/255.128.7.128 count
    1500 permit udp 10.66.16.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.6.128/255.128.7.128 count
    1510 permit udp 10.74.22.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.6.128/255.128.7.128 count
    1520 permit udp 10.66.22.0/255.255.255.128 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.6.128/255.128.7.128 count
    1530 permit udp 151.140.13.125 group PORTS-WWW-443 10.128.6.128/255.128.7.128 count
    1540 permit udp 151.140.84.87 group PORTS-WWW-443 10.128.6.128/255.128.7.128 count
    1550 permit udp 165.130.143.238 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1560 permit udp 165.130.143.29 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1570 permit udp 165.130.218.182 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1580 permit udp 165.130.218.181 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1590 permit udp 165.130.218.180 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1600 permit udp 165.130.218.179 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1610 permit udp 172.26.242.50 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1620 permit udp 165.130.150.20 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1630 permit udp 151.140.105.64 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1640 permit udp 151.140.105.65 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1650 permit udp 151.140.77.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1660 permit udp 151.140.107.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1670 permit udp 165.130.65.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1680 permit udp 165.130.73.9 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1690 permit udp 165.130.73.10 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1700 permit udp 172.16.184.14 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1710 permit udp 172.31.38.22 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1720 permit udp 172.16.144.13 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1730 permit udp 165.130.210.130 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1740 permit udp 165.130.210.127 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1750 permit udp 165.130.204.94 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1760 permit udp 172.16.152.118 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1770 permit udp 172.16.160.16 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1780 permit udp 172.30.59.18 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1790 permit udp 151.140.48.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1800 permit udp 151.140.48.218 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1810 permit udp 151.140.48.219 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1820 permit udp 165.130.208.217 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1830 permit udp 165.130.204.211 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1840 permit udp 151.140.0.131 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1850 permit udp 165.130.218.4 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1860 permit udp 165.130.218.5 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1870 permit udp 151.140.0.132 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1880 permit udp 151.140.0.133 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1890 permit udp 151.140.0.134 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1900 permit udp 151.140.0.135 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1910 permit udp 151.140.0.136 group PORTS-DNS-88-MSRPC-139-389-445-464-636-3268 10.128.6.128/255.128.7.128 count
    1920 permit udp 10.128.0.13/255.128.7.255 group PORTS-4011-TFTP 10.128.6.128/255.128.7.128 count
    1930 permit udp 10.128.0.14/255.128.7.255 group PORTS-4011-TFTP 10.128.6.128/255.128.7.128 count
    1940 permit udp 10.128.0.22/255.128.7.255 group PORTS-4011-TFTP 10.128.6.128/255.128.7.128 count
    1950 permit udp 10.128.0.14/255.128.7.255 eq 135 10.128.6.128/255.128.7.128 count
    1960 permit any 10.128.0.0/255.128.0.0 10.128.6.128/255.128.7.128 count
    1970 permit any 10.66.0.0/255.255.0.0 10.128.6.128/255.128.7.128 count
    1980 permit any 10.69.96.0/255.255.224.0 10.128.6.128/255.128.7.128 count
    1990 permit any 10.74.0.0/255.255.0.0 10.128.6.128/255.128.7.128 count
    2000 permit any 10.77.96.0/255.255.224.0 10.128.6.128/255.128.7.128 count
    2010 permit any 165.130.0.0/255.255.0.0 10.128.6.128/255.128.7.128 count
    2020 permit any 151.140.0.0/255.255.0.0 10.128.6.128/255.128.7.128 count
    2030 permit udp any 224.0.0.2 eq 1985 count
    2040 permit udp any 224.0.0.18 eq 1985 count
    2050 permit tcp 10.47.3.0/255.255.255.0 group PORTS-WWW-443 10.128.6.128/255.128.7.128 count
    2060 permit udp 10.47.3.0/255.255.255.0 group PORTS-WWW-443 10.128.6.128/255.128.7.128 count
    2070 permit tcp 10.97.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    2080 permit tcp 10.98.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    2090 permit tcp 10.99.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    3010 permit tcp 10.101.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    3020 permit tcp 10.102.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    3030 permit tcp 10.103.0.0/16 10.128.6.128/255.128.7.128 group PORTS-623-664-5986-R16992-16995-plusmore count
    3040 deny any any any count
access-list ip FW-WIRELESS-VLAN-IN-2010JULY10-CSR
    10 permit udp any 10.128.0.40/255.128.7.255 range 8000 61000 count
    20 permit tcp any any established count
    30 permit tcp any 10.128.0.1/255.128.7.255 range 10000 13500 log count
    40 permit tcp any 10.128.0.45/255.128.7.255 range 10000 13500 log count
    50 permit tcp any 165.130.2.3 group PORTS-2003-2378-4001-2878 count
    60 permit tcp any 10.77.97.84 eq 135 count
    70 permit tcp any 10.77.97.84 eq 49500 count
    80 permit tcp any 10.69.97.212 eq 135 count
    90 permit tcp any 10.69.97.212 eq 49500 count
    100 permit tcp any 151.140.12.154 eq 8014 count
    110 permit tcp any 151.140.12.155 eq 8014 count
    120 permit tcp any 151.140.12.156 eq 8014 count
    130 permit tcp any 151.140.12.157 eq 8014 count
    140 permit tcp any 151.140.12.158 eq 8014 count
    150 permit tcp any 151.140.3.90 eq 8014 count
    160 permit tcp any 151.140.3.91 eq 8014 count
    170 permit tcp any 151.140.101.134 eq 8014 count
    180 permit tcp any 151.140.101.135 eq 8014 count
    190 permit udp any any eq 1985 count
    200 permit tcp any 151.140.101.136 eq 8014 count
    210 permit tcp any 151.140.101.137 eq 8014 count
    220 permit tcp any 151.140.101.138 eq 8014 count
    230 permit tcp any 151.140.77.58 eq 8014 count
    240 permit tcp any 151.140.77.59 eq 8014 count
    250 permit tcp any 10.128.0.13/255.128.7.255 eq 2967 count
    260 permit tcp any 10.128.0.14/255.128.7.255 eq 2967 count
    270 permit tcp any 10.128.0.22/255.128.7.255 eq 2967 count
    280 permit tcp 10.128.7.128/255.128.7.192 151.140.0.177 eq 1688 count
    290 permit tcp 10.128.7.128/255.128.7.192 151.140.104.251 eq 1688 count
    300 permit pim any any count
    310 permit tcp any 10.128.0.0/9 eq 1439 count
    320 permit tcp 10.128.7.128/255.128.7.192 10.128.4.251/255.128.7.255 group PORTS-FTPD-FTP-TELNET-WWW-554-1420-1422-1439-5005-5010 count
    330 permit tcp 10.128.7.128/255.128.7.192 10.128.4.251/255.128.7.255 group PORTS-5050-5560-6010-7005-8029-8089-9541-12345-49170 count
    340 permit tcp 10.128.7.128/255.128.7.192 10.128.4.252/255.128.7.255 group PORTS-FTPD-FTP-TELNET-WWW-554-1420-1422-1439-5005-5010 count
    350 permit tcp 10.128.7.128/255.128.7.192 10.128.4.252/255.128.7.255 group PORTS-5050-5560-6010-7005-8029-8089-9541-12345-49170 count
    360 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 group PORTS-5005-6010-554-5010 count
    370 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 group PORTS-5005-6010-554-5010 count
    380 permit tcp any 10.128.0.0/9 eq 139 count
    390 permit tcp any 10.128.0.1/255.128.7.255 group PORTS-TELNET-4004-137-10010-10012-10014 count
    400 permit tcp any 10.128.0.1/255.128.7.255 gt 49151 count
    410 permit tcp any any group PORTS-WWW-111-DNS-13-9100-88-8080-524-445-443 count
    420 permit udp any 10.128.0.1/255.128.7.255 group PORTS-TFTP-111-BOOTPC-4004 count
    430 permit udp any any group PORTS-NTP-SNMP-NETBIOS-NS-DGM-DNS-BOOTPS-389-1311-2000-88 count
    440 permit udp any 207.11.87.6 eq 500 count
    450 permit tcp 10.128.0.0/9 148.163.149.217 eq 10020 count
    460 permit tcp 10.128.0.0/9 148.163.153.207 eq 10020 count
    470 permit udp any 224.0.0.251 eq 5353 count
    480 permit udp any 224.0.1.116 eq 5001 count
    490 permit udp any 224.0.1.35 eq 427 count
    500 permit icmp any any icmp-type echo count
    510 permit icmp any any icmp-type echo-reply count
    520 permit icmp any any icmp-type 3 count
    530 permit esp any any count
    540 permit tcp any 10.128.0.1/255.128.7.255 group PORTS-12000-12020-12030-12060-12070 count
    550 permit tcp any 10.128.0.1/255.128.7.255 group PORTS-12090-12100 count
    560 permit tcp any 10.128.0.45/255.128.7.255 group PORTS-12090-12100 count
    570 permit udp any 165.130.221.135 eq 38293 count
    580 permit tcp any 10.128.0.16/255.128.7.255 eq 4300 count
    590 permit tcp any any group PORTS-2000-4445-5631-8085-81-2187 count
    600 permit tcp any any range 50000 50003 count
    610 permit tcp any 165.130.234.12 eq 2066 count
    620 permit udp any 10.128.0.45/255.128.7.255 eq 69 count
    630 permit tcp any 165.130.218.126 eq 1105 count
    640 permit tcp any 165.130.221.128 eq 7460 count
    650 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    660 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    670 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    680 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    690 permit udp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    700 permit udp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    710 permit tcp any 165.130.218.24 eq 31037 count
    720 permit tcp any 165.130.218.185 eq 31037 count
    730 permit tcp any 165.130.136.111 eq 30010 count
    740 permit tcp any 10.128.0.24/255.128.7.255 group PORTS-137-445-38293-2967-139-4300 count
    750 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    760 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    770 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    780 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    790 permit udp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    800 permit udp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    810 permit udp 10.128.0.0/9 151.140.13.125 group PORTS-WWW-443 count
    820 permit udp 10.128.0.0/9 151.140.84.87 group PORTS-WWW-443 count
    830 permit tcp any 10.128.0.38/255.128.7.255 group PORTS-137-445-38293-2967-139-4300 count
    840 permit tcp any 165.130.0.0/16 group PORTS-49254-49201-1494-135 count
    850 permit tcp any 10.66.0.0/16 group PORTS-49254-49201-1494-135 count
    860 permit tcp any 10.69.96.0/19 group PORTS-49254-49201-1494-135 count
    870 permit tcp any 10.74.0.0/16 group PORTS-49254-49201-1494-135 count
    880 permit tcp any 10.77.96.0/19 group PORTS-49254-49201-1494-135 count
    890 permit tcp any 165.130.0.0/16 eq 926 count
    900 permit tcp any 10.66.0.0/16 eq 926 count
    910 permit tcp any 10.69.96.0/19 eq 926 count
    920 permit tcp any 10.74.0.0/16 eq 926 count
    930 permit tcp any 10.77.96.0/19 eq 926 count
    940 permit tcp any 165.130.136.46/31 eq 8426 count
    950 permit tcp any 165.130.170.0/24 group PORTS-8019-8008 count
    960 permit tcp any 165.130.178.0/24 group PORTS-8019-8012 count
    970 permit tcp any 165.130.204.192/26 group PORTS-1025-139-445-135 count
    980 permit tcp any 165.130.204.192/26 gt 49151 count
    990 permit tcp any 165.130.210.0/24 group PORTS-1025-49252-49253 count
    1000 permit tcp any 165.130.218.0/24 group PORTS-88-8019-49204-445-139-1090-1025-3268 count
    1010 permit tcp any 165.130.218.180/31 group PORTS-88-389-49201-49204-3268 count
    1020 permit tcp any 165.130.221.132/31 group PORTS-2697-2967 count
    1030 permit tcp any any group PORTS-389-22-139-138-137-135-123-161 count
    1040 permit tcp any 151.140.146.68 eq 2682 count
    1050 permit tcp any 165.130.133.17 eq 9026 count
    1060 permit tcp any 165.130.136.111 eq 23 count
    1070 permit tcp any 165.130.136.116 eq 30010 count
    1080 permit tcp any 165.130.136.30 eq 8426 count
    1090 permit tcp any 165.130.136.37 group PORTS-9080-5050 count
    1100 permit tcp any 165.130.136.90 eq 8426 count
    1110 permit tcp any 165.130.162.7 range 8002 8024 count
    1120 permit tcp any 165.130.170.7 range 8002 8024 count
    1130 permit tcp any 165.130.178.7 range 8002 8024 count
    1140 permit tcp any 165.130.162.7 eq 8999 count
    1150 permit tcp any 165.130.170.7 eq 8999 count
    1160 permit tcp any 165.130.178.7 eq 8999 count
    1170 permit tcp any 165.130.208.180 eq 1533 count
    1180 permit tcp any 165.130.210.176/29 gt 49151 count
    1190 permit tcp any 165.130.210.192/29 gt 49151 count
    1200 permit tcp any 165.130.210.206/31 gt 49151 count
    1210 permit tcp any 165.130.210.208/30 gt 49151 count
    1220 permit tcp any 165.130.210.144/30 gt 49151 count
    1230 permit tcp any 165.130.221.127 eq 7460 count
    1240 permit tcp any 165.130.221.135 eq 2967 count
    1250 permit tcp any 165.130.226.12 eq 2066 count
    1260 permit tcp any 207.11.0.205 eq 15871 count
    1270 permit tcp any 207.11.1.249 eq 259 count
    1280 permit tcp any 208.250.99.14 group PORTS-9912-9902 count
    1290 permit tcp any 208.250.99.16 eq 9912 count
    1300 permit udp any 165.130.221.133 eq 38293 count
    1310 permit udp any 165.130.250.70 eq 38293 count
    1320 permit udp any 224.0.1.22 eq 427 count
    1330 permit tcp any 151.140.100.21 group PORTS-8126-8426-51600 count
    1340 permit tcp any 151.140.100.22 group PORTS-8126-8426-51600 count
    1350 permit tcp any 151.140.100.23 group PORTS-8126-8426-51600 count
    1360 permit tcp any 151.140.100.24 group PORTS-8126-8426-51600 count
    1370 permit tcp any 151.140.100.25 group PORTS-8126-8426-51600 count
    1380 permit tcp any 151.140.100.26 group PORTS-8126-8426-51600 count
    1390 permit tcp any 151.140.45.48 eq 3040 count
    1400 permit tcp any 151.140.77.34 group PORTS-8126-8426-51600 count
    1410 permit tcp any 151.140.77.35 group PORTS-8126-8426-51600 count
    1420 permit tcp any 151.140.77.36 group PORTS-8126-8426-51600 count
    1430 permit tcp any 151.140.77.37 group PORTS-8126-8426-51600 count
    1440 permit tcp any 151.140.77.38 group PORTS-8126-8426-51600 count
    1450 permit tcp any 151.140.77.39 group PORTS-8126-8426-51600 count
    1460 permit tcp any 65.130.216.20 eq 1025 count
    1470 permit tcp any 64.86.106.113 eq 21 count
    1480 permit tcp any 65.130.218.127 eq 1092 count
    1490 permit tcp any 165.130.218.180/30 gt 1023 count
    1500 permit tcp any 172.28.204.242 eq 1025 count
    1510 permit tcp any 165.130.170.7 eq 8002 count
    1520 permit tcp any 165.130.192.76 gt 1023 count
    1530 permit tcp any 165.130.218.127 gt 1023 count
    1540 permit tcp any 165.130.143.106 gt 1023 count
    1550 permit tcp any 151.140.40.33 eq 4040 count
    1560 permit tcp any 10.128.0.220/255.128.7.254 eq 3045 count
    1570 permit tcp any 10.128.0.222/255.128.7.255 eq 3045 count
    1580 permit udp any 255.255.255.255 eq 4098 count
    1590 permit tcp any 165.130.242.12 gt 1023 count
    1600 permit udp any 239.255.255.253 group PORTS-427-1900 count
    1610 permit udp any 239.255.255.250 eq 1900 count
    1620 permit tcp any 172.20.30.102 eq 8050 count
    1630 permit tcp any 172.20.30.104 eq 8050 count
    1640 permit tcp any 172.20.30.106 eq 8050 count
    1650 permit udp any 192.168.1.103 eq 427 count
    1660 permit tcp any 192.168.1.103 group PORTS-9220-16398 count
    1670 permit tcp any 165.130.198.196/31 group PORTS-2967-38293 count
    1680 permit udp any 165.130.198.196/31 group PORTS-2967-38293 count
    1690 permit tcp any 165.130.226.76 eq 50100 count
    1700 permit tcp any 165.130.234.76 eq 50100 count
    1710 permit tcp any 165.130.242.76 eq 50100 count
    1720 permit tcp any 192.168.1.98 eq 4300 count
    1730 permit tcp any 165.130.218.126 range 1095 1096 count
    1740 permit tcp any 165.130.209.0/24 eq 3268 count
    1750 permit tcp any 165.130.218.179 group PORTS-1093-1067-1064 count
    1760 permit tcp any 165.130.218.180/31 group PORTS-1093-1067-1064 count
    1770 permit tcp any 165.130.193.180/31 eq 58100 count
    1780 permit tcp any 10.128.0.45/255.128.7.255 eq 23 count
    1790 permit tcp any 165.130.133.0/24 group PORTS-TELNET-30010 count
    1800 permit tcp any 165.130.132.0/24 group PORTS-TELNET-30010 count
    1810 permit tcp any 165.130.210.197 group PORTS-1533-1503-8081-554 count
    1820 permit tcp any 165.130.198.192 group PORTS-1533-1503-8081-554 count
    1830 permit tcp any 10.128.0.1/255.128.7.255 eq 13030 count
    1840 permit tcp any 165.130.192.60 group PORTS-1533-1503-8081-554 count
    1850 permit tcp any 10.128.0.45/255.128.7.255 eq 13030 count
    1860 permit tcp any 165.130.128.0/17 eq 4104 count
    1870 permit tcp any 10.128.0.45/255.128.7.255 eq 13082 count
    1880 permit tcp any 10.128.0.1/255.128.7.255 eq 13082 count
    1890 permit tcp any 10.66.0.0/16 eq 4101 count
    1900 permit tcp any 10.69.96.0/19 eq 4101 count
    1910 permit tcp any 10.74.0.0/16 eq 4101 count
    1920 permit tcp any 10.77.96.0/19 eq 4101 count
    1930 permit tcp any 165.130.186.57 eq 18000 count
    1940 permit tcp any 10.128.6.0/255.128.7.128 range 1719 1720 count
    1950 permit udp any 10.128.6.0/255.128.7.128 range 1719 1720 count
    1960 permit udp any 10.128.6.0/255.128.7.128 range 16384 32767 count
    1970 permit udp any 10.128.6.0/255.128.7.0 eq 69 count
    1980 permit tcp any 10.128.0.42/255.128.7.255 eq 25001 count
    1990 permit tcp any 10.128.0.1/255.128.7.255 range 32500 33000 count
    2000 permit tcp any 165.130.198.210 group PORTS-5060-5061-5063-443 count
    2010 permit tcp any 165.130.198.210 range 6891 6901 count
    2020 permit tcp any 10.128.0.1/255.128.7.255 eq 12110 count
    2030 permit tcp any 10.128.0.45/255.128.7.255 eq 12110 count
    2040 permit tcp any 10.128.0.45/255.128.7.255 group PORTS-12020-12030-12060-12070-FTP count
    2050 permit tcp any 10.128.0.1/255.128.7.255 eq 12001 count
    2060 permit tcp any 10.128.0.45/255.128.7.255 eq 12001 count
    2070 permit tcp any 165.130.174.208 eq 9448 count
    2080 permit tcp any 165.130.166.208 eq 9448 count
    2090 permit any any 165.130.64.0/24 count
    2100 permit any any 165.130.72.0/24 count
    2110 permit tcp any 165.130.0.0/16 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2120 permit tcp any 10.66.0.0/16 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2130 permit tcp any 10.69.96.0/19 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2140 permit tcp any 10.74.0.0/16 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2150 permit tcp any 10.77.96.0/19 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2160 permit tcp any 172.28.183.0/24 group PORTS-8106-8006-8406-8126-8026-8426-51600 count
    2170 permit tcp any 165.130.166.176 eq 11011 count
    2180 permit tcp any 165.130.230.150 eq 11011 count
    2190 permit tcp any 165.130.238.150 eq 11011 count
    2200 permit tcp any 165.130.174.176 eq 11011 count
    2210 permit tcp any 165.130.222.151 eq 11011 count
    2220 permit tcp any 165.130.166.239 eq 11011 count
    2230 permit tcp 10.128.0.0/255.128.0.0 any range 2701 2702 count
    2240 permit tcp any 65.23.153.4 eq 8086 count
    2250 permit tcp any 165.130.148.84 eq 5050 count
    2260 permit tcp 10.128.5.6/255.128.7.255 151.140.143.10 eq 21 count
    2270 permit udp any 10.128.6.0/255.128.7.255 range 2000 3000 count
    2280 permit tcp any 10.128.0.24/255.128.7.255 eq 2967 count
    2290 permit tcp any 10.128.0.38/255.128.7.255 eq 2967 count
    2300 permit udp any any eq 162 count
    2310 permit tcp any 165.130.186.159 eq 8014 count
    2320 permit tcp any 165.130.186.160/30 eq 8014 count
    2330 permit tcp any 165.130.186.164/31 eq 8014 count
    2340 permit tcp any 165.130.218.196 eq 8014 count
    2350 permit tcp any 165.130.218.50 eq 8014 count
    2360 permit tcp any 165.130.218.109 eq 8014 count
    2370 permit tcp any 165.130.218.184 eq 8014 count
    2380 permit tcp any 165.130.218.191 eq 8014 count
    2390 permit tcp any 165.130.218.192/31 eq 8014 count
    2400 permit udp any 10.121.130.176/30 range 16384 32767 count
    2410 permit udp any 10.122.130.176/30 range 16384 32767 count
    2420 permit tcp any 10.212.213.0/24 eq 23 count
    2430 permit udp any 10.121.130.178 eq 69 count
    2440 permit any any 239.192.2.0/24 count
    2450 permit udp any 239.129.1.0/24 count
    2460 permit igmp any any count
    2470 permit udp any 10.128.4.0/255.128.7.0 range 16384 32767 count
    2480 permit udp any 10.128.7.64/255.128.7.192 range 16384 32767 count
    2490 permit udp any 10.128.7.0/255.128.7.192 range 16384 32767 count
    2500 permit udp any any eq 53 count
    2510 permit udp any any eq 161 count
    2520 permit udp any range 600 1130 10.128.0.45/255.128.7.255 count
    2530 permit udp any eq 161 any count
    2540 permit udp any group PORTS-1077-1496-1662-20000-53-137-123-514-69-5632 any count
    2550 permit udp any gt 1023 165.130.204.192/26 count
    2560 permit udp any gt 1023 165.130.210.212/31 count
    2570 permit udp any gt 1023 165.130.210.208/30 count
    2580 permit udp any gt 1023 165.130.210.192/29 count
    2590 permit udp any gt 1023 165.130.210.144/30 count
    2600 permit udp any range 628 914 10.128.0.46/255.128.7.255 count
    2610 permit udp any range 20002 20020 10.128.0.1/255.128.7.255 count
    2620 permit udp any range 1026 2758 10.128.0.1/255.128.7.255 count
    2630 permit udp any eq 68 10.128.0.0/255.128.7.0 count
    2640 permit udp any eq 1288 10.128.0.0/255.128.7.0 count
    2650 permit udp 10.128.0.0/9 eq 161 151.140.45.138 count
    2660 permit udp any eq 67 10.128.0.45/255.128.7.255 eq 67 count
    2670 permit udp any eq 2967 165.130.198.196 count
    2680 permit udp any range 16384 32767 10.121.130.176/30 eq 2000 count
    2690 permit udp any range 16384 32767 10.122.130.176/30 eq 2000 count
    2700 permit udp any range 16384 32767 10.121.130.176/30 range 16384 32767 count
    2710 permit udp any range 16384 32767 10.122.130.176/30 range 16384 32767 count
    2720 permit any any 165.130.216.41 count
    2730 permit any any 165.130.216.42/31 count
    2740 permit any any 165.130.216.44/31 count
    2750 permit udp 10.128.0.0/9 eq 3389 151.140.102.102 count
    2760 permit udp 10.128.0.0/9 eq 3389 151.140.50.191 count
    2770 permit any any 165.130.216.46 count
    2780 permit udp any eq 3181 any count
    2790 permit any 239.192.2.0/255.255.255.0 any count
    2800 permit udp 239.129.1.0/255.255.255.0 any count
    2810 permit any 10.128.7.128/255.128.7.192 CYBERARK_PSM_RDP count
    2820 permit udp any 10.23.20.0/24 group PORTS-TFTP-2000-6969 count
    2830 permit udp any 10.33.20.0/24 group PORTS-TFTP-2000-6969 count
    2840 permit tcp any 10.23.20.0/24 eq 2000 count
    2850 permit tcp any 10.33.20.0/24 eq 2000 count
    2860 permit udp any 10.23.20.0/24 range 5060 5100 count
    2870 permit tcp any 10.23.20.0/24 range 5060 5100 count
    2880 permit udp any 10.33.20.0/24 range 5060 5100 count
    2890 permit tcp any 10.33.20.0/24 range 5060 5100 count
    2900 permit udp any 10.23.20.0/24 range 16384 61000 count
    2910 permit udp any 10.33.20.0/24 range 16384 61000 count
    2920 permit udp any range 16384 61000 10.23.20.0/24 count
    2930 permit udp any range 16384 61000 10.33.20.0/24 count
    2940 permit any any 52.252.217.217 count
    2950 permit any any 65.52.201.235 count
    2960 permit any any 157.55.166.155 count
    2970 permit any any 52.150.51.239 count
    2980 permit any any 54.215.171.160 count
    2990 permit any any 52.162.39.48 count
    3000 permit tcp any ZEBRASIGNALCTRL group PORTS-ZEBRASIGNALCTRL_TCP count
    3010 permit udp any ZEBRASIGNALCTRL group PORTS-ZEBRASIGNALCTRL_UDP count
    3020 permit tcp any ZEBRACONNECTSSL group PORTS-ZEBRA_SSL_TCP count
    3030 permit tcp any ZEBRAMQTT group PORTS-ZEBRA_SSL_TCP count
    3040 permit tcp any 10.128.0.170/255.128.7.255 eq 5672 count
    3050 deny any any any log count
access-list ip FW-WIRELESS-VLAN-OUT_17-7-CSR
    10 permit udp 10.128.0.40/255.128.7.255 any range 8000 61000 count
    20 permit tcp any any established count
    30 permit tcp 10.128.0.45/255.128.7.255 10.128.5.7/255.128.7.255 eq 8111 count
    31 permit tcp 10.128.0.45/255.128.7.255 10.128.7.7/255.128.7.255 eq 8111 count
    32 permit tcp 10.128.0.45/255.128.7.255 10.128.7.6/255.128.7.255 eq 8111 count
    40 permit tcp 10.128.0.45/255.128.7.255 any eq 3003 count
    60 permit tcp any any eq 9100 count
    70 permit tcp 10.128.0.0/255.128.7.0 any range 601 1029 count
    80 permit tcp any group PORTS-139-9100-WWW-8080 any count
    90 permit udp any eq 53 any count
    100 permit udp any eq 161 any count
    110 permit udp 10.128.0.45/255.128.7.255 any range 600 1130 count
    120 permit icmp any any icmp-type 3 count
    130 permit icmp any any icmp-type echo-reply count
    140 permit icmp any any icmp-type echo count
    150 permit esp any any count
    160 permit tcp 10.128.0.1/255.128.7.255 eq 4004 any count
    170 permit tcp any any group PORTS-2000-4445-5631-8085-81-2187 count
    180 permit tcp any any eq 27401 count
    190 permit tcp any any eq 88 count
    200 permit tcp any any range 50000 50003 count
    210 permit udp any any eq 161 count
    220 permit tcp 165.130.218.181 any group PORTS-139-445 count
    230 permit tcp 165.130.218.181 any eq 1344 count
    240 permit tcp any any group PORTS-1034-1050-1303-1321-22-443-80-5631 count
    250 permit tcp 165.130.221.132/30 any eq 2967 count
    260 permit tcp 165.130.221.132/30 any eq 1097 count
    270 permit tcp 10.128.0.41/255.128.7.255 any eq 1034 count
    280 permit tcp 10.128.0.41/255.128.7.255 any eq 1038 count
    290 permit tcp 10.128.0.24/255.128.7.255 any count
    300 permit tcp 10.128.0.38/255.128.7.255 any count
    310 permit udp any any group PORTS-1077-1496-1662-20000-53-137-123-514-69-5632 count
    320 permit udp 165.130.204.192/26 any gt 1023 count
    330 permit udp 165.130.210.212/31 any gt 1023 count
    340 permit udp 165.130.210.208/30 any gt 1023 count
    350 permit udp 165.130.210.192/29 any gt 1023 count
    360 permit udp 165.130.210.144/30 any gt 1023 count
    370 permit udp 10.128.0.46/255.128.7.255 any range 628 914 count
    380 permit udp 10.128.0.1/255.128.7.255 any range 20002 20020 count
    390 permit udp 10.128.0.1/255.128.7.255 any range 1026 2758 count
    400 permit udp 10.128.0.0/255.128.7.0 any eq 68 count
    410 permit udp 10.128.0.0/255.128.7.0 any eq 1288 count
    420 permit udp 151.140.45.138 10.128.0.0/9 eq 161 count
    430 permit tcp 151.140.45.138 any eq 21 count
    440 permit tcp 10.128.0.45/255.128.7.255 any eq 21 count
    450 permit tcp 165.130.218.153 eq 50003 any count
    460 permit tcp 165.130.218.184/31 eq 50003 any count
    470 permit tcp 165.130.218.176/29 eq 445 any count
    480 permit tcp 207.11.0.205 any count
    490 permit tcp 172.16.144.25 any eq 445 count
    500 permit tcp 165.130.218.127 any eq 445 count
    510 permit tcp 165.130.136.47 eq 8426 any count
    520 permit tcp 165.130.218.126 eq 445 any count
    530 permit tcp 208.250.99.14 eq 9912 any count
    540 permit udp 10.128.0.45/255.128.7.255 eq 67 any eq 67 count
    550 permit tcp 165.130.198.196 any eq 2967 count
    560 permit udp 165.130.198.196 any eq 2967 count
    570 permit tcp 165.130.221.135 any eq 1065 count
    580 permit tcp 165.130.202.59 any eq 1065 count
    590 permit tcp 165.130.169.222 any eq 139 count
    600 permit tcp 165.130.169.169 any eq 139 count
    610 permit tcp 165.130.169.108 any eq 139 count
    620 permit tcp 165.130.169.184 any eq 139 count
    630 permit tcp 165.130.128.91 any eq 139 count
    640 permit tcp 165.130.128.91 any eq 445 count
    650 permit tcp 10.128.6.0/255.128.7.128 range 1719 1720 any count
    660 permit udp 10.121.130.176/30 eq 2000 any range 16384 32767 count
    670 permit udp 10.122.130.176/30 eq 2000 any range 16384 32767 count
    680 permit udp 10.121.130.176/30 range 16384 32767 any range 16384 32767 count
    690 permit udp 10.122.130.176/30 range 16384 32767 any range 16384 32767 count
    700 permit udp 10.128.6.0/255.128.7.128 range 1719 1720 any count
    710 permit udp 10.128.6.0/255.128.7.128 range 16384 32767 any count
    720 permit udp 10.128.6.0/255.128.7.128 range 2000 3000 any count
    730 permit tcp any any eq 7777 count
    740 permit tcp 10.128.0.1/255.128.7.255 any group PORTS-6100-6101-9100 count
    750 permit tcp 10.128.0.45/255.128.7.255 any group PORTS-6100-6101-9100 count
    760 permit any 165.130.216.41 any count
    770 permit any 165.130.216.42/31 any count
    780 permit any 165.130.216.44/31 any count
    790 permit any 165.130.64.0/24 any count
    800 permit tcp any any eq 8086 count
    810 permit tcp any any eq 3181 count
    820 permit tcp any any eq 3389 count
    830 permit tcp 151.140.102.102 10.128.0.0/9 eq 5986 count
    840 permit tcp 151.140.50.191 10.128.0.0/9 eq 5986 count
    850 permit udp 151.140.102.102 10.128.0.0/9 eq 3389 count
    860 permit udp 151.140.50.191 10.128.0.0/9 eq 3389 count
    870 permit any 165.130.72.0/24 any count
    880 permit any 165.130.216.46 any count
    890 permit tcp any any eq 8086 count
    900 permit tcp any any eq 3181 count
    910 permit udp any any eq 3181 count
    920 permit tcp 151.140.143.10 10.128.5.6/255.128.7.255 eq 21 count
    930 permit tcp 10.128.0.45/255.129.7.255 10.128.5.6/255.128.7.255 eq 8111 count
    940 permit tcp any 10.128.0.0/9 range 2701 2702 count
    950 permit tcp 151.140.100.21 group PORTS-8126-8426-51600 any count
    960 permit tcp 151.140.100.22 group PORTS-8126-8426-51600 any count
    970 permit tcp 151.140.100.23 group PORTS-8126-8426-51600 any count
    980 permit tcp 151.140.100.24 group PORTS-8126-8426-51600 any count
    990 permit tcp 151.140.100.25 group PORTS-8126-8426-51600 any count
    1000 permit tcp 151.140.100.26 group PORTS-8126-8426-51600 any count
    1010 permit tcp 151.140.77.34 group PORTS-8126-8426-51600 any count
    1020 permit tcp 151.140.77.35 group PORTS-8126-8426-51600 any count
    1030 permit tcp 151.140.77.36 group PORTS-8126-8426-51600 any count
    1040 permit tcp 151.140.77.37 group PORTS-8126-8426-51600 any count
    1050 permit tcp 151.140.77.38 group PORTS-8126-8426-51600 any count
    1060 permit tcp 151.140.77.39 group PORTS-8126-8426-51600 any count
    1070 permit pim any any count
    1080 permit udp 10.128.4.0/255.128.7.0 range 16384 32767 any count
    1090 permit udp 10.128.7.64/255.128.7.192 range 16384 32767 any count
    1100 permit any any 239.192.2.0/24 count
    1110 permit udp any 239.129.1.0/24 count
    1120 permit igmp any any count
    1130 permit tcp 172.19.136.0/26 any eq 7775 count
    1140 permit tcp 172.19.144.0/26 any eq 7775 count
    1150 permit tcp 172.19.152.0/26 any eq 7775 count
    1160 permit tcp 172.19.224.0/26 any eq 7775 count
    1170 permit tcp 172.19.174.0/24 any eq 7775 count
    1180 permit tcp 172.19.190.0/24 any eq 7775 count
    1190 permit tcp 172.19.206.0/24 any eq 7775 count
    1200 permit tcp 172.19.222.0/24 any eq 7775 count
    1210 permit tcp 172.19.175.64/26 any eq 7775 count
    1220 permit tcp 172.19.191.64/26 any eq 7775 count
    1230 permit tcp 172.19.207.64/26 any eq 7775 count
    1240 permit tcp 172.19.223.64/26 any eq 7775 count
    1250 permit udp 10.128.7.0/255.128.7.192 range 16384 32767 any count
    1260 permit any CYBERARK_PSM_RDP 10.128.7.128/255.128.7.192 count
    1270 permit udp any eq 1985 any count
    1280 permit udp 10.128.0.1/255.128.7.255 group PORTS-TFTP-111-BOOTPC-4004 any count
    1290 permit udp any group PORTS-NTP-SNMP-NETBIOS-NS-DGM-DNS-BOOTPS-389-1311-2000-88 any count
    1300 permit udp 207.11.87.6 eq 500 any count
    1310 permit udp 224.0.0.251 eq 5353 any count
    1320 permit udp 224.0.1.116 eq 5001 any count
    1330 permit udp 224.0.1.35 eq 427 any count
    1340 permit udp 165.130.221.135 eq 38293 any count
    1350 permit udp 10.128.0.45/255.128.7.255 eq 69 any count
    1360 permit udp 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.0.0/9 count
    1370 permit udp 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.0.0/9 count
    1380 permit udp 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.0.0/9 count
    1390 permit udp 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.0.0/9 count
    1400 permit udp 151.140.13.125 group PORTS-WWW-443 10.128.0.0/9 count
    1410 permit udp 151.140.84.87 group PORTS-WWW-443 10.128.0.0/9 count
    1420 permit udp 165.130.221.133 eq 38293 any count
    1430 permit udp 165.130.250.70 eq 38293 any count
    1440 permit udp 239.255.255.250 eq 1900 any count
    1450 permit udp 192.168.1.103 eq 427 any count
    1460 permit udp 165.130.198.196/31 group PORTS-2967-38293 any count
    1470 permit udp 10.128.6.0/255.128.7.0 eq 69 any count
    1480 permit udp any eq 162 any count
    1490 permit udp 10.121.130.176/31 range 16384 32767 any count
    1500 permit udp 10.122.130.176/31 range 16384 32767 any count
    1510 permit udp 10.121.130.178 eq 69 any count
    1520 permit udp 10.122.130.178 eq 69 any count
    1530 permit any 239.192.2.0/24 any count
    1540 permit udp 239.129.1.0/24 any count
    1550 permit udp any 224.0.0.2 eq 1985 count
    1560 permit tcp any 165.130.2.3 eq 2003 count
    1570 permit udp 10.121.140.154 eq 69 any count
    1580 permit udp 10.122.140.154 eq 69 any count
    1590 permit udp 10.23.20.0/24 eq 2000 any count
    1600 permit tcp 10.33.20.0/24 eq 2000 any count
    1610 permit udp 10.23.20.0/24 range 5060 5100 any count
    1620 permit tcp 10.23.20.0/24 range 5060 5100 any count
    1630 permit udp 10.33.20.0/24 range 5060 5100 any count
    1633 permit any 52.252.217.217/255.255.255.255 any
    1636 permit any 65.52.201.235/255.255.255.255 any 
    1640 permit tcp 10.33.20.0/24 range 5060 5100 any count
    1650 permit udp 10.23.20.0/24 any range 16384 61000 count
    1660 permit udp 10.23.20.0/24 range 16384 61000 any count
    1670 permit udp 10.33.20.0/24 any range 16384 61000 count
    1680 permit udp 10.33.20.0/24 range 16384 61000 any count
    1690 permit udp 224.0.1.22 eq 427 any count
    1700 permit udp 255.255.255.255 eq 4098 any count
    1710 permit udp 239.255.255.253 group PORTS-427-1900 any count
    1720 permit any 52.252.217.217 any count
    1730 permit any 65.52.201.235 any count
    1740 permit any 157.55.166.155 any count
    1750 permit any 52.150.51.239 any count
    1760 permit any 54.215.171.160 any count
    1770 permit any 52.162.39.48 any count
    1790 permit udp any 224.0.0.18 eq 1985 count
    1800 permit tcp ZEBRASIGNALCTRL group PORTS-ZEBRASIGNALCTRL_TCP any count
    1810 permit udp ZEBRASIGNALCTRL group PORTS-ZEBRASIGNALCTRL_UDP any count
    1820 permit tcp ZEBRACONNECTSSL group PORTS-ZEBRA_SSL_TCP any count
    1830 permit tcp ZEBRAMQTT group PORTS-ZEBRA_SSL_TCP any count
    1840 permit tcp 10.97.0.0/16 any eq 7775 count
    1850 permit tcp 10.98.0.0/16 any eq 7775 count
    1860 permit tcp 10.99.0.0/16 any eq 7775 count
    1880 permit tcp 10.101.0.0/16 any eq 7775 count
    1890 permit tcp 10.102.0.0/16 any eq 7775 count
    1900 permit tcp 10.103.0.0/16 any eq 7775 count
    1910 permit tcp 10.128.0.160/255.128.7.255 any eq 3003 count
    1920 permit tcp 10.128.0.161/255.128.7.255 any eq 3003 count
    1930 permit tcp 10.128.0.162/255.128.7.255 any eq 3003 count
    1940 deny any any any count
access-list ip FW-VLAN44-IN-CSR
    10 permit tcp any any established count
    20 deny ip any 10.128.6.0/255.128.7.0 count
    30 deny ip any 10.128.0.52/255.128.7.254 count
    40 deny ip any 10.128.7.0/255.128.7.0 count
    50 permit udp any any group PORTS-NTP-DNS count
    55 permit tcp any 10.128.0.160/255.128.7.252 eq 80 count
    56 permit tcp any 10.128.0.160/255.128.7.252 eq 443 count
    60 permit udp any any eq 67 count
    70 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE1 eq 443 count
    80 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE2 eq 443 count
    90 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE3 eq 443 count
    95 permit tcp 10.128.4.128/255.128.7.128 GOOGLE-NETS eq 443 count
    100 permit any 10.128.4.253/255.128.7.255 224.0.0.2 count
    110 permit any 10.128.4.254/255.128.7.255 224.0.0.2 count
    120 permit tcp 10.128.4.128/255.128.7.128 10.128.0.1/255.128.7.255 group PORTS-DNS-DAYTIME count
    130 permit tcp 10.128.4.128/255.128.7.128 10.128.0.41/255.128.7.255 group PORTS-DNS-DAYTIME count
    140 permit tcp 10.128.4.128/255.128.7.128 10.128.0.45/255.128.7.255 group PORTS-DNS-DAYTIME count
    150 permit tcp 10.128.4.128/255.128.7.128 69.64.165.18 group PORTS-FTP-2010-5000 count
    160 permit tcp 10.128.4.128/255.128.7.128 69.64.165.10 group PORTS-FTP-2010-5000 count
    170 permit udp 10.128.4.128/255.128.7.128 69.64.165.18 eq 69 count
    180 permit udp 10.128.4.128/255.128.7.128 69.64.165.10 eq 69 count
    182 permit tcp 10.128.4.128/255.128.7.128 40.91.93.112 eq 22 count
    183 permit tcp 10.128.4.128/255.128.7.128 40.91.93.112 eq 443 count
    184 permit tcp 10.128.4.128/255.128.7.128 40.91.95.34 eq 22 count
    185 permit tcp 10.128.4.128/255.128.7.128 40.91.95.34 eq 443 count
    190 permit any 10.128.4.128/255.128.7.128 165.130.0.0/16 count
    200 permit any 10.128.4.128/255.128.7.128 151.140.0.0/16 count
    210 permit any 10.128.4.128/255.128.7.128 207.11.0.0/17 count
    220 permit any 10.128.4.128/255.128.7.128 172.16.0.0/12 count
    230 permit tcp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-MSRPC-445-WWW count
    240 permit udp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-BOOTPC-BOOTPS-TFTP-135-4011 count
    250 permit tcp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    260 permit tcp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    270 permit tcp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    280 permit tcp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    290 permit tcp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    300 permit tcp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    310 permit tcp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    320 permit tcp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    330 permit udp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    340 permit udp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    350 permit udp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    360 permit udp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    370 permit tcp 10.128.4.128/255.128.7.128 10.128.0.13/255.128.7.255 eq 2967 count
    380 permit tcp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 eq 2967 count
    390 permit any 10.128.4.128/255.128.7.128 10.66.0.0/16 count
    400 permit any 10.128.4.128/255.128.7.128 10.69.96.0/19 count
    410 permit any 10.128.4.128/255.128.7.128 10.74.0.0/16 count
    420 permit any 10.128.4.128/255.128.7.128 10.77.96.0/19 count
    430 permit icmp any any icmp-type echo-reply count
    440 permit udp any eq 161 10.128.0.0/9 count
    450 permit udp any eq 68 10.128.0.0/9 count
    460 permit any 10.128.4.252/255.128.7.255 10.128.0.0/9 count
    470 permit any 10.128.4.251/255.128.7.255 10.128.0.0/9 count
    480 permit any 10.128.4.128/255.128.7.128 CYBERARK_PSM_RDP count
    490 permit udp any 224.0.0.2 eq 1985 count
    500 permit udp any 224.0.0.18 eq 1985 count
    510 permit ip 10.128.4.128/255.128.7.128 10.97.0.0/16 count
    520 permit ip 10.128.4.128/255.128.7.128 10.98.0.0/16 count
    530 permit ip 10.128.4.128/255.128.7.128 10.99.0.0/16 count
    550 permit ip 10.128.4.128/255.128.7.128 10.101.0.0/16 count
    560 permit ip 10.128.4.128/255.128.7.128 10.102.0.0/16 count
    570 permit ip 10.128.4.128/255.128.7.128 10.103.0.0/16 count
    %if is_ffirstacl=Y%
    580 permit tcp 10.128.4.253/255.128.7.255 10.72.227.245 eq https count
    590 permit tcp 10.128.4.253/255.128.7.255 10.72.227.245 eq 5000 count
    600 permit tcp 10.128.4.253/255.128.7.255 O365_SERVER eq smtp count
	%endif%
    610 deny any any any count    
access-list ip FW-VLAN44-IN-CSR-POC
    10 permit tcp any any established count
    20 deny ip any 10.128.6.0/255.128.7.0 count
    30 deny ip any 10.128.0.52/255.128.7.254 count
    40 deny ip any 10.128.7.0/255.128.7.0 count
    50 permit udp any any group PORTS-NTP-DNS count
    55 permit tcp any 10.128.0.160/255.128.7.252 eq 80 count
    56 permit tcp any 10.128.0.160/255.128.7.252 eq 443 count
    60 permit udp any any eq 67 count
    70 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE1 eq 443 count
    80 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE2 eq 443 count
    90 permit tcp 10.128.4.128/255.128.7.128 CROWDSTRIKE3 eq 443 count
    %if is_gcpnetacl=Y%
    95 permit tcp 10.128.4.128/255.128.7.128 GOOGLE-NETS eq 443 count
    %endif%
    100 permit any 10.128.4.253/255.128.7.255 224.0.0.2 count
    110 permit any 10.128.4.254/255.128.7.255 224.0.0.2 count
    120 permit tcp 10.128.4.128/255.128.7.128 10.128.0.1/255.128.7.255 group PORTS-DNS-DAYTIME count
    130 permit tcp 10.128.4.128/255.128.7.128 10.128.0.41/255.128.7.255 group PORTS-DNS-DAYTIME count
    140 permit tcp 10.128.4.128/255.128.7.128 10.128.0.45/255.128.7.255 group PORTS-DNS-DAYTIME count
    150 permit tcp 10.128.4.128/255.128.7.128 69.64.165.18 group PORTS-FTP-2010-5000 count
    160 permit tcp 10.128.4.128/255.128.7.128 69.64.165.10 group PORTS-FTP-2010-5000 count
    170 permit udp 10.128.4.128/255.128.7.128 69.64.165.18 eq 69 count
    180 permit udp 10.128.4.128/255.128.7.128 69.64.165.10 eq 69 count
    182 permit tcp 10.128.4.128/255.128.7.128 40.91.93.112 eq 22 count
    183 permit tcp 10.128.4.128/255.128.7.128 40.91.93.112 eq 443 count
    184 permit tcp 10.128.4.128/255.128.7.128 40.91.95.34 eq 22 count
    185 permit tcp 10.128.4.128/255.128.7.128 40.91.95.34 eq 443 count
    190 permit any 10.128.4.128/255.128.7.128 165.130.0.0/16 count
    200 permit any 10.128.4.128/255.128.7.128 151.140.0.0/16 count
    210 permit any 10.128.4.128/255.128.7.128 207.11.0.0/17 count
    220 permit any 10.128.4.128/255.128.7.128 172.16.0.0/12 count
    230 permit tcp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-MSRPC-445-WWW count
    240 permit udp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 group PORTS-BOOTPC-BOOTPS-TFTP-135-4011 count
    250 permit tcp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    260 permit tcp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    270 permit tcp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    280 permit tcp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-88-MSRPC-139-389-445-464-636 count
    290 permit tcp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    300 permit tcp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    310 permit tcp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    320 permit tcp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    330 permit udp 10.128.4.128/255.128.7.128 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    340 permit udp 10.128.4.128/255.128.7.128 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    350 permit udp 10.128.4.128/255.128.7.128 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    360 permit udp 10.128.4.128/255.128.7.128 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 count
    370 permit tcp 10.128.4.128/255.128.7.128 10.128.0.13/255.128.7.255 eq 2967 count
    380 permit tcp 10.128.4.128/255.128.7.128 10.128.0.14/255.128.7.255 eq 2967 count
    390 permit any 10.128.4.128/255.128.7.128 10.66.0.0/16 count
    400 permit any 10.128.4.128/255.128.7.128 10.69.96.0/19 count
    410 permit any 10.128.4.128/255.128.7.128 10.74.0.0/16 count
    420 permit any 10.128.4.128/255.128.7.128 10.77.96.0/19 count
    430 permit icmp any any icmp-type echo-reply count
    440 permit udp any eq 161 10.128.0.0/9 count
    450 permit udp any eq 68 10.128.0.0/9 count
    460 permit any 10.128.4.252/255.128.7.255 10.128.0.0/9 count
    470 permit any 10.128.4.251/255.128.7.255 10.128.0.0/9 count
    480 permit any 10.128.4.128/255.128.7.128 CYBERARK_PSM_RDP count
    490 permit udp any 224.0.0.2 eq 1985 count
    500 permit udp any 224.0.0.18 eq 1985 count
    505 permit tcp 10.128.4.248/255.128.7.254 52.183.3.149 eq 443 count
    506 permit tcp 10.128.4.248/255.128.7.254 34.117.17.249 eq 443 count
    507 permit tcp 10.128.4.248/255.128.7.254 74.125.21.95 eq 443 count
    508 permit tcp 10.128.4.248/255.128.7.254 142.250.105.95 eq 443 count
    509 permit tcp 10.128.4.248/255.128.7.254 64.233.177.95 eq 443 count
    510 permit tcp 10.128.4.248/255.128.7.254 142.251.15.95 eq 443 count
    511 permit tcp 10.128.4.248/255.128.7.254 74.125.136.95 eq 443 count
    512 permit tcp 10.128.4.248/255.128.7.254 74.125.138.95 eq 443 count
    513 permit tcp 10.128.4.248/255.128.7.254 64.233.185.95 eq 443 count
    514 permit tcp 10.128.4.248/255.128.7.254 172.217.165.42 eq 443 count
    515 permit tcp 10.128.4.248/255.128.7.254 142.250.176.74 eq 443 count
    516 permit tcp 10.128.4.248/255.128.7.254 108.177.122.95 eq 443 count
    517 permit tcp 10.128.4.248/255.128.7.254 172.253.124.95 eq 443 count
    518 permit tcp 10.128.4.249/255.128.7.255 10.128.0.170/255.128.7.255 eq 443 count
    520 permit ip 10.128.4.128/255.128.7.128 10.97.0.0/16 count
    530 permit ip 10.128.4.128/255.128.7.128 10.98.0.0/16 count
    540 permit ip 10.128.4.128/255.128.7.128 10.99.0.0/16 count
    560 permit ip 10.128.4.128/255.128.7.128 10.101.0.0/16 count
    570 permit ip 10.128.4.128/255.128.7.128 10.102.0.0/16 count
    580 permit ip 10.128.4.128/255.128.7.128 10.103.0.0/16 count
    %if is_ffirstacl=Y%
    590 permit tcp 10.128.4.253/255.128.7.255 10.72.227.245 eq https count
    600 permit tcp 10.128.4.253/255.128.7.255 10.72.227.245 eq 5000 count
    610 permit tcp 10.128.4.253/255.128.7.255 O365_SERVER eq smtp count
	%endif%
    620 deny any any any count 
access-list ip FW-VLAN44-OUT_17-7-CSR
    10 permit tcp any any established count
    20 permit icmp any any icmp-type echo count
    30 permit udp 10.128.0.0/9 any eq 161 count
    40 permit udp 10.128.0.0/9 any eq 68 count
    50 permit any 165.130.0.0/16 10.128.4.128/255.128.7.128 count
    55 permit tcp 10.128.0.160/255.128.7.252 any eq 80 count
    56 permit tcp 10.128.0.160/255.128.7.252 any eq 443 count 
    60 permit any 151.140.0.0/16 10.128.4.128/255.128.7.128 count
    70 permit any 207.11.0.0/17 10.128.4.128/255.128.7.128 count
    80 permit any 172.16.0.0/12 10.128.4.128/255.128.7.128 count
    90 permit any 10.128.0.0/9 10.128.4.252/255.128.7.255 count
    100 permit any 10.128.0.0/9 10.128.4.251/255.128.7.255 count
    110 permit any 10.66.0.0/16 10.128.4.128/255.128.7.128 count
    120 permit any 10.69.96.0/19 10.128.4.128/255.128.7.128 count
    130 permit any 10.74.0.0/16 10.128.4.128/255.128.7.128 count
    140 permit any 10.77.96.0/19 10.128.4.128/255.128.7.128 count
    150 permit any CYBERARK_PSM_RDP 10.128.4.128/255.128.7.128 count
    160 permit tcp 10.72.171.111 10.128.4.252/255.128.7.255 eq 5986 count
    170 permit tcp 10.72.169.191 10.128.4.252/255.128.7.255 eq 5986 count
    %if is_qnapacl=Y%
    175 permit tcp 10.128.0.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	180 permit tcp 10.128.1.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	185 permit tcp 10.128.2.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	190 permit tcp 10.128.3.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	%endif%
    200 permit tcp QNAP_VLAN_2 10.128.4.244/255.128.7.255 eq 2049 count
    210 permit tcp QNAP_VLAN_2 10.128.4.245/255.128.7.255 eq 2049 count
    220 deny any 10.128.6.0/255.128.7.0 any count
    230 deny any 10.128.0.52/255.128.7.254 any count
    240 deny any 10.128.7.0/255.128.7.0 any count
    250 permit udp any eq 123 any count
    260 permit udp any eq 53 any count
    270 permit udp any eq 67 any count
    280 permit any 224.0.0.2 10.128.4.253/255.128.7.255 count
    290 permit any 224.0.0.2 10.128.4.254/255.128.7.255 count
    300 permit udp 69.64.165.18 eq 69 10.128.4.128/255.128.7.128 count
    310 permit udp 69.64.165.10 eq 69 10.128.4.128/255.128.7.128 count
    320 permit udp 10.128.0.14/255.128.7.255 group PORTS-BOOTPC-BOOTPS-TFTP-135-4011 10.128.4.128/255.128.7.128 count
    330 permit udp 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    340 permit udp 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    350 permit udp 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    360 permit udp 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    370 permit udp any 224.0.0.2 eq 1985 count
    380 permit udp any 224.0.0.18 eq 1985 count
    390 permit pim any any count
    400 permit igmp any any count
    410 permit ip 10.97.0.0/16 10.128.4.128/255.128.7.128 count
    420 permit ip 10.98.0.0/16 10.128.4.128/255.128.7.128 count
    430 permit ip 10.99.0.0/16 10.128.4.128/255.128.7.128 count
    450 permit ip 10.101.0.0/16 10.128.4.128/255.128.7.128 count
    460 permit ip 10.102.0.0/16 10.128.4.128/255.128.7.128 count
    470 permit ip 10.103.0.0/16 10.128.4.128/255.128.7.128 count
	480 permit tcp DC-SERVER-CAMERA 10.128.4.252/255.128.7.255 group GENTEC-VMS-PORTS count
    490 deny any any any count 
access-list ip FW-VLAN44-OUT_17-7-CSR-POC
    10 permit tcp any any established count
    20 permit icmp any any icmp-type echo count
    30 permit udp 10.128.0.0/9 any eq 161 count
    40 permit udp 10.128.0.0/9 any eq 68 count
    50 permit any 165.130.0.0/16 10.128.4.128/255.128.7.128 count
    55 permit tcp 10.128.0.160/255.128.7.252 any eq 80 count
    56 permit tcp 10.128.0.160/255.128.7.252 any eq 443 count 
    60 permit any 151.140.0.0/16 10.128.4.128/255.128.7.128 count
    70 permit any 207.11.0.0/17 10.128.4.128/255.128.7.128 count
    80 permit any 172.16.0.0/12 10.128.4.128/255.128.7.128 count
    90 permit any 10.128.0.0/9 10.128.4.252/255.128.7.255 count
    100 permit any 10.128.0.0/9 10.128.4.251/255.128.7.255 count
    110 permit any 10.66.0.0/16 10.128.4.128/255.128.7.128 count
    120 permit any 10.69.96.0/19 10.128.4.128/255.128.7.128 count
    130 permit any 10.74.0.0/16 10.128.4.128/255.128.7.128 count
    140 permit any 10.77.96.0/19 10.128.4.128/255.128.7.128 count
    150 permit any CYBERARK_PSM_RDP 10.128.4.128/255.128.7.128 count
    160 permit tcp 10.72.171.111 10.128.4.252/255.128.7.255 eq 5986 count
    170 permit tcp 10.72.169.191 10.128.4.252/255.128.7.255 eq 5986 count
    %if is_qnapacl=Y%
    175 permit tcp 10.128.0.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	180 permit tcp 10.128.1.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	185 permit tcp 10.128.2.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	190 permit tcp 10.128.3.0/255.128.7.0 10.128.4.244/255.128.7.254 group QNAP_CLIENTS count
	%endif%
    200 permit tcp QNAP_VLAN_2 10.128.4.244/255.128.7.255 eq 2049 count
    210 permit tcp QNAP_VLAN_2 10.128.4.245/255.128.7.255 eq 2049 count
    220 deny any 10.128.6.0/255.128.7.0 any count
    230 deny any 10.128.0.52/255.128.7.254 any count
    240 deny any 10.128.7.0/255.128.7.0 any count
    250 permit udp any eq 123 any count
    260 permit udp any eq 53 any count
    270 permit udp any eq 67 any count
    280 permit any 224.0.0.2 10.128.4.253/255.128.7.255 count
    290 permit any 224.0.0.2 10.128.4.254/255.128.7.255 count
    300 permit udp 69.64.165.18 eq 69 10.128.4.128/255.128.7.128 count
    310 permit udp 69.64.165.10 eq 69 10.128.4.128/255.128.7.128 count
    320 permit udp 10.128.0.14/255.128.7.255 group PORTS-BOOTPC-BOOTPS-TFTP-135-4011 10.128.4.128/255.128.7.128 count
    330 permit udp 10.74.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    340 permit udp 10.66.16.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    350 permit udp 10.74.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    360 permit udp 10.66.22.0/25 group PORTS-88-NTP-NETBIOS-NS-NETBIOS-DGM-389-445-464 10.128.4.128/255.128.7.128 count
    370 permit udp any 224.0.0.2 eq 1985 count
    380 permit udp any 224.0.0.18 eq 1985 count
    390 permit pim any any count
    400 permit igmp any any count
    410 permit tcp 10.69.128.32/255.255.255.224 10.128.4.248/255.128.7.254 eq 22 count
    420 permit tcp 10.77.128.32/255.255.255.224 10.128.4.248/255.128.7.254 eq 22 count
    430 permit ip 10.97.0.0/16 10.128.4.128/255.128.7.128 count
    440 permit ip 10.98.0.0/16 10.128.4.128/255.128.7.128 count
    450 permit ip 10.99.0.0/16 10.128.4.128/255.128.7.128 count
    470 permit ip 10.101.0.0/16 10.128.4.128/255.128.7.128 count
    480 permit ip 10.102.0.0/16 10.128.4.128/255.128.7.128 count
    490 permit ip 10.103.0.0/16 10.128.4.128/255.128.7.128 count
	500 permit tcp DC-SERVER-CAMERA 10.128.4.252/255.128.7.255 group GENTEC-VMS-PORTS count
    510 deny any any any count 
access-list ip SDWAN_MPLS
    10 comment Block SDW MPLS tunnel over other transports
    20 deny ip 10.119.0.0/16 any count
    30 permit ip any any
access-list ip SERIAL-OUT
    10 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 445 count
    20 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 135 count
    30 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 139 count
    40 permit any any 172.24.2.38 count
    50 permit tcp any 172.31.34.76 group PORTS-135-139-445 count
    60 permit tcp any 10.32.144.20 group PORTS-135-139-445 count
    70 permit tcp any 10.32.144.21 group PORTS-135-139-445 count
    80 permit tcp any 165.130.184.110 group PORTS-139-445 count
    90 permit tcp any 165.130.184.104 group PORTS-139-445 count
    100 permit tcp any 165.130.223.71 group PORTS-139-445 count
    110 permit tcp any 172.16.144.128 group PORTS-135-139-445 count
    120 permit tcp any 172.30.56.44 group PORTS-135-139-445 count
    130 permit tcp any 172.16.152.111 group PORTS-135-139-445 count
    140 permit tcp any 172.16.184.175 group PORTS-135-139-445 count
    150 permit tcp any 172.16.160.178 group PORTS-135-139-445 count
    160 permit tcp any 172.16.160.20 group PORTS-135-139-445 count
    170 permit tcp any 165.130.0.0/16 eq 135 count
    180 permit tcp any 172.31.43.52 group PORTS-135-139-445 count
    190 permit tcp any 172.30.52.11 group PORTS-135-139-445 count
    200 permit tcp any 172.30.59.45 group PORTS-135-139-445 count
    210 permit tcp any 172.31.26.20 group PORTS-135-139-445 count
    220 permit tcp any 172.30.16.20 group PORTS-135-139-445 count
    230 permit tcp any 172.30.28.20 group PORTS-135-139-445 count
    240 permit tcp any 172.30.0.45 group PORTS-135-139-445 count
    250 permit tcp any 172.30.128.64 group PORTS-135-139-445 count
    260 permit tcp any 172.30.44.40 group PORTS-135-139-445 count
    270 permit tcp any 165.130.128.0/24 eq 445 count
    280 permit tcp any 172.16.192.10 group PORTS-135-139-445 count
    290 permit tcp any 172.31.248.48 group PORTS-135-139-445 count
    300 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-135-139-389-445-464-636 count
    310 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-135-139-389-445-464-636 count
    320 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    330 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    340 permit udp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-123-137-138-389-445-464 count
    350 permit udp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-123-137-138-389-445-464 count
    360 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-135-139-389-445-464-636 count
    370 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-135-139-389-445-464-636 count
    380 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    390 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    400 permit udp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-123-137-138-389-445-464 count
    410 permit udp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-123-137-138-389-445-464 count
    420 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 gt 1023 count
    430 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 gt 1023 count
    440 permit tcp any 165.130.128.0/24 eq 139 count
    450 permit tcp any 165.130.204.0/24 eq 445 count
    460 permit tcp any 165.130.204.0/24 eq 139 count
    470 permit tcp any 165.130.210.128/25 eq 445 count
    480 permit tcp any 165.130.210.128/25 eq 139 count
    490 permit tcp any 165.130.218.0/24 eq 445 count
    500 permit tcp any 165.130.218.0/24 eq 139 count
    510 permit tcp any 165.130.150.0/26 eq 445 count
    520 permit tcp any 165.130.150.0/26 eq 139 count
    530 permit tcp any 165.130.150.80/29 eq 445 count
    540 permit tcp any 165.130.150.80/29 eq 139 count
    550 permit tcp any 165.130.202.128/28 eq 445 count
    560 permit tcp any 165.130.202.128/28 eq 139 count
    570 permit tcp any 165.130.64.0/24 eq 445 count
    580 permit tcp any 165.130.213.0/24 eq 139 count
    590 permit tcp any 165.130.213.0/24 eq 445 count
    600 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 group PORTS-5005-6010-554-5010 count
    610 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 group PORTS-5005-6010-554-5010 count
    620 permit tcp 10.128.0.0/9 10.128.4.252/255.128.7.255 group PORTS-5005-6010-554-5010 count
    630 permit tcp 10.128.0.0/9 10.128.4.251/255.128.7.255 group PORTS-5005-6010-554-5010 count
    640 deny tcp any any eq 4444 count
    650 permit any any 10.74.195.192/27 count
    660 permit any any 10.71.0.64/27 count
    670 permit tcp any 165.130.184.117 eq 139 count
    680 permit tcp any 165.130.184.117 eq 445 count
    690 permit tcp any any group PORTS-135-139-445 count
    700 deny udp any any eq 135 count
    710 deny udp any any eq 445 count
    720 deny udp any any eq 139 count
    730 deny udp any any eq 4444 count
    740 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 9950 count
    750 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 49 count
    760 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 514 count
    770 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 515 count
    780 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 389 count
    790 permit udp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 111 count
    800 permit udp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 eq 111 count
    810 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 gt 49151 count
    820 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 gt 49151 count
    830 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 range 32500 33000 count
    840 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 range 32500 33000 count
    850 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 23 count
    860 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 80 count
    870 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 4004 count
    880 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 111 count
    890 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 eq 80 count
    900 permit udp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 111 count
    910 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 gt 49151 count
    920 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 9100 count
    930 permit icmp 10.128.0.0/9 10.128.0.0/9 count
    940 permit tcp 10.128.0.0/29 10.128.0.0/9 eq 1439 count
    950 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 80 count
    960 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 1420 count
    970 permit tcp 10.128.6.5/255.128.7.255 10.128.6.5/255.128.7.255 eq 22 count
    980 permit tcp 10.128.0.0/9 10.128.0.24/255.128.7.255 eq 8080 count
    1000 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 count
    1010 permit udp 10.128.0.1/255.128.7.255 eq 111 10.128.0.0/9 count
    1020 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 12020 count
    1030 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 12030 count
    1040 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 12060 count
    1050 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 12070 count
    1060 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 eq 12020 count
    1070 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 eq 12030 count
    1080 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 eq 12060 count
    1090 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 eq 12070 count
    1100 permit tcp 10.128.0.1/255.128.7.255 eq 12020 10.128.0.0/9 count
    1110 permit tcp 10.128.0.1/255.128.7.255 eq 12030 10.128.0.0/9 count
    1120 permit tcp 10.128.0.1/255.128.7.255 eq 12060 10.128.0.0/9 count
    1130 permit tcp 10.128.0.1/255.128.7.255 eq 12070 10.128.0.0/9 count
    1140 permit tcp 10.128.0.45/255.128.7.255 eq 12020 10.128.0.0/9 count
    1150 permit tcp 10.128.0.45/255.128.7.255 eq 12030 10.128.0.0/9 count
    1160 permit tcp 10.128.0.45/255.128.7.255 eq 12060 10.128.0.0/9 count
    1170 permit tcp 10.128.0.45/255.128.7.255 eq 12070 10.128.0.0/9 count
    1180 permit udp 10.128.0.45/255.128.7.255 eq 111 10.128.0.0/9 count
    1190 deny udp 10.128.0.0/9 10.128.0.0/9 eq 161 count
    1200 deny udp 10.128.0.0/9 eq 161 10.128.0.0/9 count
    1210 deny udp 10.128.0.0/9 10.215.243.40 eq 162 count
    1220 deny udp 10.128.0.0/9 10.128.0.0/9 eq 123 count
    1230 deny any 10.128.0.0/9 10.128.0.0/9 count 
    1240 permit any any any
access-list ip SNMP_ACL
    10 permit any 10.130.72.0/255.255.252.0 any
    20 permit any 151.140.0.0/16 any
    30 permit any 165.130.0.0/16 any
    40 permit any 172.0.0.0/8 any
    50 permit any 192.168.50.0/24 any
    60 permit any 207.11.12.0/24 any
    70 permit any 207.11.21.0/24 any
    80 permit any 10.74.220.32/255.255.255.240 any
    90 permit any 10.128.5.168/255.128.7.255 any
access-list ip VSAT-OUT-01-14-14
    10 permit icmp any any count
    20 permit ip any 172.24.2.38 count
    30 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 445 count
    40 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 135 count
    50 deny tcp 10.128.0.0/9 10.128.0.0/9 eq 139 count
    60 permit tcp any any eq 445 count
    70 permit tcp any any eq 135 count
    80 permit tcp any any eq 139 count
    90 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 gt 1023 count
    100 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 gt 1023 count
    110 permit tcp any 10.128.0.0/9 eq 12040 count
    120 permit udp any 10.128.0.0/9 eq 12040 count
    130 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 eq 5005 count
    140 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 eq 6010 count
    150 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 eq 554 count
    160 permit tcp 10.128.0.0/9 10.128.0.32/255.128.7.255 eq 5010 count
    170 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 eq 5005 count
    180 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 eq 6010 count
    190 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 eq 554 count
    200 permit tcp 10.128.0.0/9 10.128.0.33/255.128.7.255 eq 5010 count
    210 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 9950 count
    220 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 48 count
    230 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 514 count
    240 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 515 count
    250 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 389 count
    260 permit udp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 eq 111 count
    270 permit udp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 eq 111 count
    280 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 gt 49151 count
    290 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 gt 49151 count
    300 permit tcp 10.128.0.45/255.128.7.255 10.128.0.1/255.128.7.255 range 32500 33000 count
    310 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 range 32500 33000 count
    320 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 23 count
    330 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 80 count
    340 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 4004 count
    350 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 111 count
    360 permit tcp 10.128.0.0/9 10.128.0.4/255.128.7.255 eq 80 count
    370 permit udp 10.128.0.0/9 10.128.0.1/255.128.7.255 eq 111 count
    380 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 gt 49151 count
    390 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 9100 count
    400 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 1439 count
    410 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 80 count
    420 permit tcp 10.128.0.0/9 10.128.0.0/9 eq 1420 count
    430 permit tcp 10.128.6.5/255.128.7.255 10.128.6.5/255.128.7.255 eq 22 count
    440 permit tcp 10.128.0.0/9 10.128.0.24/255.128.7.255 eq 8080 count
    450 permit tcp 10.128.0.0/9 10.128.0.0/9 established count
    460 permit tcp 10.128.0.45/255.128.7.255 10.128.0.45/255.128.7.255 count
    470 permit udp 10.128.0.1/255.128.7.255 eq 111 10.128.0.0/9 count
    480 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-135-139-389-445-464-636 count
    490 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-135-139-389-445-464-636 count
    500 permit tcp 10.128.0.0/9 10.74.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    510 permit tcp 10.128.0.0/9 10.66.16.0/25 group PORTS-3268-3269-9389-49204-49206 count
    520 permit udp 10.128.0.0/9 10.74.16.0/25 group PORTS-88-123-137-138-389-445-464 count
    530 permit udp 10.128.0.0/9 10.66.16.0/25 group PORTS-88-123-137-138-389-445-464 count
    540 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-135-139-389-445-464-636 count
    550 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-135-139-389-445-464-636 count
    560 permit tcp 10.128.0.0/9 10.74.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    570 permit tcp 10.128.0.0/9 10.66.22.0/25 group PORTS-3268-3269-9389-49204-49206 count
    580 permit udp 10.128.0.0/9 10.74.22.0/25 group PORTS-88-123-137-138-389-445-464 count
    590 permit udp 10.128.0.0/9 10.66.22.0/25 group PORTS-88-123-137-138-389-445-464 count
    600 permit tcp 10.128.0.0/9 10.128.0.1/255.128.7.255 group PORTS-12000-12020-12030-12060-12070 count
    610 permit tcp 10.128.0.0/9 10.128.0.45/255.128.7.255 group PORTS-12000-12020-12030-12060-12070 count
    620 permit tcp 10.128.0.1/255.128.7.255 group PORTS-12000-12020-12030-12060-12070 10.128.0.0/9 count
    630 permit tcp 10.128.0.45/255.128.7.255 group PORTS-12000-12020-12030-12060-12070 10.128.0.0/9 count
    640 permit udp 10.128.0.45/255.128.7.255 eq 111 10.128.0.0/9 count
    650 deny udp 10.128.0.0/9 10.128.0.0/9 eq 161 count
    660 deny udp 10.128.0.0/9 eq 161 10.128.0.0/9 count
    670 deny udp 10.128.0.0/255.128.7.255 10.215.243.40 eq 162 count
    680 deny udp 10.128.0.0/9 10.128.0.0/9 eq 123 count
    690 deny any 10.128.0.0/9 10.128.0.0/9 count
    700 deny tcp 10.128.0.54/255.128.7.255 any eq 27000 count
    710 deny any any MOZY_BACKUPS count
    720 deny any any RUBRIK_BACKUPS count
    730 deny udp any any eq 9997 count
    740 deny tcp any any eq 9997 count
    750 deny udp any any eq 17472 count
    760 deny udp any any eq 17477 count
    770 deny tcp any any eq 17472 count
    780 deny tcp any any eq 17477 count
    790 deny tcp any any eq 4444 count
    800 deny udp any any eq 4444 count
    810 permit any any any
access-list ip broadband_inbound_CHG0493924
    10 deny tcp any any eq 22 log count
access-list ip internet_inbound_chg0493923
%if vlan_51_ip=none%
%else%				
    20 permit icmp %route_next_hop_inet% %vlan_51_ip% count
%endif%
    30 permit ip 207.11.17.0/25 any count
    40 permit ip 207.11.48.0/25 any count
    50 permit ip 207.11.71.32/28 any
    60 permit ip 207.11.72.32/28 any
    70 permit ip 207.11.73.32/28 any
    80 permit ip 207.11.74.32/28 any
    90 permit ip 207.11.75.32/28 any
    100 permit ip 207.11.76.32/28 any
    110 permit ip 207.11.77.32/28 any
    120 permit icmp 8.8.4.4 any count
    130 permit icmp 8.8.8.8 any count
    140 permit icmp 1.0.0.1 any count
    150 deny ip any any log count
access-list ip internet_inbound_chg0746548
%if vlan_51_ip=none%
%else%
    05 permit icmp %route_next_hop_inet% %vlan_51_ip% count
%endif%	
    10 permit any 207.11.0.0/255.255.128.0 any count
    20 permit any AZURE_SDWAN_CONTROL any count
    30 permit icmp 8.8.8.8 any count
    40 deny any any any log count
!
!----- Apply Contro Plane ACL -------
apply access-list ip CONTROLPLANE control-plane vrf default
!
!-----QoS Classifiers--------
class ip SCCM_OTHER
	10 match tcp 10.128.0.14/0.127.248.0 10.128.0.0/0.127.255.255
class ip SCCM_VLAN2
	10 match tcp 10.128.0.14/0.127.248.0 10.128.0.0/0.127.248.255
	20 match tcp 10.128.0.14/0.127.248.0 10.128.1.0/0.127.248.255
	30 match tcp 10.128.0.14/0.127.248.0 10.128.2.0/0.127.248.255
class ip QOS-m-bulk-af11
    10 comment match access-group name QOSa_sccm
    20 match any any 151.140.104.238 count
    30 match any any 151.140.107.38 count
    40 match any any 151.140.107.48/31 count
    50 match any any 151.140.14.101 count
    60 match any any 151.140.2.233 count
    70 match any any 151.140.2.234/31 count
    80 match any any 151.140.2.245 count
    90 match any any 151.140.2.246 count
    100 match any any 151.140.2.248 count
    110 match any any 151.140.48.220 count
    120 match any any 151.140.48.246/31 count
    130 match any any 151.140.48.248/31 count
    140 match any any 151.140.49.83 count
    150 match any any 151.140.49.95 count
    160 match any any 151.140.50.130 count
    170 match any any 151.140.76.105 count
    180 match any any 151.140.76.108/30 count
    190 match any any 151.140.76.112/31 count
    200 match any any 151.140.76.173/255.255.255.253 count
    210 match any any 151.140.78.5 count
    220 match any any 151.140.79.142/31 count
    230 match any any 165.130.184.107 count
    240 match any any 165.130.184.115 count
    250 match any any 165.130.184.150/31 count
    260 match any any 165.130.184.177 count
    270 match any any 165.130.184.209 count
    280 match any any 165.130.184.99 count
    290 match any any 165.130.190.82 count
    300 match any any 165.130.208.247 count
    310 match any any 165.130.223.107 count
    320 match any any 165.130.223.108 count
    330 match any any 165.130.223.180/30 count
    340 match any any 165.130.223.185 count
    350 match any any 165.130.223.65 count
    360 match any any 165.130.223.66 count
    370 match any any 165.130.223.71 count
    380 match any any 172.17.98.144 count
    390 match any any 207.11.31.118 count
    400 match any any 10.66.200.8/30 count
    410 match any any 10.66.200.27 count
    420 match any any 10.66.200.28/30 count
    430 match any any 10.66.200.32/29 count
    440 match any any 10.74.200.8/29 count
    450 match any any 10.74.200.16/28 count
    460 match any any 10.74.200.35 count
    470 match any any 151.140.76.175 count
    480 match any any 165.130.174.46 count
    490 match any any 207.11.31.121 count
    500 match any any 207.11.34.130 count
    510 comment match access-group name QOSa_monitorTCP
    520 match tcp any any eq 9997 count
    530 match any any 165.130.1.8 count
    540 match any any 165.130.1.16 count
    550 match any any 165.130.1.18 count
    560 match any any 165.130.1.19 count
    570 match any any 165.130.1.20 count
    580 match any any 165.130.1.21 count
    590 match tcp any any eq 162 count
    600 match tcp any eq 162 any count
    610 match tcp any any eq 1270 count
    611 match tcp any any eq 5723 count
    620 match tcp any eq 1270 any count
    621 match tcp any eq 5723 any count
    630 comment match access-group name QOSa_monitorUDP
    640 match udp any any eq 514 count
    650 comment match access-group name QOSa_tripwire
    660 match any any 151.140.102.24/29 count
    670 match any any 151.140.102.32/29 count
    680 match any any 151.140.102.40 count
    690 match any any 151.140.12.147 count
    700 match any any 151.140.12.97 count
    710 match any any 151.140.50.132/30 count
    720 match any any 151.140.50.136/29 count
    730 match any any 151.140.78.162/31 count
    740 match any any 172.18.138.197/255.255.255.253 count
    750 match any any 172.18.138.229 count
    760 match any any 172.18.139.17 count
    770 match any any 172.18.139.20 count
    780 match any any 172.20.136.107 count
    790 match any any 172.20.166.170 count
    800 match any any 172.20.167.103 count
    810 match any any 172.20.167.26/31 count
    820 match any any 172.20.167.89 count
    830 match any any 172.20.225.133 count
    840 match any any 172.20.225.74 count
    850 match any any 172.20.225.99 count
    860 match any any 172.20.225.71 count
    870 match any any 172.20.225.72 count
    880 match any any 10.69.96.198/31 count
    890 match any any 10.69.96.200/31 count
    900 match any any 10.69.96.202/31 count
    910 match any any 10.69.96.204/31 count
    920 match any any 10.69.96.206/31 count
    930 match any any 10.77.96.198/31 count
    940 match any any 10.77.96.200/31 count
    950 match any any 10.77.96.202/31 count
    960 match any any 10.77.96.204/31 count
    970 match any any 10.77.96.206/31 count
    980 match any any 10.77.96.208/31 count
    990 match any any 10.77.96.210 count
    1000 comment match access-group name QOSa_tanium
    1010 match any any 151.140.13.47 count
    1020 match any any 151.140.102.169 count
    1030 match any any 151.140.102.170 count
    1040 match any any 151.140.103.0 count
    1050 match any any 151.140.84.204/31 count
    1060 match any any 151.140.84.206 count
    1070 match any any 151.140.4.29 count
    1080 match any any 10.77.107.71 count
    1090 match any any 10.77.99.6/31 count
    1100 match any any 10.77.99.70/31 count
    1110 match tcp any any eq 17472 count
    1120 match tcp any any eq 17477 count
    1130 comment match access-group name QOSa_mozy time-range CLOUD_DAYS
    1140 match ip any 65.44.121.0/24 count
    1150 match ip any 74.112.144.0/21 count
    1160 match ip any 173.243.48.0/20 count
    1170 match ip any 193.120.226.0/24 count
    1180 match ip any 193.120.29.220/30 count
    1190 match ip any 193.120.29.224/30 count
    1200 match tcp 1.1.1.1 1.1.1.2 eq 80 count
    1380 comment object-group network CROWDSTRIKE
    1390 match any any 13.56.121.58 count
    1400 match any any 13.56.127.239 count
    1410 match any any 13.57.54.63 count
    1420 match any any 4.67.17.131 count
    1430 match any any 50.18.194.39 count
    1440 match any any 50.18.198.237 count
    1450 match any any 52.52.117.52 count
    1460 match any any 52.52.119.33 count
    1470 match any any 52.52.149.168 count
    1480 match any any 52.52.239.58 count
    1490 match any any 52.53.77.89 count
    1500 match any any 52.8.134.130 count
    1510 match any any 52.8.141.1 count
    1520 match any any 52.8.160.82 count
    1530 match any any 52.8.172.89 count
    1540 match any any 52.8.173.58 count
    1550 match any any 52.8.19.75 count
    1560 match any any 52.8.32.113 count
    1570 match any any 52.8.45.162 count
    1580 match any any 52.8.5.240 count
    1590 match any any 52.8.54.244 count
    1600 match any any 52.8.61.206 count
    1610 match any any 52.9.104.148 count
    1620 match any any 52.9.212.176 count
    1630 match any any 52.9.77.209 count
    1640 match any any 52.9.82.94 count
    1650 match any any 52.9.87.98 count
    1660 match any any 54.183.105.3 count
    1670 match any any 54.183.120.141 count
    1680 match any any 54.183.122.156 count
    1690 match any any 54.183.135.80 count
    1700 match any any 54.183.140.32 count
    1710 match any any 54.183.142.105 count
    1720 match any any 54.183.148.116 count
    1730 match any any 54.183.148.43 count
    1740 match any any 54.183.215.154 count
    1750 match any any 54.183.234.42 count
    1760 match any any 54.183.24.162 count
    1770 match any any 54.183.252.86 count
    1780 match any any 54.183.34.154 count
    1790 match any any 54.183.39.68 count
    1800 match any any 54.183.51.31 count
    1810 match any any 54.183.51.69 count
    1820 match any any 54.183.52.221 count
    1830 match any any 54.193.117.199 count
    1840 match any any 54.193.27.226 count
    1850 match any any 54.193.29.47 count
    1860 match any any 54.193.67.98 count
    1870 match any any 54.193.86.245 count
    1880 match any any 54.193.87.57 count
    1890 match any any 54.193.90.171 count
    1900 match any any 54.193.93.19 count
    1910 match any any 54.215.131.232 count
    1920 match any any 54.215.154.80 count
    1930 match any any 54.215.169.199 count
    1940 match any any 54.215.169.38 count
    1950 match any any 54.215.170.42 count
    1960 match any any 54.215.176.108 count
    1970 match any any 54.215.183.157 count
    1980 match any any 54.215.226.55 count
    1990 match any any 54.219.112.243 count
    2000 match any any 54.219.115.12 count
    2010 match any any 54.219.137.54 count
    2020 match any any 54.219.140.50 count
    2030 match any any 54.219.141.250 count
    2040 match any any 54.219.145.181 count
    2050 match any any 54.219.147.253 count
    2060 match any any 54.219.148.161 count
    2070 match any any 54.219.149.89 count
    2080 match any any 54.219.149.92 count
    2090 match any any 54.219.151.1 count
    2100 match any any 54.219.151.27 count
    2110 match any any 54.219.153.248 count
    2120 match any any 54.219.158.53 count
    2130 match any any 54.219.159.84 count
    2140 match any any 54.219.161.141 count
    2150 match any any 54.219.179.25 count
    2160 match any any 54.241.138.180 count
    2170 match any any 54.241.146.67 count
    2180 match any any 54.241.148.127 count
    2190 match any any 54.241.150.134 count
    2200 match any any 54.241.161.242 count
    2210 match any any 54.241.161.60 count
    2220 match any any 54.241.162.180 count
    2230 match any any 54.241.162.64 count
    2240 match any any 54.241.164.212 count
    2250 match any any 54.241.175.140 count
    2260 match any any 54.241.175.52 count
    2270 match any any 54.241.179.52 count
    2280 match any any 54.241.181.242 count
    2290 match any any 54.241.181.78 count
    2300 match any any 54.241.182.78 count
    2310 match any any 54.241.183.151 count
    2320 match any any 54.241.183.229 count
    2330 match any any 54.241.183.232 count
    2340 match any any 54.241.184.161 count
    2350 match any any 54.241.185.201 count
    2360 match any any 54.241.186.124 count
    2370 match any any 54.241.197.58 count
    2380 match any any 54.67.105.202 count
    2390 match any any 54.67.108.17 count
    2400 match any any 54.67.114.188 count
    2410 match any any 54.67.119.89 count
    2420 match any any 54.67.122.238 count
    2430 match any any 54.67.123.150 count
    2440 match any any 54.67.123.234 count
    2450 match any any 54.67.24.156 count
    2460 match any any 54.67.26.184 count
    2470 match any any 54.67.33.233 count
    2480 match any any 54.67.4.108 count
    2490 match any any 54.67.41.192 count
    2500 match any any 54.67.48.56 count
    2510 match any any 54.67.5.136 count
    2520 match any any 54.67.51.32 count
    2530 match any any 54.67.54.116 count
    2540 match any any 54.67.6.201 count
    2550 match any any 54.67.68.88 count
    2560 match any any 54.67.72.218 count
    2570 match any any 54.67.78.134 count
    2580 match any any 54.67.92.206 count
    2590 match any any 54.67.96.255 count
    2600 match any any 54.67.99.247 count
    2610 match any any 52.43.73.53 count
    2620 match any any 35.164.23.230 count
    2630 comment match access-group name QOSa_rubrik
    2640 match any any 10.72.64.0/24 count
    2650 match any any 10.64.64.0/24 count
class ip QOS-m-business-af21
    10 comment access-group name QOSa_grid-apps
    20 match any any 151.140.107.0/24 count
    30 match any any 151.140.120.13 count
    40 match any any 151.140.120.14/31 count
    50 match any any 151.140.120.16/28 count
    60 match any any 151.140.120.32/28 count
    70 match any any 151.140.120.48 count
    80 match any any 151.140.120.101 count
    90 match any any 151.140.120.102 count
    100 match any any 151.140.120.107 count
    110 match any any 151.140.120.108/30 count
    120 match any any 151.140.120.112/28 count
    130 match any any 151.140.120.128/26 count
    140 match any any 151.140.120.192/29 count
    150 match any any 151.140.120.200 count
    160 match any any 151.140.4.144/28 count
    170 match any any 151.140.4.160/27 count
    180 match any any 151.140.4.192/27 count
    190 match any any 151.140.4.224/28 count
    200 match any any 151.140.4.240/29 count
    210 match any any 151.140.4.248/31 count
    220 match any any 151.140.64.80/28 count
    230 match any any 151.140.64.96/30 count
    240 match any any 151.140.64.255 count
    250 match any any 151.140.65.138 count
    260 match any any 151.140.65.140 count
    270 match any any 151.140.65.2 count
    280 match any any 151.140.65.194 count
    290 match any any 151.140.65.203 count
    300 match any any 151.140.65.231 count
    310 match any any 151.140.65.232/29 count
    320 match any any 151.140.66.120/31 count
    330 match any any 151.140.66.191 count
    340 match any any 151.140.66.199 count
    350 match any any 151.140.66.251 count
    360 match any any 151.140.66.252/30 count
    370 match any any 151.140.67.1 count
    380 match any any 151.140.67.2/31 count
    390 match any any 151.140.67.4/30 count
    400 match any any 151.140.67.8/30 count
    410 match any any 151.140.67.12/30 count
    420 match any any 151.140.67.16/28 count
    430 match any any 151.140.67.32/27 count
    440 match any any 151.140.67.64/26 count
    450 match any any 151.140.67.190 count
    460 match any any 151.140.67.199 count
    470 match any any 151.140.67.200/29 count
    480 match any any 151.140.67.209 count
    490 match any any 151.140.67.210 count
    500 match any any 151.140.67.216/29 count
    510 match any any 151.140.67.224/28 count
    520 match any any 151.140.67.240/29 count
    530 match any any 151.140.80.0/26 count
    540 match any any 151.140.84.40/29 count
    550 match any any 151.140.84.48/28 count
    560 match any any 151.140.84.64/29 count
    570 match any any 151.140.84.72/30 count
    580 match any any 151.140.85.0/26 count
    590 match any any 151.140.85.64/27 count
    600 match any any 151.140.85.96/30 count
    610 match any any 151.140.85.100 count
    620 match any any 151.140.96.0/24 count
    630 match any any 151.140.97.0/24 count
    640 match any any 151.140.98.0/24 count
    650 match any any 165.130.166.105 count
    660 match any any 165.130.166.126/255.255.247.255 count
    670 match any any 165.130.166.131/255.255.247.255 count
    680 match any any 165.130.166.182/255.255.247.255 count
    690 match any any 165.130.166.214/255.255.247.255 count
    700 match any any 165.130.166.220/255.255.247.255 count
    710 match any any 165.130.166.30/255.255.247.255 count
    720 match any any 165.130.166.40/255.255.247.255 count
    730 match any any 165.130.167.111/255.255.247.255 count
    740 match any any 165.130.167.12/255.255.247.255 count
    750 match any any 165.130.167.250/255.255.247.255 count
    760 match any any 165.130.188.10 count
    770 match any any 165.130.188.14 count
    780 match any any 165.130.188.17 count
    790 match any any 165.130.188.18 count
    800 match any any 165.130.188.21/255.255.255.253 count
    810 match any any 165.130.188.24/31 count
    820 match any any 165.130.188.154 count
    830 match any any 165.130.188.159 count
    840 match any any 165.130.188.160/27 count
    850 match any any 165.130.188.223 count
    860 match any any 165.130.230.147 count
    870 match any any 165.130.230.148 count
    880 match any any 165.130.230.151 count
    890 match any any 165.130.230.235 count
    900 match any any 165.130.238.147 count
    910 match any any 165.130.238.148 count
    920 match any any 165.130.238.151 count
    930 match any any 165.130.238.235 count
    940 match any any 207.11.34.196 count
    950 match any any 207.11.43.8/29 count
    960 match any any 207.11.43.16/28 count
    970 match any any 207.11.43.140/30 count
    980 match any any 207.11.43.144/28 count
    990 comment access-group name QOSa_ldap
    1000 match udp any any eq 389 count
    1010 match tcp any eq 389 any count
    1020 match tcp any eq 636 any count
    1030 match tcp any eq 3268 any count
    1040 match udp any eq 389 any count
    1050 comment access-group name QOSa_amer-ad
    1060 match tcp any any eq 445 count
    1070 comment ip access-list extended QOSa_svs
    1080 match any any 165.130.166.121 count
    1090 match any any 165.130.174.121 count
    1100 match any any 165.130.166.122 count
    1110 match any any 165.130.174.122 count
    1120 match any any 165.130.174.33 count
    1130 match any any 165.130.174.32 count
    1140 match any any 165.130.189.16 count
    1150 match any any 165.130.213.205 count
    1160 match tcp any eq 12040 any count
    1170 match tcp any eq 13040 any count
    1180 comment ip access-list extended QOSa_virtkitchen
    1190 match any any 165.130.174.233 count
    1200 match any any 165.130.166.233 count
    1210 comment ip access-list extended QOSa_fast
    1220 match any any 165.130.166.238 count
    1231 match any any 165.130.174.238 count
    1240 match any any 165.130.174.201 count
    1250 match any any 165.130.166.201 count
    1260 comment match access-group name QOSa_sap
    1270 match any any 151.140.64.114/31 count
    1280 match any any 165.130.80.110/31 count
    1290 match any any 165.130.80.112/30 count
    1300 match any any 151.140.76.174 count
    1310 match any any 165.130.166.245 count
    1320 match any any 165.130.170.44 count
    1330 match any any 165.130.174.245 count
    1340 match any any 165.130.178.44 count
    1350 match any any 165.130.230.122 count
    1360 match any any 165.130.230.135 count
    1370 match any any 165.130.230.189 count
    1380 match any any 165.130.230.210 count
    1390 match any any 165.130.230.77 count
    1400 match any any 165.130.230.91 count
    1410 match any any 165.130.238.135 count
    1420 match any any 165.130.238.189 count
    1430 match any any 165.130.238.210 count
    1440 match any any 165.130.238.77 count
    1450 match any any 165.130.238.91 count
    1460 match any any 165.130.80.109 count
    1470 match any any 165.130.80.20 count
    1480 match any any 165.130.80.30 count
    1490 match any any 165.130.80.44 count
    1500 match any any 165.130.80.48 count
    1510 match any any 165.130.80.52 count
    1520 match any any 165.130.80.60 count
    1530 match any any 165.130.80.66 count
    1540 comment access-group name QOSa_discountsvc
    1550 match any any 130.211.6.247 count
class ip QOS-m-buslopri-af22
    10 comment match access-group name QOSa_citrix
    20 match any any 151.140.49.180/30 count
    30 match any any 151.140.49.184/29 count
    40 match any any 151.140.49.192/31 count
    50 match any any 151.140.49.197 count
    60 match any any 151.140.49.198/31 count
    70 match any any 151.140.49.200/29 count
    80 match any any 151.140.49.208/29 count
    90 match any any 151.140.49.216/30 count
    100 match any any 151.140.77.164/31 count
    110 match any any 151.140.77.168/31 count
    120 match any any 151.140.77.174 count
    130 match any any 151.140.77.178/31 count
    140 match any any 151.140.77.180/30 count
    150 match any any 151.140.77.184 count
    160 match any any 165.130.32.214 count
    170 match any any 172.26.28.0/24 count
    180 match any any 151.140.49.195 count
    190 match any any 151.140.49.196 count
    200 match any any 151.140.77.171 count
    210 match any any 151.140.77.177 count
    220 match any any 151.140.77.197 count
    230 match any any 151.140.120.128/26 count
    240 match any any 151.140.120.192/29 count
    250 match any any 151.140.120.200 count
    260 match any any 151.140.4.144/28 count
    270 match any any 151.140.4.160/27 count
    280 match any any 151.140.4.192/27 count
    290 match any any 151.140.4.224/28 count
    300 match any any 151.140.4.240/29 count
    310 match any any 151.140.4.248/31 count
    320 match any any 151.140.64.80/28 count
    330 match any any 151.140.64.96/30 count
    340 match any any 151.140.64.255 count
    350 match any any 151.140.65.138 count
    360 match any any 151.140.65.140 count
    370 match any any 151.140.65.2 count
    380 match any any 151.140.65.194 count
    390 match any any 151.140.65.203 count
    400 match any any 151.140.65.231 count
    410 match any any 151.140.65.232/29 count
    420 match any any 151.140.66.120/31 count
    430 match any any 151.140.66.191 count
    440 match any any 151.140.66.199 count
    450 match any any 151.140.66.251 count
    460 match any any 151.140.66.252/30 count
    470 match any any 151.140.67.1 count
    480 match any any 151.140.67.2/31 count
    490 match any any 151.140.67.4/30 count
    500 match any any 151.140.67.8/30 count
    510 match any any 151.140.67.12/30 count
    520 match any any 151.140.67.16/28 count
    530 match any any 151.140.67.32/27 count
    540 match any any 151.140.67.64/26 count
    550 match any any 151.140.67.190 count
    560 match any any 151.140.67.199 count
    570 match any any 151.140.67.200/29 count
    580 match any any 151.140.67.209 count
    590 match any any 151.140.67.210 count
    600 match any any 151.140.67.216/29 count
    610 match any any 151.140.67.224/28 count
    620 match any any 151.140.67.240/29 count
    630 match any any 151.140.80.0/26 count
    640 match any any 151.140.84.40/29 count
    650 match any any 151.140.84.48/28 count
    660 match any any 151.140.84.64/29 count
    670 match any any 151.140.84.72/30 count
    680 match any any 151.140.85.0/26 count
    690 match any any 151.140.85.64/27 count
    700 match any any 151.140.85.96/30 count
    710 match any any 151.140.85.100 count
    720 match any any 151.140.96.0/24 count
    730 match any any 151.140.97.0/24 count
    740 match any any 151.140.98.0/24 count
    750 match any any 165.130.166.105 count
    760 match any any 165.130.166.126/255.255.247.255 count
    770 match any any 165.130.166.131/255.255.247.255 count
    780 match any any 165.130.166.182/255.255.247.255 count
    790 match any any 165.130.166.214/255.255.247.255 count
    800 match any any 165.130.166.220/255.255.247.255 count
    810 match any any 165.130.166.30/255.255.247.255 count
    820 match any any 165.130.166.40/255.255.247.255 count
    830 match any any 165.130.167.111/255.255.247.255 count
    840 match any any 165.130.167.12/255.255.247.255 count
    850 match any any 165.130.167.250/255.255.247.255 count
    860 match any any 165.130.188.10 count
    870 match any any 165.130.188.14 count
    880 match any any 165.130.188.17 count
    890 match any any 165.130.188.18 count
    900 match any any 165.130.188.21/255.255.255.253 count
    910 match any any 165.130.188.24/31 count
    920 match any any 165.130.188.154 count
    930 match any any 165.130.188.159 count
    940 match any any 165.130.188.160/27 count
    950 match any any 165.130.188.223 count
    960 match any any 165.130.230.147 count
    970 match any any 165.130.230.148 count
    980 match any any 165.130.230.151 count
    990 match any any 165.130.230.235 count
    1000 match any any 165.130.238.147 count
    1010 match any any 165.130.238.148 count
    1020 match any any 165.130.238.151 count
    1030 match any any 165.130.238.235 count
    1040 match any any 207.11.34.196 count
    1050 match any any 207.11.43.8/29 count
    1060 match any any 207.11.43.16/28 count
    1070 match any any 207.11.43.140/30 count
    1080 match any any 207.11.43.144/28 count
    1090 comment match access-group name QOSa_myapron
    1100 match any any 165.130.166.87/255.255.247.255 count
    1110 match any any 165.130.166.78/255.255.247.255 count
    1120 match any any 165.130.230.78/255.255.247.255 count
    1130 match any any 165.130.167.123/255.255.247.255 count
    1140 match any any 165.130.230.87/255.255.247.255 count
    1150 comment match access-group name QOSa_spacewalk
    1160 match any any 10.66.112.134/31 count
    1170 match any any 10.66.112.136/30 count
    1180 match any any 10.66.112.140/31 count
    1190 match any any 10.66.176.134 count
    1200 match any any 10.74.112.134/31 count
    1210 match any any 10.74.112.136/30 count
    1220 match any any 10.74.112.140 count
    1230 match any any 10.74.176.134 count
    1240 match any any 151.140.101.112 count
    1250 match any any 151.140.102.148/31 count
    1260 match any any 151.140.12.140 count
    1270 match any any 151.140.14.57 count
    1280 match any any 151.140.14.58 count
    1290 match any any 151.140.48.194/31 count
    1300 match any any 151.140.50.12/31 count
    1310 match any any 151.140.50.56 count
    1320 match any any 151.140.78.135 count
    1330 match any any 151.140.78.66/31 count
    1340 match any any 151.140.84.195 count
    1350 match any any 151.140.84.196 count
    1360 match any any 165.130.167.21 count
    1370 match any any 172.19.129.42 count
    1380 match any any 151.140.84.200/31 count
    1390 comment match access-group name QOSa_puppet
    1400 match any any 10.66.1.135 count
    1410 match any any 10.66.1.136/29 count
    1420 match any any 10.66.1.144/30 count
    1430 match any any 10.66.177.70/31 count
    1440 match any any 10.74.1.135 count
    1450 match any any 10.74.1.144/30 count
    1460 match any any 10.74.177.70/31 count
    1470 match any any 151.140.101.69 count
    1480 match any any 151.140.101.70 count
    1490 match any any 151.140.102.174 count
    1500 match any any 165.130.170.108/31 count
    1510 match any any 151.140.101.67 count
    1520 match any any 151.140.101.68/31 count
    1530 match any any 151.140.102.174/31 count
    1540 match any any 151.140.102.177 count
    1550 match any any 151.140.102.178/31 count
    1560 match any any 151.140.12.76/30 count
    1570 match any any 151.140.14.71 count
    1580 match any any 151.140.14.75 count
    1590 match any any 151.140.50.19 count
    1600 match any any 151.140.50.20/31 count
    1610 match any any 151.140.50.22 count
    1620 match any any 151.140.50.220/31 count
    1630 match any any 151.140.50.223 count
    1640 match any any 151.140.50.224/31 count
    1650 match any any 151.140.78.75 count
    1660 match any any 151.140.78.76/31 count
    1670 match any any 151.140.78.78 count
    1680 match any any 151.140.85.127 count
    1690 match any any 151.140.85.128 count
    1700 comment match access-group name QOSa_vcenter
    1710 match any any 151.140.0.125 count
    1720 match any any 151.140.0.126/31 count
    1730 match any any 151.140.0.178/31 count
    1740 match any any 151.140.0.180 count
    1750 match any any 151.140.13.114/31 count
    1760 match any any 151.140.13.116/31 count
    1770 match any any 151.140.48.148/31 count
    1780 match any any 151.140.48.150 count
    1790 match any any 151.140.65.3 count
    1800 match any any 151.140.65.221 count
    1810 match any any 151.140.65.222/31 count
    1820 match any any 151.140.79.149 count
    1830 match any any 151.140.79.150 count
    1840 match any any 151.140.79.17 count
    1850 match any any 151.140.79.18 count
    1860 match any any 151.140.104.144 count
    1870 match any any 151.140.104.163 count
    1880 match any any 151.140.104.164/31 count
    1890 comment match access-group name QOSa_kronos
    1900 match any any 165.130.166.251 count
    1910 match any any 165.130.166.113 count
    1920 match any any 151.140.76.245 count
    1930 match any any 165.130.166.25 count
    1940 match any any 207.11.34.250 count
    1950 comment match access-group name QOSa_activemq
    1960 match any any 151.140.1.150/31 count
    1970 match any any 151.140.1.153 count
    1980 match any any 151.140.48.209 count
    1990 match any any 151.140.48.210/31 count
    2000 match any any 151.140.48.212 count
    2010 match any any 151.140.66.151 count
    2020 match any any 151.140.66.152/31 count
    2030 match any any 151.140.66.154 count
    2040 match any any 151.140.105.132/30 count
    2050 match any any 165.130.188.86 count
    2060 match any any 165.130.189.38 count
    2070 match any any 165.130.189.181 count
    2080 match any any 165.130.189.182 count
    2090 match any any 165.130.213.238/31 count
    2100 match any any 165.130.223.54 count
    2110 match any any 165.130.223.106 count
    2120 comment match access-group name QOSa_o365_sharepoint
    2130 match any any 104.146.128.0/255.255.128.0 count
    2140 match any any 13.107.136.0/255.255.252.0 count
    2150 match any any 150.171.40.0/255.255.252.0 count
    2160 match any any 40.108.128.0/255.255.128.0 count
    2170 match any any 52.104.0.0/255.252.0.0 count
class ip QOS-m-critical-af31
    10 match any any any dscp AF31 count
    20 comment ip access-list extended QOSa_tandem
    30 match any any 10.17.64.0/255.255.254.0 count
    40 match any any 10.16.92.0/255.255.254.0 count
    50 match any any 165.130.166.217/255.255.247.255 count
    60 match any any 165.130.230.217/255.255.247.255 count
    70 match any any 165.130.167.34/255.255.247.255 count
    80 match any any 165.130.230.226/255.255.247.255 count
    90 match any any 165.130.166.76/255.255.247.255 count
    100 match any any 165.130.230.76/255.255.247.255 count
    110 match any any 165.130.166.80/255.255.247.255 count
    120 match any any 165.130.166.75/255.255.247.255 count
    130 match any any 165.130.163.1/255.255.247.255 count
    140 match any any 165.130.166.132 count
    150 match any any 165.130.166.84/255.255.247.255 count
    160 match any any 165.130.100.3/255.255.247.255 count
    170 match any any 165.130.100.4/255.255.247.255 count
    180 match any any 172.26.84.31 count
    190 match any any 172.26.184.31 count
    200 match any any 165.130.230.10/255.255.247.255 count
    210 match any any 165.130.230.11/255.255.247.255 count
    220 match any any 165.130.230.12/255.255.247.255 count
    230 match any any 165.130.167.26/255.255.247.255 count
    240 match any any 165.130.167.27/255.255.247.255 count
    250 match any any 165.130.167.28/255.255.247.255 count
    260 match any any 172.26.84.35 count
    270 match any any 172.26.84.135 count
    280 match any any 172.26.184.35 count
    290 match any any 172.26.184.135 count
    300 match any any 172.26.84.36 count
    310 match any any 172.26.84.136 count
    320 match any any 172.26.184.36 count
    330 match any any 172.26.184.136 count
    340 match any any 172.26.84.37 count
    350 match any any 172.26.84.137 count
    360 match any any 172.26.184.37 count
    370 match any any 172.26.184.137 count
    380 comment access-group name QOSa_privatelabel
    390 match any any 169.195.178.54 count
    400 match any any 169.193.202.55 count
    410 match any any 169.193.202.54 count
    420 match any any 169.193.202.51 count
    430 match any any 169.193.157.207 count
    440 match any any 169.193.157.208 count
    450 match any any 169.193.157.243 count
    460 match any any 169.193.157.244 count
    470 match any any 169.185.178.54 count
    480 match any any 169.185.0.0/255.255.0.0 count
    490 match any any 169.186.0.0/255.254.0.0 count
    500 match any any 169.188.0.0/255.252.0.0 count
    510 match any any 169.192.0.0/255.252.0.0 count
class ip QOS-m-criticallopri-af33
    10 match any any any dscp AF33 count
    20 comment match access-group name QOSa_nac-ise
    30 match any any 151.140.101.218 count
    40 match any any 151.140.2.179 count
    50 match any any 151.140.105.218 count
    60 match any any 151.140.1.201 count
    70 match any any 151.140.1.156/31 count
    80 match any any 151.140.100.153 count
    90 match any any 151.140.100.162/31 count
    100 match any any 151.140.100.164 count
    110 match any any 151.140.102.104/31 count
    120 match any any 151.140.12.148 count
    130 match any any 151.140.14.15 count
    140 match any any 151.140.14.16/28 count
    150 match any any 151.140.3.183 count
    160 match any any 151.140.3.187 count
    170 match any any 151.140.3.188 count
    180 match any any 151.140.3.209 count
    190 match any any 151.140.3.211 count
    200 match any any 151.140.77.226 count
    210 match any any 151.140.78.132 count
    220 match any any 151.140.78.166 count
    230 match any any 151.140.78.172 count
    240 match any any 151.140.79.111 count
    250 match any any 151.140.79.131 count
    260 match any any 151.140.79.233 count
    270 match any any 151.140.79.234/31 count
    280 match any any 151.140.79.236/30 count
    290 match any any 151.140.79.240/31 count
    300 match any any 151.140.79.242 count
    310 match any any 151.140.79.52/31 count
    320 match any any 172.20.167.41 count
    330 match any any 151.140.107.1 count
    340 match any any 151.140.2.230 count
    350 comment access-group name QOSa_ssh_loop
    360 ignore any any any fragment count
    370 match tcp 10.125.0.0/16 eq 22 151.140.0.0/16 count
    380 match tcp 10.125.0.0/16 eq 22 165.130.0.0/16 count
    390 match tcp 10.121.0.0/16 eq 22 151.140.0.0/16 count
    400 match tcp 10.121.0.0/16 eq 22 165.130.0.0/16 count
    410 match tcp 10.122.0.0/16 eq 22 151.140.0.0/16 count
    420 match tcp 10.122.0.0/16 eq 22 165.130.0.0/16 count
    430 match tcp 10.125.0.0/16 eq 22 172.19.0.0/16 count
    440 match tcp 10.121.0.0/16 eq 22 172.19.0.0/16 count
    450 match tcp 10.122.0.0/16 eq 22 172.19.0.0/16 count
    460 match tcp 10.125.0.0/16 eq 22 207.11.21.0/24 count
    470 match tcp 10.121.0.0/16 eq 22 207.11.21.0/24 count
    480 match tcp 10.122.0.0/16 eq 22 207.11.21.0/24 count
    490 match tcp 10.125.0.0/16 eq 22 207.11.12.0/24 count
    500 match tcp 10.121.0.0/16 eq 22 207.11.12.0/24 count
    510 match tcp 10.122.0.0/16 eq 22 207.11.12.0/24 count
    520 match tcp 10.128.5.160/255.128.7.248 eq 22 151.140.0.0/16 count
    530 match tcp 10.128.5.160/255.128.7.248 eq 22 165.130.0.0/16 count
    540 match tcp 10.128.5.160/255.128.7.248 eq 22 207.11.21.0/24 count
    550 match tcp 10.128.5.160/255.128.7.248 eq 22 207.11.12.0/24 count
    560 match tcp 10.128.5.160/255.128.7.248 eq 22 172.19.0.0/16 count
    570 match tcp 10.125.0.0/16 eq 22 10.97.0.0/16
    580 match tcp 10.121.0.0/16 eq 22 10.97.0.0/16 
    590 match tcp 10.122.0.0/16 eq 22 10.97.0.0/16
    600 match tcp 10.128.5.160/255.128.7.248 eq 22 10.97.0.0/16
    610 match tcp 10.125.0.0/16 eq 22 10.98.0.0/16
    620 match tcp 10.121.0.0/16 eq 22 10.98.0.0/16 
    630 match tcp 10.122.0.0/16 eq 22 10.98.0.0/16
    640 match tcp 10.128.5.160/255.128.7.248 eq 22 10.98.0.0/16
    650 match tcp 10.125.0.0/16 eq 22 10.99.0.0/16
    670 match tcp 10.121.0.0/16 eq 22 10.99.0.0/16 
    680 match tcp 10.122.0.0/16 eq 22 10.99.0.0/16
    690 match tcp 10.128.5.160/255.128.7.248 eq 22 10.99.0.0/16
    740 match tcp 10.125.0.0/16 eq 22 10.101.0.0/16
    750 match tcp 10.121.0.0/16 eq 22 10.101.0.0/16 
    760 match tcp 10.122.0.0/16 eq 22 10.101.0.0/16
    780 match tcp 10.128.5.160/255.128.7.248 eq 22 10.101.0.0/16
    790 match tcp 10.125.0.0/16 eq 22 10.102.0.0/16
    800 match tcp 10.121.0.0/16 eq 22 10.102.0.0/16 
    810 match tcp 10.122.0.0/16 eq 22 10.102.0.0/16
    820 match tcp 10.128.5.160/255.128.7.248 eq 22 10.102.0.0/16
    830 match tcp 10.125.0.0/16 eq 22 10.103.0.0/16
    840 match tcp 10.121.0.0/16 eq 22 10.103.0.0/16 
    850 match tcp 10.122.0.0/16 eq 22 10.103.0.0/16
    860 match tcp 10.128.5.160/255.128.7.248 eq 22 10.103.0.0/16
class ip QOS-m-thdunk-af23
    10 comment match access-group name QOSa_thdunk
    20 match any any 165.130.0.0/16 count
    30 match any any 207.11.0.0/17 count
    40 match any any 10.0.0.0/8 count
    50 match any any 151.140.0.0/16 count
    60 match any any 192.168.0.0/16 count
    70 match any any 172.16.0.0/12 count
class ip QOS-m-video-af41
    10 comment ip access-list extended QOSa_webex
    20 match udp any any eq 9000 count
    30 match any any 62.109.192.0/18 count
    40 match any any 64.68.96.0/19 count
    50 match any any 66.114.160.0/20 count
    60 match any any 66.163.32.0/19 count
    70 match any any 69.26.160.0/19 count
    80 match any any 114.29.192.0/19 count
    90 match any any 150.253.128.0/17 count
    100 match any any 170.72.0.0/16 count
    110 match any any 170.133.128.0/18 count
    120 match any any 173.39.224.0/19 count
    130 match any any 173.243.0.0/20 count
    140 match any any 207.182.160.0/19 count
    150 match any any 209.197.192.0/19 count
    160 match any any 210.4.192.0/20 count
    170 match any any 216.151.128.0/19 count
    180 match any any 10.72.233.195 count 
    190 match any any 10.72.236.229 count 
    200 match any any 10.72.237.253 count 
    210 match any any 10.72.227.206 count 
class ip QOS-m-voice-ef
    5 match any any 10.16.46.254 count
    10 comment ip access-list extended QOSa_voip-media
    20 match udp 10.128.3.40/255.128.7.255 range 8000 48200 any count
    30 match udp 10.128.5.0/255.128.7.128 range 8000 48200 any count
    40 match udp 10.128.6.0/255.128.7.128 range 8000 48200 any count
    50 match udp 10.128.7.64/255.128.7.192 range 8000 48200 any count
    60 match udp any 10.128.3.40/255.128.7.255 range 8000 48200 count
    70 match udp any 10.128.5.0/255.128.7.128 range 8000 48200 count
    80 match udp any 10.128.6.0/255.128.7.128 range 8000 48200 count
    90 match udp any 10.128.7.64/255.128.7.192 range 8000 48200 count
    100 match udp any 10.33.20.0/24 range 8000 48200 count
    110 match udp any 10.23.20.0/24 range 8000 48200 count
    120 comment ip access-list extended QOSa_voip-signaling
    130 match udp any 10.33.20.0/24 eq 5060 count
    140 match udp any 10.23.20.0/24 eq 5060 count
    150 match tcp any 10.33.20.0/24 eq 5060 count
    160 match tcp any 10.23.20.0/24 eq 5060 count
    170 match tcp any 10.33.20.0/24 range 2000 2002 count
    180 match tcp any 10.23.20.0/24 range 2000 2002 count
class ip QOS-q-af1-background
    10 match any any any dscp CS1 count
    20 match any any any dscp AF11 count
    30 match any any any dscp AF12 count
    40 match any any any dscp AF13 count
class ip QOS-q-af1-bulkTCP
    10 comment match access-group name QOSa_monitorTCP
    20 match tcp any any eq 9997 count
    30 match any any 165.130.1.8 count
    40 match any any 165.130.1.16 count
    50 match any any 165.130.1.18 count
    60 match any any 165.130.1.19 count
    70 match any any 165.130.1.20 count
    80 match any any 165.130.1.21 count
    90 match tcp any any eq 162 count
    100 match tcp any eq 162 any count
    110 match tcp any any eq 1270 count
    111 match tcp any any eq 5723 count
    120 match tcp any eq 1270 any count
    121 match tcp any eq 5723 any count
class ip QOS-q-af1-bulkUDP
    10 match udp any any eq 514 count
class ip QOS-q-af1-crowdstrike
    10 match any any 13.56.121.58 count
    20 match any any 13.56.127.239 count
    30 match any any 13.57.54.63 count
    40 match any any 4.67.17.131 count
    50 match any any 50.18.194.39 count
    60 match any any 50.18.198.237 count
    70 match any any 52.52.117.52 count
    80 match any any 52.52.119.33 count
    90 match any any 52.52.149.168 count
    100 match any any 52.52.239.58 count
    110 match any any 52.53.77.89 count
    120 match any any 52.8.134.130 count
    130 match any any 52.8.141.1 count
    140 match any any 52.8.160.82 count
    150 match any any 52.8.172.89 count
    160 match any any 52.8.173.58 count
    170 match any any 52.8.19.75 count
    180 match any any 52.8.32.113 count
    190 match any any 52.8.45.162 count
    200 match any any 52.8.5.240 count
    210 match any any 52.8.54.244 count
    220 match any any 52.8.61.206 count
    230 match any any 52.9.104.148 count
    240 match any any 52.9.212.176 count
    250 match any any 52.9.77.209 count
    260 match any any 52.9.82.94 count
    270 match any any 52.9.87.98 count
    280 match any any 54.183.105.3 count
    290 match any any 54.183.120.141 count
    300 match any any 54.183.122.156 count
    310 match any any 54.183.135.80 count
    320 match any any 54.183.140.32 count
    330 match any any 54.183.142.105 count
    340 match any any 54.183.148.116 count
    350 match any any 54.183.148.43 count
    360 match any any 54.183.215.154 count
    370 match any any 54.183.234.42 count
    380 match any any 54.183.24.162 count
    390 match any any 54.183.252.86 count
    400 match any any 54.183.34.154 count
    410 match any any 54.183.39.68 count
    420 match any any 54.183.51.31 count
    430 match any any 54.183.51.69 count
    440 match any any 54.183.52.221 count
    450 match any any 54.193.117.199 count
    460 match any any 54.193.27.226 count
    470 match any any 54.193.29.47 count
    480 match any any 54.193.67.98 count
    490 match any any 54.193.86.245 count
    500 match any any 54.193.87.57 count
    510 match any any 54.193.90.171 count
    520 match any any 54.193.93.19 count
    530 match any any 54.215.131.232 count
    540 match any any 54.215.154.80 count
    550 match any any 54.215.169.199 count
    560 match any any 54.215.169.38 count
    570 match any any 54.215.170.42 count
    580 match any any 54.215.176.108 count
    590 match any any 54.215.183.157 count
    600 match any any 54.215.226.55 count
    610 match any any 54.219.112.243 count
    620 match any any 54.219.115.12 count
    630 match any any 54.219.137.54 count
    640 match any any 54.219.140.50 count
    650 match any any 54.219.141.250 count
    660 match any any 54.219.145.181 count
    670 match any any 54.219.147.253 count
    680 match any any 54.219.148.161 count
    690 match any any 54.219.149.89 count
    700 match any any 54.219.149.92 count
    710 match any any 54.219.151.1 count
    720 match any any 54.219.151.27 count
    730 match any any 54.219.153.248 count
    740 match any any 54.219.158.53 count
    750 match any any 54.219.159.84 count
    760 match any any 54.219.161.141 count
    770 match any any 54.219.179.25 count
    780 match any any 54.241.138.180 count
    790 match any any 54.241.146.67 count
    800 match any any 54.241.148.127 count
    810 match any any 54.241.150.134 count
    820 match any any 54.241.161.242 count
    830 match any any 54.241.161.60 count
    840 match any any 54.241.162.180 count
    850 match any any 54.241.162.64 count
    860 match any any 54.241.164.212 count
    870 match any any 54.241.175.140 count
    880 match any any 54.241.175.52 count
    890 match any any 54.241.179.52 count
    900 match any any 54.241.181.242 count
    910 match any any 54.241.181.78 count
    920 match any any 54.241.182.78 count
    930 match any any 54.241.183.151 count
    940 match any any 54.241.183.229 count
    950 match any any 54.241.183.232 count
    960 match any any 54.241.184.161 count
    970 match any any 54.241.185.201 count
    980 match any any 54.241.186.124 count
    990 match any any 54.241.197.58 count
    1000 match any any 54.67.105.202 count
    1010 match any any 54.67.108.17 count
    1020 match any any 54.67.114.188 count
    1030 match any any 54.67.119.89 count
    1040 match any any 54.67.122.238 count
    1050 match any any 54.67.123.150 count
    1060 match any any 54.67.123.234 count
    1070 match any any 54.67.24.156 count
    1080 match any any 54.67.26.184 count
    1090 match any any 54.67.33.233 count
    1100 match any any 54.67.4.108 count
    1110 match any any 54.67.41.192 count
    1120 match any any 54.67.48.56 count
    1130 match any any 54.67.5.136 count
    1140 match any any 54.67.51.32 count
    1150 match any any 54.67.54.116 count
    1160 match any any 54.67.6.201 count
    1170 match any any 54.67.68.88 count
    1180 match any any 54.67.72.218 count
    1190 match any any 54.67.78.134 count
    1200 match any any 54.67.92.206 count
    1210 match any any 54.67.96.255 count
    1220 match any any 54.67.99.247 count
    1230 match any any 52.43.73.53 count
    1240 match any any 35.164.23.230 count
class ip QOS-q-af2-business
    10 match any any any dscp CS2 count
    20 match any any any dscp AF21 count
    30 match any any any dscp AF22 count
class ip QOS-q-af23-thdunknown
    10 match any any any dscp AF23 count
    20 comment match access-group name QOSa_thdunk
    30 match any any 165.130.0.0/16 count
    40 match any any 207.11.0.0/17 count
    50 match any any 10.128.0.0/8 count
    60 match any any 151.140.0.0/16 count
    70 match any any 151.140.0.0/16 count
    80 match any any 192.168.0.0/16 count
    90 match any any 172.16.0.0/12 count
class ip QOS-q-af3-critical
    10 match any any any dscp CS3 count
    20 match any any any dscp AF31 count
    30 match any any any dscp AF32 count
    40 match any any any dscp AF33 count
class ip QOS-q-af33-critlo
    10 comment match access-group name QOSa_ssh_loop
    20 ignore any any any fragment count
    30 match tcp 10.125.0.0/16 eq 22 151.140.0.0/16 count
    40 match tcp 10.125.0.0/16 eq 22 165.130.0.0/16 count
    50 match tcp 10.121.0.0/16 eq 22 151.140.0.0/16 count
    60 match tcp 10.121.0.0/16 eq 22 165.130.0.0/16 count
    70 match tcp 10.122.0.0/16 eq 22 151.140.0.0/16 count
    80 match tcp 10.122.0.0/16 eq 22 165.130.0.0/16 count
    90 match tcp 10.125.0.0/16 eq 22 172.19.0.0/16 count
    100 match tcp 10.121.0.0/16 eq 22 172.19.0.0/16 count
    110 match tcp 10.122.0.0/16 eq 22 172.19.0.0/16 count
    120 match tcp 10.125.0.0/16 eq 22 207.11.21.0/24 count
    130 match tcp 10.121.0.0/16 eq 22 207.11.21.0/24 count
    140 match tcp 10.122.0.0/16 eq 22 207.11.21.0/24 count
    150 match tcp 10.125.0.0/16 eq 22 207.11.12.0/24 count
    160 match tcp 10.121.0.0/16 eq 22 207.11.12.0/24 count
    170 match tcp 10.122.0.0/16 eq 22 207.11.12.0/24 count
    180 match tcp 10.128.5.160/255.128.7.248 eq 22 151.140.0.0/16 count
    190 match tcp 10.128.5.160/255.128.7.248 eq 22 165.130.0.0/16 count
    200 match tcp 10.128.5.160/255.128.7.248 eq 22 207.11.21.0/24 count
    210 match tcp 10.128.5.160/255.128.7.248 eq 22 207.11.12.0/24 count
    220 match tcp 10.128.5.160/255.128.7.248 eq 22 172.19.0.0/16 count
    230 comment match access-group name QOSa_nac-ise
    240 match any any 151.140.101.218 count
    250 match any any 151.140.2.179 count
    260 match any any 151.140.105.218 count
    270 match any any 151.140.1.201 count
    280 match any any 151.140.1.156/31 count
    290 match any any 151.140.100.153 count
    300 match any any 151.140.100.162/31 count
    310 match any any 151.140.100.164 count
    320 match any any 151.140.102.104/31 count
    330 match any any 151.140.12.148 count
    340 match any any 151.140.14.15 count
    350 match any any 151.140.14.16/28 count
    360 match any any 151.140.3.183 count
    370 match any any 151.140.3.187 count
    380 match any any 151.140.3.188 count
    390 match any any 151.140.3.209 count
    400 match any any 151.140.3.211 count
    410 match any any 151.140.77.226 count
    420 match any any 151.140.78.132 count
    430 match any any 151.140.78.166 count
    440 match any any 151.140.78.172 count
    450 match any any 151.140.79.111 count
    460 match any any 151.140.79.131 count
    470 match any any 151.140.79.233 count
    480 match any any 151.140.79.234/31 count
    490 match any any 151.140.79.236/30 count
    500 match any any 151.140.79.240/31 count
    510 match any any 151.140.79.242 count
    520 match any any 151.140.79.52/31 count
    530 match any any 172.20.167.41 count
    540 match any any 151.140.107.1 count
    550 match any any 151.140.2.230 count
    560 comment match access-group name QOSa_ssh_loop-GlobalProtectVPN
    570 match tcp 10.125.0.0/16 eq 22 10.97.0.0/16
    580 match tcp 10.121.0.0/16 eq 22 10.97.0.0/16 
    590 match tcp 10.122.0.0/16 eq 22 10.97.0.0/16
    600 match tcp 10.128.5.160/255.128.7.248 eq 22 10.97.0.0/16
    610 match tcp 10.125.0.0/16 eq 22 10.98.0.0/16
    620 match tcp 10.121.0.0/16 eq 22 10.98.0.0/16 
    630 match tcp 10.122.0.0/16 eq 22 10.98.0.0/16
    640 match tcp 10.128.5.160/255.128.7.248 eq 22 10.98.0.0/16
    650 match tcp 10.125.0.0/16 eq 22 10.99.0.0/16
    670 match tcp 10.121.0.0/16 eq 22 10.99.0.0/16 
    680 match tcp 10.122.0.0/16 eq 22 10.99.0.0/16
    690 match tcp 10.128.5.160/255.128.7.248 eq 22 10.99.0.0/16
    740 match tcp 10.125.0.0/16 eq 22 10.101.0.0/16
    750 match tcp 10.121.0.0/16 eq 22 10.101.0.0/16 
    760 match tcp 10.122.0.0/16 eq 22 10.101.0.0/16
    780 match tcp 10.128.5.160/255.128.7.248 eq 22 10.101.0.0/16
    790 match tcp 10.125.0.0/16 eq 22 10.102.0.0/16
    800 match tcp 10.121.0.0/16 eq 22 10.102.0.0/16 
    810 match tcp 10.122.0.0/16 eq 22 10.102.0.0/16
    820 match tcp 10.128.5.160/255.128.7.248 eq 22 10.102.0.0/16
    830 match tcp 10.125.0.0/16 eq 22 10.103.0.0/16
    840 match tcp 10.121.0.0/16 eq 22 10.103.0.0/16 
    850 match tcp 10.122.0.0/16 eq 22 10.103.0.0/16
    860 match tcp 10.128.5.160/255.128.7.248 eq 22 10.103.0.0/16
class ip QOS-q-af4-video
    10 match any any any dscp CS4 count
    20 match any any any dscp AF41 count
    30 match any any any dscp AF42 count
    40 match any any any dscp AF43 count
class ip QOS-q-cs0-sdwan-inet-traffic
    10 comment match access-group name QOSa_all_sdwan_inet_tunnel_traffic
    20 match any any 207.11.17.0/25 count
    30 match any any 207.11.48.0/25 count
    40 match any any 207.11.71.32/28 count
    50 match any any 207.11.72.32/28 count
    60 match any any 207.11.73.32/28 count
    70 match any any 207.11.74.32/28 count
    80 match any any 207.11.75.32/28 count
class ip QOS-q-cs6-routing
    20 match tcp any any eq 179 count
    30 match tcp any eq 179 any count
class ip QOS-q-ef-voice
    10 match any any any dscp EF count
class ip QOS-q-sdwan-control-traffic
    10 match any any any dscp CS6 count
%if is_vantage_qos=Y% 
class ip QOS-m-vantage-af32
    10 match any 10.128.6.128/255.128.7.128 10.47.3.1 count
%endif%
class ip QOSa_monitorTCP
class ip default
    10 match any any any
class ip non-client-nrt-class
!-----QoS Policy--------
policy ESX_TRUNKS
	10 class ip SCCM_VLAN2 action cir kbps 750000 cbs 750000 exceed drop action dscp cs1
	20 class ip SCCM_OTHER action cir kbps 150000 cbs 150000 exceed drop action dscp cs1
policy QOS-P-marker
    10 class ip QOS-m-voice-ef action local-priority 5 action dscp EF
    20 class ip QOS-m-video-af41 action local-priority 4 action dscp AF41
    30 class ip QOS-m-critical-af31 action local-priority 3 action dscp AF31
    40 class ip QOS-m-criticallopri-af33 action local-priority 3 action dscp AF33
%if is_vantage_qos=Y%
    45 class ip QOS-m-vantage-af32 action local-priority 3 action dscp AF32
%endif%
    50 class ip QOS-m-business-af21 action local-priority 2 action dscp AF21
    60 class ip QOS-m-buslopri-af22 action local-priority 2 action dscp AF22
    70 class ip QOS-m-bulk-af11 action local-priority 0 action dscp AF11
    80 class ip QOS-m-thdunk-af23 action local-priority 2 action dscp AF23
    90 class ip default action local-priority 1 action dscp CS0
policy QOS-P-mpls
    10 class ip QOS-q-cs6-routing action dscp CS6
    20 class ip QOS-q-ef-voice
    30 class ip QOS-q-af4-video
    40 class ip QOS-q-af3-critical
    50 class ip QOS-q-af33-critlo action dscp AF33
    60 class ip QOS-q-af2-business
    70 class ip QOS-q-af1-bulkUDP action dscp AF11
    80 class ip QOS-q-af1-bulkTCP action dscp AF11
    90 class ip QOS-q-af1-crowdstrike
    100 class ip QOS-q-af1-background
    110 class ip QOS-q-af23-thdunknown
    120 class ip default
policy QOS-P-sdwan-mpls
    10 class ip QOS-q-cs6-routing action dscp CS6
    20 class ip QOS-q-ef-voice
    30 class ip QOS-q-af4-video
    40 class ip QOS-q-af3-critical
    50 class ip QOS-q-af33-critlo action dscp AF33
    60 class ip QOS-q-af2-business
    70 class ip QOS-q-sdwan-control-traffic action dscp AF21
    80 class ip QOS-q-af1-bulkUDP action dscp AF11
    90 class ip QOS-q-af1-bulkTCP action dscp AF11
    100 class ip QOS-q-af1-background
    110 class ip QOS-q-af23-thdunknown
    120 class ip default
policy QOS-P-vsat
    10 class ip QOS-q-cs6-routing action dscp CS6
    20 class ip QOS-q-ef-voice
    30 class ip QOS-q-af3-critical
    40 class ip QOS-q-af33-critlo action dscp AF33
    50 class ip QOS-q-af2-business
    60 class ip QOS-q-af1-bulkUDP action dscp AF11
    70 class ip QOS-q-af1-bulkTCP action dscp AF11
    80 class ip QOS-q-af1-background
    90 class ip QOS-q-af23-thdunknown
    100 class ip default
policy aruba_sdwan_mis_parent_7meg_rev5
    10 class ip QOS-q-cs0-sdwan-inet-traffic action dscp CS0
!
dhcpv4-snooping
    no dhcpv4-snooping option 82
    dhcpv4-snooping allow-overwrite-binding
vlan 1
vlan 2
    name STORE-NETWORK-VLAN
    dhcpv4-snooping
    arp inspection
    ip igmp snooping enable
vlan 10
    name NAC-STAGING-VLAN
    ip igmp snooping enable
vlan 12
    name CORPORATE-WIFI-VLAN
    dhcpv4-snooping
    ip igmp snooping enable
vlan 13
    name VENDOR-DEVICES-WIFI
    dhcpv4-snooping
    arp inspection
vlan 14
    name RESERVED
    ip igmp snooping enable
vlan 15
    name IOT-DEVICES-WIFI
    dhcpv4-snooping
    arp inspection
vlan 19
    name GUEST-WIFI-PASSPOINT
    dhcpv4-snooping
vlan 20
    name RESERVED
    dhcpv4-snooping
    arp inspection
vlan 25
    name RESERVED
    dhcpv4-snooping
    arp inspection
vlan 26
    name DEMOPOOL1-DEMOPOOL2
    dhcpv4-snooping
    arp inspection
vlan 30
    name POS-VLAN
    dhcpv4-snooping
    arp inspection
vlan 44
    name IP-CAMERA-VLAN
    dhcpv4-snooping
    arp inspection
    ip igmp snooping enable
vlan 50
    name MPLS
vlan 51
    name MIS
vlan 77
    name RESERVED
    dhcpv4-snooping
    arp inspection
!!! vlan 80 is created for VSAT T1 no Additional Vlan
%if is_t1%
%if is_t1=Y%
! No config Needed
%else%
vlan 80
    name VSAT
%endif%
%else%
vlan 80
    name VSAT
%endif%
!
vlan 90    
    name SERVER-vSAN
    dhcpv4-snooping
    arp inspection
vlan 105 
    name SERVER-PCE-Maintenance
    dhcpv4-snooping
    arp inspection
vlan 150
   name SERVER-Migration-vMotion
   dhcpv4-snooping
   arp inspection
vlan 190
    name SDW-PUB-WIFI-VPN30
vlan 260
    name SDW-IOT-VPN20
vlan 555
    name VOICE-VLAN
    voice
    arp inspection
vlan 767
    name SDW-MIS-VPN0
vlan 802
    name THD-MGMT-VLAN
vlan 815
    name VERINT
vlan 997
    name SDW-BB-VPN0
vlan 998
    name LTE_Transport
vlan 999
    name BGP-INTERCONNECT
    ip igmp snooping enable
vlan 1379
    name MPLS-Transport
vlan 4093
    name RESERVED
    dhcpv4-snooping
    arp inspection
no spanning-tree
!spanning-tree priority 7
interface mgmt
    no shutdown
    ip dhcp
qos queue-profile home-depot
    map queue 0 local-priority 0
    map queue 1 local-priority 1
    map queue 2 local-priority 2
    map queue 3 local-priority 3
    map queue 4 local-priority 4
    map queue 5 local-priority 7
    map queue 6 local-priority 6
    map queue 7 local-priority 5
qos queue-profile test
qos schedule-profile QOS-P-mpls-scheduler
    dwrr queue 0 weight 5
    dwrr queue 1 weight 9
    dwrr queue 2 weight 41
    dwrr queue 3 weight 21
    dwrr queue 4 weight 20
    dwrr queue 5 weight 1
    dwrr queue 6 weight 3
    strict queue 7 max-bandwidth 768 kbps
qos schedule-profile QOS-P-sdwan-mpls-scheduler
    dwrr queue 0 weight 5
    dwrr queue 1 weight 9
    dwrr queue 2 weight 40
    dwrr queue 3 weight 21
    dwrr queue 4 weight 20
    dwrr queue 5 weight 1
    dwrr queue 6 weight 3
    strict queue 7
qos schedule-profile QOS-P-vsat-scheduler
    dwrr queue 0 weight 5
    dwrr queue 1 weight 9
    dwrr queue 2 weight 44
    dwrr queue 3 weight 37
    dwrr queue 4 weight 1
    dwrr queue 5 weight 1
    dwrr queue 6 weight 3
    strict queue 7 max-bandwidth 115 kbps
qos schedule-profile test
apply qos queue-profile home-depot schedule-profile factory-default
qos dscp-map 40 local-priority 7 color green
qos dscp-map 41 local-priority 7 color green
qos dscp-map 42 local-priority 7 color green
qos dscp-map 43 local-priority 7 color green
qos dscp-map 44 local-priority 7 color green
qos dscp-map 45 local-priority 7 color green
qos dscp-map 47 local-priority 7 color green
!
interface lag 11
%if vlan_51_ip=none%
    shutdown
%else%
    no shutdown
%endif%
! set is_10mb=Y for 10MB circuit
    %if is_10mb=Y%
       qos shape 6600 kbps
    %endif%
! set is_10mb=20 for 20MB circuit
    %if is_10mb=20%
       qos shape 13200 kbps
    %endif%
! set is_10mb=50 for 50MB circuit
    %if is_10mb=50%
        qos shape 38000 kbps
    %endif%
! set is_10mb=N for 100MB circuit
    %if is_10mb=N%
        qos shape 76000 kbps
    %endif%
! set is_10mb=cust for custom speed
   %if is_10mb=cust%
        qos shape %cust_mis% kbps
    %endif%   
    description MIS-QOS-Link
    no routing
    vlan access 51
    lacp mode active
    lacp rate fast
!
interface lag 12
    no shutdown
    apply qos schedule-profile QOS-P-mpls-scheduler
%if vlan_51_ip=none%
! This is when MIS is NOT present, Full circuit speed is assigned to MPLS
! set is_10mb=Y for 10MB circuit
    %if is_10mb=Y%
        qos shape 9800 kbps
    %endif%
! set is_10mb=20 for 20MB circuit
    %if is_10mb=20%
        qos shape 19800 kbps
    %endif%
! set is_10mb=50 for 50MB circuit
    %if is_10mb=50%
        qos shape 49000 kbps
    %endif%
! set is_10mb=N for 100MB circuit  
    %if is_10mb=N% 
        qos shape 98000 kbps
    %endif%
! set is_10mb=cust for custom speed
    %if is_10mb=cust%
        qos shape %cust_mpls_all% kbps
    %endif% 
%else%
! This is when MIS is present, Circuit speed is divided with MIS-80 MPLS-20 percent rule for fixed speed  
! set is_10mb=Y for 10MB circuit
    %if is_10mb=Y%
        qos shape 2900 kbps
    %endif%
! set is_10mb=20 for 20MB circuit
    %if is_10mb=20%
        qos shape 5800 kbps
    %endif%
! set is_10mb=50 for 50MB circuit
    %if is_10mb=50%
        qos shape 9500 kbps
    %endif%
! set is_10mb=N for 100MB circuit
    %if is_10mb=N%
        qos shape 19000 kbps
    %endif%
! set is_10mb=cust for custom speed
    %if is_10mb=cust%
        qos shape %cust_mpls% kbps
    %endif%
%endif%
    description MPLS-QOS-Link
    no routing
    vlan access 50
    lacp mode active
    lacp rate fast
interface lag 13
    shutdown
    no routing
    loop-protect
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,190,260,802,815
    lacp mode active
interface lag 14
    shutdown
    no routing
    loop-protect
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,190,260,802,815
    lacp mode active
interface lag 15
    shutdown
    no routing
    loop-protect
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,190,260,802,815
    lacp mode active
interface lag 16
%if is_9idf%
%if is_9idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFI
    no routing
    loop-protect
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
interface lag 17
%if is_8idf%
%if is_8idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFH
    no routing
    loop-protect
    arp inspection trust
	dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
interface lag 18
%if is_7idf%
%if is_7idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFG
    no routing
    loop-protect
    arp inspection trust
	dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
interface lag 19
    no shutdown
    description IDFF
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
    lacp rate fast
interface lag 20
    no shutdown
    description IDFE
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
    lacp rate fast
interface lag 21
    no shutdown
    description IDFD
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
    lacp rate fast
interface lag 22
    no shutdown
    description IDFC
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
    lacp rate fast
interface lag 23
    no shutdown
    description IDFB
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815
    lacp mode active
    lacp rate fast
interface lag 24
    no shutdown
    description IDFA
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,555,802,815,999,997
%else%
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,80,190,260,555,802,815,997
%endif%
%else%
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,80,190,260,555,802,815,997
%endif%
    lacp mode active
    lacp rate fast
interface lag 27
    shutdown
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,802,815
    lacp mode active
    lacp rate fast
interface lag 28
    shutdown
    no routing
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,77,190,260,802,815
    lacp mode active
    lacp rate fast
interface 1/1/1
    no shutdown
    description VG-320
    loop-protect
	loop-protect vlan 2,90,555,802,998,999
    vlan trunk native 1
    vlan trunk allowed 2,90,555,802,998,999
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/2
    shutdown
%if is_legacyvg=Y%
    no shutdown
%endif%
    description VG-4351
    no routing
    vlan trunk native 1
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,555,802
    spanning-tree bpdu-filter
    loop-protect
    loop-protect vlan 1-2,10,12-15,19-20,25-26,30,44,555,802
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/3
    no shutdown
    description Cisco_1101
    no routing
    vlan trunk native 1
    vlan trunk allowed 1-2,90,802,997,998,999
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/4
    no shutdown
    description Store_Host_B_vnic8-orange
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/5
    no shutdown
    description Store_Host_B_vnic9-orange
    no routing
    vlan trunk native 2
    vlan trunk allowed 10,555
    loop-protect
	loop-protect vlan 10,555
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/6
    no shutdown
    description Store_Host_A_vnic8-orange
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/7
    no shutdown
    description Store_Host_A_vnic9-orange
    no routing
    vlan trunk native 2
    vlan trunk allowed 10,555
    loop-protect
	loop-protect vlan 10,555
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/8
    no shutdown
    qos trust dscp
    description Store_Host_A_vnic5
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
    apply policy ESX_TRUNKS in
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/9
    no shutdown
    qos trust dscp
    description Store_Host_B_vnic7
    no routing
    vlan trunk native 2
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
    apply policy ESX_TRUNKS in
    arp inspection trust
    dhcpv4-snooping trust
interface 1/1/10
    no shutdown
    description Broadband
    no routing
    vlan access 997    
interface 1/1/11
%if vlan_51_ip=none%
    shutdown
%else%
    no shutdown
%endif%
    description MIS-QOS-Link
    lag 11
interface 1/1/12
    no shutdown
    description MPLS-QOS-Link
    lag 12
interface 1/1/13
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    description SRV1_VNIC0_DL325_GEN11
    no shutdown 
    mtu 9000
    no routing
    apply policy ESX_TRUNKS in
    qos trust dscp
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 2
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    shutdown
    lag 13
%endif%
%else%
   shutdown
   lag 13
%endif%
interface 1/1/14
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    description SRV2_VNIC0_DL325_GEN11
    no shutdown 
    mtu 9000
    no routing
    apply policy ESX_TRUNKS in
    qos trust dscp
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 2
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    shutdown
    lag 14
%endif%
%else%
   shutdown
   lag 14
%endif%
interface 1/1/15
    no shutdown
    description VLAN999 Mirror Port
    no routing
    vlan trunk native 999
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 50,999
%else%
    vlan trunk allowed 50,80,999
%endif%
%else%
    vlan trunk allowed 50,80,999
%endif%
!
interface 1/1/16
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    no shutdown
    description SRV1_EHOP_DL325_GEN11
    no routing
    vlan trunk native 2	
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
    arp inspection trust
    dhcpv4-snooping trust
%else%
    shutdown
    lag 16
%endif%
%else%
   shutdown
   lag 16
%endif%
interface 1/1/17
%if is_8idf%
%if is_8idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFH
    lag 17
interface 1/1/18
%if is_7idf%
%if is_7idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFG
    lag 18
interface 1/1/19
    no shutdown
    description IDFF
    lag 19
interface 1/1/20
    no shutdown
    description IDFE
    lag 20
interface 1/1/21
    no shutdown
    description IDFD
    lag 21
interface 1/1/22
    no shutdown
    description IDFC
    lag 22
interface 1/1/23
    no shutdown
    description IDFB
    lag 23
interface 1/1/24
    no shutdown
    description IDFA
    lag 24
interface 1/1/25
    no shutdown
interface 1/1/26
    no shutdown
interface 1/1/27
    shutdown
    lag 27
interface 1/1/28
    shutdown
    lag 28
interface 2/1/1
    shutdown  
%if is_vgbuport=Y% 
    no shutdown 
%endif% 
    description VG-320-BACKUP_PORT 
    loop-protect  
    loop-protect vlan 2,90,555,802,998,999  
    vlan trunk native 1  
    vlan trunk allowed 2,90,555,802,998,999  
    arp inspection trust  
    dhcpv4-snooping trust  
interface 2/1/2
    shutdown 
%if is_legacyvgbuport=Y% 
    no shutdown 
%endif% 
    description VG-4351-BACKUP_PORT  
    no routing  
    vlan trunk native 1  
    vlan trunk allowed 1-2,10,12-15,19-20,25-26,30,44,555,802  
    spanning-tree bpdu-filter  
    loop-protect  
    loop-protect vlan 1-2,10,12-15,19-20,25-26,30,44,555,802  
    arp inspection trust  
    dhcpv4-snooping trust
interface 2/1/3
    no shutdown
    description Cisco_1101_Reserved
    no routing
    vlan trunk native 1
    vlan trunk allowed 1,2,90,802,997,998,999
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/4
    no shutdown
    description Store_Host_B_vnic0-black
    no routing
    vlan trunk native 2
    vlan trunk allowed 2,10,12-15,25,30,44,555,802
    loop-protect
	loop-protect vlan 2,10,12-15,25,30,44,555,802
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/5
    no shutdown
    description Store_Host_B_vnic1-black
    no routing
    vlan trunk native 2
    vlan trunk allowed 10,555
    loop-protect
	loop-protect vlan 10,555
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/6
    no shutdown
    description Store_Host_A_vnic0-black
    no routing
    vlan trunk native 2
    vlan trunk allowed 2,10,12-15,25,30,44,555,802
    loop-protect
	loop-protect vlan 2,10,12-15,25,30,44,555,802
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/7
    no shutdown
    description Store_Host_A_vnic1-black
    no routing
    vlan trunk native 2
    vlan trunk allowed 10,555
    loop-protect
	loop-protect vlan 10,555
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/8
    no shutdown
    qos trust dscp
    description Store_Host_B_vnic5
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
    apply policy ESX_TRUNKS in
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/9
    no shutdown
    qos trust dscp
    description Store_Host_A_vnic7
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
%endif%
    apply policy ESX_TRUNKS in
    arp inspection trust
    dhcpv4-snooping trust
interface 2/1/10
    no shutdown
    description Broadband-Reserved
    no routing
    vlan access 997    
interface 2/1/11
%if vlan_51_ip=none%
    shutdown
%else%
    no shutdown
%endif%
    description MIS-QOS-Link
    lag 11
interface 2/1/12
    no shutdown
    description MPLS-QOS-Link
    lag 12
interface 2/1/13
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    description SRV1_VNIC1_DL325_GEN1
    no shutdown 
    mtu 9000
    no routing
    apply policy ESX_TRUNKS in
    qos trust dscp
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 2
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    shutdown
    lag 13
%endif%
%else%
   shutdown
   lag 13
%endif%
!
interface 2/1/14
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    description SRV2_VNIC1_DL325_GEN11
    no shutdown 
    mtu 9000
    no routing
    apply policy ESX_TRUNKS in
    qos trust dscp
    arp inspection trust
    dhcpv4-snooping trust
    vlan trunk native 2
%if is_t1%
%if is_t1=Y%
    vlan trunk allowed 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,90,105,150,190,260,555,767,802,815,997-999,1379
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,105,150,190,260,555,767,802,815,997-999,1379
%endif%
%else%
    shutdown
    lag 14
%endif%
%else%
   shutdown
   lag 14
%endif%
interface 2/1/15
    shutdown
    lag 15
interface 2/1/16
%if is_ecaas_srvr%
%if is_ecaas_srvr=Y%
    no shutdown
    description SRV2_EHOP_DL325_GEN11
    no routing
    vlan trunk native 2
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
    arp inspection trust
    dhcpv4-snooping trust
%else%
    shutdown
    lag 16
%endif%
%else%
   shutdown
   lag 16
%endif%
interface 2/1/17
%if is_8idf%
%if is_8idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFH
    lag 17
interface 2/1/18
%if is_7idf%
%if is_7idf=Y%
    no shutdown
%else%
    shutdown
%endif%
%else%
    shutdown
%endif%
    description IDFG
    lag 18
interface 2/1/19
    no shutdown
    description IDFF
    lag 19
interface 2/1/20
    no shutdown
    description IDFE
    lag 20
interface 2/1/21
    no shutdown
    description IDFD
    lag 21
interface 2/1/22
    no shutdown
    description IDFC
    lag 22
interface 2/1/23
    no shutdown
    description IDFB
    lag 23
interface 2/1/24
    no shutdown
    description IDFA
    lag 24
interface 2/1/25
    no shutdown
interface 2/1/26
    no shutdown
interface 2/1/27
    shutdown
    lag 27
interface 2/1/28
    shutdown
    lag 28
!
!!!!!! START, Logic for NEW server POC interface Config   !!!!!!!!!
!
%if is_nsrvr_poc=Y%
default interface 1/1/2,1/1/14,1/1/17,1/1/27,2/1/2,2/1/14,2/1/17,2/1/27
interface 1/1/2,1/1/14,1/1/17,1/1/27,2/1/2,2/1/14,2/1/17,2/1/27
    no shutdown 
    mtu 9000
    no routing
    vlan trunk native 2
    vlan trunk allowed 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
    arp inspection trust
    dhcpv4-snooping trust
    loop-protect
    loop-protect vlan 2,10,12-15,25-26,30,44,80,90,150,190,260,555,767,802,815,997-999,1379
!
interface 1/1/2
    description Store_Host_1_vnic0
interface 1/1/14
    description Store_Host_2_vnic0
interface 1/1/17
    description Store_Host_3_vnic0
interface 1/1/27
    description Store_Host_4_vnic0
interface 2/1/2
    description Store_Host_1_vnic1
interface 2/1/14
    description Store_Host_2_vnic1
interface 2/1/17
    description Store_Host_3_vnic1
interface 2/1/27
    description Store_Host_4_vnic1
!
default interface 1/1/13,1/1/16,1/1/18,1/1/28,2/1/13,2/1/16,2/1/18,2/1/28
interface 1/1/13,1/1/16,1/1/18,1/1/28,2/1/13,2/1/16,2/1/18,2/1/28
    no shutdown 
    mtu 9000
    no routing
    vlan trunk native 1
    vlan trunk allowed 90,150
    arp inspection trust
    dhcpv4-snooping trust
    loop-protect
interface 1/1/13
    description Store_Host_1_vmnic2
interface 1/1/16
    description Store_Host_2_vmnic2
interface 1/1/18
    description Store_Host_3_vmnic2
interface 1/1/28
    description Store_Host_4_vmnic2
interface 2/1/13
    description Store_Host_1_vmnic3
interface 2/1/16
    description Store_Host_2_vmnic3
interface 2/1/18
    description Store_Host_3_vmnic3
interface 2/1/28
    description Store_Host_4_vmnic3
!
%endif%
!
!!!!!! END Logic for NEW server POC interface Config !!!!!!!!!
!
! Start of template Logic to shutdown exiting Server Interface after ECaaS server UP & running !!!!!
!
%if is_ecaas_live=Y%
Interface 1/1/4,1/1/5,1/1/6,1/1/7,1/1/8,1/1/9
    shutdown
Interface 2/1/4,2/1/5,2/1/6,2/1/7,2/1/8,2/1/9
    shutdown
%endif%
!
! End template logic to shutdown exiting Server Interface after ECaaS server UP & running !!!!!
!
! !!!! START Armis POC mirror 2 Destination Interface config !!!!!
!
%if is_armis_poc=Y%
default interface 2/1/15
interface 2/1/15
    description Armis POC mirror 2 destination
    no shutdown 
    no routing
    arp inspection trust
    dhcpv4-snooping trust
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,90,105,150,190,555,802,815,999
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%else%
    vlan trunk allowed 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
    loop-protect
    loop-protect vlan 2,10,12,14,26,30,44,50-51,80,90,105,150,190,555,802,815,999
%endif%
%endif%
!
! !!!! END Armis POC mirror 2 Destination Interface config !!!!!
!
!!!!!!!!!!!!!!!!!!!!!!!!PA FIREWALL MIRROR SESSION POC!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%if is_paloalto_poc=Y%
default interface 1/1/15
interface 1/1/15
    description PaloAlto POC mirror 2 destination
    no shutdown 
    no routing
    arp inspection trust
    dhcpv4-snooping trust
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 50,999,19,2,51,190,12,815,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%else%
    vlan trunk allowed 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%endif%
%else%
    vlan trunk allowed 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%endif%
default interface 2/1/15
interface 2/1/15
    description PaloAlto POC mirror 2 destination
    shutdown 
    no routing
    arp inspection trust
    dhcpv4-snooping trust
%if is_t1% 
%if is_t1=Y%
    vlan trunk allowed 50,999,19,2,51,190,12,815,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%else%
    vlan trunk allowed 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%endif%
%else%
    vlan trunk allowed 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
    loop-protect
    loop-protect vlan 50,999,19,2,51,190,12,815,80,44,14,30,802,26,555,50,150,105,10,90,767,997,1379
%endif%
!
%endif%
!
!!!!!!!!!!!!!!!!!!!!!!!!END PA FIREWALL MIRROR SESSION POC!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
interface loopback 0
    ip address %loopback_0_ip%/32
interface loopback 6
    ip address %loopback_6_ip%/32
interface vlan 1
    no ip dhcp
interface vlan 2
    no shutdown
    description ** Store LAN **
    ip address %vlan_2_ip%%vlan_2_mask%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
%if is_ecaas_srvr=Y%
    ip mtu 9000
%endif%
interface vlan 10
    no shutdown
    ip address %vlan_10_ip%%vlan_10_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_2%
    ip helper-address %ip_helper_3%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-STAGING-VLAN-IN_18-1 routed-in
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
interface vlan 12
    no shutdown
    description ** WLAN - Orange12 & Concrete **
    ip address %vlan_12_ip%%vlan_12_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-WIRELESS-VLAN-IN-2010JULY10-CSR routed-in
    apply access-list ip FW-WIRELESS-VLAN-OUT_17-7-CSR routed-out
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
interface vlan 14
    no shutdown
    description ** WLAN - Steel & Redwood **
    ip address %vlan_14_ip%%vlan_14_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-VLAN14-IN-CSR routed-in
    apply access-list ip FW-VLAN14-OUT-CSR routed-out
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
interface vlan 30
    no shutdown
    description ** PoS Segmentation **
    ip address %vlan_30_ip%%vlan_30_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_2%
    ip helper-address %ip_helper_3%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-VLAN30-IN-CSR routed-in
    apply access-list ip FW-VLAN30-OUT_17-7-CSR routed-out
    apply policy QOS-P-marker routed-in
interface vlan 44
    no shutdown
    description ** IP Cameras **
    ip address %vlan_44_ip%%vlan_44_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_2%
    ip helper-address %ip_helper_3%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-VLAN44-IN-CSR routed-in
    apply access-list ip FW-VLAN44-OUT_17-7-CSR routed-out
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
%if is_ecaas_srvr=Y%
    ip mtu 9000
%endif%
!
!For POC store ST0130, ST0159, ST0962 Config
!
 %if compvis_mdf=Y%
!
 no interface vlan 44
 interface vlan 44
    no shutdown
    description POC Store ACL FW-VLAN44-IN-CSR-POC
    ip address %vlan_44_ip%%vlan_44_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_2%
    ip helper-address %ip_helper_3%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply access-list ip FW-VLAN44-IN-CSR-POC routed-in
    apply access-list ip FW-VLAN44-OUT_17-7-CSR-POC routed-out
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
%if is_ecaas_srvr=Y%
    ip mtu 9000
%endif%
!
 %endif%
!
interface vlan 50
    description ** Metro MPLS circuit id TBD tagged vlan 50 **
    ip address %vlan_50_ip%%vlan_50_mask%
    apply access-list ip SERIAL-OUT routed-out
%if is_McastMpls=Y%
    ip pim-sparse enable
%endif%
%if vlan_51_ip=none%
interface vlan 51
	shutdown
	description ** Reserved for Metro MPLS-MIS **
	apply access-list ip internet_inbound_chg0746548 routed-in
%else%
interface vlan 51
    description ** Metro MPLS circuit id TBD tagged vlan 51**
    vrf attach internet
    ip address %vlan_51_ip%%vlan_51_mask%
    apply access-list ip internet_inbound_chg0746548 routed-in
%endif%
!
!   *** Int Vlan 80 config for for VSAT, T1 & MPLS ***
!
%if is_t1%
   %if is_t1=Y%
	!*** NO Additional Config needed
     %else%
     %if is_t1=MPLS%
	interface vlan 80
    	no shutdown
    	description ** MPLS circuit in Place of VSAT **
    	ip address %vlan_80_ip%%vlan_80_mask%
    	apply access-list ip VSAT-OUT-01-14-14 routed-out
    	ip pim-sparse enable
     %else%
	interface vlan 80
    	no shutdown
    	description ** VSAT **
    	ip address %vlan_80_ip%%vlan_80_mask%
    	apply access-list ip VSAT-OUT-01-14-14 routed-out
    	ip pim-sparse enable	
    %endif%
    %endif%
%else%
	interface vlan 80
    	no shutdown
    	description ** VSAT **
    	ip address %vlan_80_ip%%vlan_80_mask%
    	apply access-list ip VSAT-OUT-01-14-14 routed-out
    	ip pim-sparse enable
%endif%
!   *** END of Int Vlan 80 config for for VSAT, T1 & MPLS ***
!
interface vlan 555
    no shutdown
    description ** Voice VLAN **
    ip address %vlan_555_ip%%vlan_555_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply policy QOS-P-marker routed-in
%if vlan_767_ip=none%
interface vlan 767
%else%
interface vlan 767
    vrf attach internet
    ip address %vlan_767_ip%%vlan_767_mask%
%endif%  
interface vlan 802
    description ** THD MGMT VLAN 802 **
    ip address %vlan_802_ip%%vlan_802_mask%
    ip helper-address %ip_helper_1%
    ip helper-address %ip_helper_4%
    ip helper-address %ise_server_1%
    ip helper-address %ise_server_2%
    apply policy QOS-P-marker routed-in
    vrrp 1 address-family ipv4
        address %ip_gateway% primary
        priority 150
        no shutdown
        exit
interface vlan 999
    description ** BGP Interconnect **
    ip address %vlan_999_ip%%vlan_999_mask%
    apply access-list ip SDWAN_MPLS routed-out
    apply policy QOS-P-marker routed-in
    ip igmp enable
    ip pim-sparse enable
interface vlan 1379
    no shutdown
    description ** MPLS Transport Point-to-Point **
    ip address %vlan_1379_ip%%vlan_1379_mask%
!
snmp-server vrf default
snmp-server community %snmp_community_1%
    access-list ipv4 SNMP_ACL
snmp-server community %snmp_community_2%
    access-list ipv4 SNMP_ACL
snmp-server community %snmp_community_3%
    access-list ipv4 SNMP_ACL
snmp-server community %snmp_community_4%
    access-list ipv4 SNMP_ACL
snmp-server community %snmp_community_5%
    access-list ipv4 SNMP_ACL
snmpv3 user m01620 auth sha auth-pass ciphertext AQBapXwiL7KSfYKK8i9ZITTokyTnXjxji6SmS6a8S+MDmpb6CAAAAA9gNnhRWCgR priv aes priv-pass ciphertext AQBapXwiL7KSfYKK8i9ZITTokyTnXjxji6SmS6a8S+MDmpb6CAAAAA9gNnhRWCgR
snmpv3 user thd-sine auth sha auth-pass ciphertext AQBapTsSi+0YFenuHLX1GXO2WlT+I2qUKcfj/oPDOZvZvnSCCAAAAGPB/lNlnnb4 priv aes priv-pass ciphertext AQBapTsSi+0YFenuHLX1GXO2WlT+I2qUKcfj/oPDOZvZvnSCCAAAAGPB/lNlnnb4
snmp-server host %snmp_trap_dest_1% trap version v2c community %snmp_trap_comm_1%
snmp-server host %snmp_trap_dest_2% trap version v2c community %snmp_trap_comm_2%
snmp-server host %snmp_trap_dest_3% trap version v2c community %snmp_trap_comm_3%
!
!
! **** Null Routing Update ****
! Check site variables to determine whether any data center destinations should be null routed or use normal next hop configuration
! Routes are currently grouped to reduce the number of variables needed. Can expand for granularity in next phase
!
! Routing groups:
!   SDW_LIT_IDC
!   SDW_LIS_IDC
!   SDW_MPLS_ATC
!   SDW_MPLS_SSC
!   SDW_MPLS_ASH_EQ and SDW_MPLS_ASH_EQX and SDW_ASH_EQX
!   SDW_MPLS_ATL_EQ and SDW_MPLS_ATL_EQX and SDW_ATL_EQX
!   SDW_MPLS_CHI_EQ and SDW_MPLS_CHI_EQX and SDW_CHI_EQX
!   SDW_MPLS_DAL_EQ and SDW_MPLS_DAL_EQX and SDW_DAL_EQX
!   SDW_MPLS_SJC_EQ and SDW_MPLS_SJC_EQX and SDW_SJC_EQX
!   SDWAN_MPLS_Control
!   SDWAN_MIS_Headend
!
%if null_LIT_IDC% 
    %if null_LIT_IDC=Y%
       ip route 10.23.23.240/28 nullroute
     %else%
       ip route 10.23.23.240/28 %route_next_hop_mpls%
     %endif%
%else%
    ip route 10.23.23.240/28 %route_next_hop_mpls%
%endif%
!
%if null_LIS_IDC%
    %if null_LIS_IDC=Y%
       ip route 10.33.23.240/28 nullroute
    %else%
       ip route 10.33.23.240/28 %route_next_hop_mpls%
    %endif%
%else%
   ip route 10.33.23.240/28 %route_next_hop_mpls%
%endif%
!
%if null_ASH_EQX%
    %if null_ASH_EQX=Y%
      ip route 10.23.18.0/28 nullroute
   %else%
      ip route 10.23.18.0/28 %route_next_hop_mpls%
    %endif%
%else%
   ip route 10.23.18.0/28 %route_next_hop_mpls%
%endif%
!
%if null_ATL_EQX%
    %if null_ATL_EQX=Y%
      ip route 10.23.18.16/28 nullroute
    %else%
      ip route 10.23.18.16/28 %route_next_hop_mpls%
    %endif%
%else%
      ip route 10.23.18.16/28 %route_next_hop_mpls%
%endif%
!
%if null_CHI_EQX%
    %if null_CHI_EQX=Y%
      ip route 10.23.18.32/28 nullroute
    %else%
      ip route 10.23.18.32/28 %route_next_hop_mpls%
     %endif%
%else%
    ip route 10.23.18.32/28 %route_next_hop_mpls%
%endif%
!
%if null_DAL_EQX%
    %if null_DAL_EQX=Y%
      ip route 10.23.18.48/28 nullroute
    %else%
      ip route 10.23.18.48/28 %route_next_hop_mpls%
    %endif%
%else%
    ip route 10.23.18.48/28 %route_next_hop_mpls%
%endif%
!
%if null_SJC_EQX%
    %if null_SJC_EQX=Y%
      ip route 10.23.18.64/28 nullroute
    %else%
      ip route 10.23.18.64/28 %route_next_hop_mpls%
    %endif%
%else%
    ip route 10.23.18.64/28 %route_next_hop_mpls%
%endif%
!
!
! **** Null Routing Group, Routes not present in running config but need to drop traffic using variables ****
!
!   null_ASH_inet	Routes for Ashburn location in VRF internet 
!   null_ATL_inet	Routes for Atlanta location in VRF internet 
!   null_CHI_inet	Routes for Chicago location in VRF internet 
!   null_DAL_inet	Routes for Dallas location in VRF internet 
!   null_SJC_inet	Routes for San Jose location in VRF internet 
!
    %if null_ASH_inet=Y%
      %if vlan_51_ip=none%
      %else% 
        ip route 207.11.75.48/28 nullroute vrf internet
        ip route 207.11.75.64/28 nullroute vrf internet 
      %endif%
    %endif%
    %if null_ATL_inet=Y%
      %if vlan_51_ip=none%
      %else% 
        ip route 207.11.74.48/28 nullroute vrf internet
        ip route 207.11.74.64/28 nullroute vrf internet
      %endif%
    %endif%
    %if null_CHI_inet=Y%
      %if vlan_51_ip=none%
      %else% 
        ip route 207.11.73.48/28 nullroute vrf internet
        ip route 207.11.73.64/28 nullroute vrf internet
      %endif%
    %endif%
    %if null_DAL_inet=Y%
      %if vlan_51_ip=none%
      %else% 
        ip route 207.11.72.48/28 nullroute vrf internet
        ip route 207.11.72.64/28 nullroute vrf internet
      %endif%
    %endif%
    %if null_SJC_inet=Y%
      %if vlan_51_ip=none%
      %else% 
        ip route 207.11.71.48/28 nullroute vrf internet
        ip route 207.11.71.64/28 nullroute vrf internet
      %endif%
    %endif%
!
ip route 192.168.112.0/20 %route_next_hop_lte%
! ***Static route needed for VSAT BGP Peer, not needed for T1 & MPLS ***
!
%if is_t1%
    %if is_t1=Y%
      ! *** directly connected Peer ***
     %else%
     %if is_t1=MPLS%
      ! *** directly connected Peer ***
     %else%
    ip route %bgp_vsat_peer_1%/32 %route_next_hop_vsat%
    ip route %bgp_vsat_peer_2%/32 %route_next_hop_vsat%
    %endif%
    %endif%
%else%
    ip route %bgp_vsat_peer_1%/32 %route_next_hop_vsat%
    ip route %bgp_vsat_peer_2%/32 %route_next_hop_vsat%
%endif%
!   *** END of Static route needed for VSAT BGP, Peer not needed for T1 ***
!
%if vlan_51_ip=none%
%else% 
ip route 0.0.0.0/0 %route_next_hop_inet% vrf internet
%endif%
!
! !! Additional Static Route, modification for CHG0746548
ip route 13.64.211.141/32 %route_next_hop_mpls%
ip route 20.185.225.46/32 %route_next_hop_mpls%
ip route 20.115.18.203/32 %route_next_hop_mpls%
ip route 40.83.146.205/32 %route_next_hop_mpls%
ip route 20.115.6.223/32 %route_next_hop_mpls%
!
%if add_mpls_static1% 
ip route %add_mpls_static1% %route_next_hop_mpls%
%endif% 
ip route 20.168.231.210/32 %route_next_hop_mpls%
ip route 20.163.135.201/32 %route_next_hop_mpls%
ip route 20.168.194.58/32 %route_next_hop_mpls%
ip route 20.169.175.37/32 %route_next_hop_mpls%
ip route 172.171.100.213/32 %route_next_hop_mpls%
ip route 20.168.221.31/32 %route_next_hop_mpls%
ip route 20.29.249.88/32 %route_next_hop_mpls%
ip route 20.228.131.41/32 %route_next_hop_mpls%
ip route 20.121.14.153/32 %route_next_hop_mpls%
ip route 52.142.63.128/32 %route_next_hop_mpls%
ip route 20.85.242.87/32 %route_next_hop_mpls%
ip route 20.29.207.32/32 %route_next_hop_mpls%
ip route 20.172.192.175/32 %route_next_hop_mpls%
ip route 20.172.220.166/32 %route_next_hop_mpls%
ip route 172.174.41.25/32 %route_next_hop_mpls%
ip route 20.232.161.178/32 %route_next_hop_mpls%
ip route 4.154.136.42/32 %route_next_hop_mpls%
ip prefix-list EBGP-OUT description EBGP-FILTER-OUTBOUND
ip prefix-list EBGP-OUT seq 10 permit 10.0.0.0/8 ge 9
ip prefix-list MPLS-ORF description MPLS-FILTER-INBOUND
ip prefix-list MPLS-ORF seq 10 permit 0.0.0.0/0
ip prefix-list MPLS-ORF seq 20 permit 10.0.0.0/8
ip prefix-list MPLS-ORF seq 30 permit 10.23.20.0/24
ip prefix-list MPLS-ORF seq 40 permit 10.33.20.0/24
ip prefix-list MPLS-ORF seq 50 permit 10.72.168.0/22
ip prefix-list MPLS-ORF seq 60 permit 172.16.0.0/12
ip prefix-list MPLS-ORF seq 70 permit 165.130.0.0/16
ip prefix-list MPLS-ORF seq 80 permit 151.140.0.0/16
ip prefix-list MPLS-ORF seq 90 permit 192.168.0.0/16
ip prefix-list MPLS-ORF seq 100 deny 172.16.0.0/12 ge 13
ip prefix-list MPLS-ORF seq 110 deny 165.130.0.0/16 ge 17
ip prefix-list MPLS-ORF seq 120 deny 151.140.0.0/16 ge 17
ip prefix-list MPLS-ORF seq 130 deny 192.168.0.0/16 ge 17
ip prefix-list MPLS-ORF seq 140 deny 32.252.96.0/24 ge 25
ip prefix-list MPLS-ORF seq 150 deny 135.89.0.0/16 ge 17
ip prefix-list MPLS-ORF seq 160 deny 10.0.0.0/8 ge 9
ip prefix-list MPLS-ORF seq 170 permit 0.0.0.0/0 le 32
ip prefix-list RED seq 10 permit %bgp_agg_addr% le 32
ip prefix-list SUP seq 10 permit %bgp_agg_addr% ge 22
ip prefix-list VSAT-EBGP-OUT description VSAT-EBGP-FILTER-OUTBOUND
ip prefix-list VSAT-EBGP-OUT seq 10 deny 10.118.0.0/16 le 32
ip prefix-list VSAT-EBGP-OUT seq 20 deny 10.119.0.0/16 le 32
ip prefix-list VSAT-EBGP-OUT seq 30 permit 10.0.0.0/8 ge 9
ip prefix-list VSAT-ORF seq 5 permit 0.0.0.0/0
ip prefix-list VSAT-ORF seq 10 permit 172.17.193.254/32
ip prefix-list VSAT-ORF seq 15 permit 198.6.14.128/27
ip prefix-list VSAT-ORF seq 20 permit 10.0.0.0/8
ip prefix-list VSAT-ORF seq 25 permit 151.140.0.0/16
ip prefix-list VSAT-ORF seq 30 permit 165.130.0.0/16
ip prefix-list VSAT-ORF seq 35 permit 172.16.0.0/12
ip prefix-list VSAT-ORF seq 40 permit 207.11.0.0/17
ip prefix-list VSAT-ORF seq 45 permit 167.16.0.67/32
ip prefix-list VSAT-ORF seq 50 permit 167.16.0.180/32
ip prefix-list VSAT-ORF seq 55 permit 192.168.0.0/16
ip prefix-list VSAT-ORF seq 56 permit 10.72.168.0/22
ip prefix-list VSAT-ORF seq 60 permit 198.62.166.65/32
ip prefix-list VSAT-ORF seq 65 permit 198.62.166.129/32
ip prefix-list VSAT-ORF seq 70 permit 206.201.50.0/24
ip prefix-list VSAT-ORF seq 75 permit 206.201.53.50/32
ip prefix-list VSAT-ORF seq 80 permit 172.24.2.128/26
ip prefix-list VSAT-ORF seq 85 permit 172.16.239.96/29
ip prefix-list VSAT-ORF seq 90 deny 172.16.0.0/12 ge 13
ip prefix-list VSAT-ORF seq 95 deny 165.130.0.0/16 ge 17
ip prefix-list VSAT-ORF seq 100 deny 151.140.0.0/16 ge 17
ip prefix-list VSAT-ORF seq 105 deny 192.168.0.0/16 ge 17
ip prefix-list VSAT-ORF seq 110 deny 207.11.0.0/17 ge 18
ip prefix-list VSAT-ORF seq 115 deny 32.252.96.0/24 ge 25
ip prefix-list VSAT-ORF seq 120 deny 135.89.0.0/16 ge 17
ip prefix-list VSAT-ORF seq 125 deny 10.0.0.0/8 ge 9
ip prefix-list VSAT-ORF seq 130 deny 12.120.216.246/32
ip prefix-list VSAT-ORF seq 135 deny 12.120.217.0/29
ip prefix-list VSAT-ORF seq 140 deny 12.120.217.8/29
ip prefix-list VSAT-ORF seq 145 deny 12.120.217.128/25
ip prefix-list VSAT-ORF seq 150 deny 12.120.223.192/27
ip prefix-list VSAT-ORF seq 155 deny 32.243.216.104/29
ip prefix-list VSAT-ORF seq 160 deny 64.101.239.0/26
ip prefix-list VSAT-ORF seq 165 deny 66.163.62.120/32
ip prefix-list VSAT-ORF seq 170 deny 66.163.62.123/32
ip prefix-list VSAT-ORF seq 175 deny 68.138.84.104/30
ip prefix-list VSAT-ORF seq 180 deny 68.138.102.76/30
ip prefix-list VSAT-ORF seq 185 deny 68.138.102.100/30
ip prefix-list VSAT-ORF seq 190 deny 68.138.113.224/30
ip prefix-list VSAT-ORF seq 195 deny 68.138.113.232/30
ip prefix-list VSAT-ORF seq 200 deny 146.170.64.192/26
ip prefix-list VSAT-ORF seq 205 deny 146.170.64.254/32
ip prefix-list VSAT-ORF seq 210 deny 146.170.124.192/26
ip prefix-list VSAT-ORF seq 215 deny 146.170.124.254/32
ip prefix-list VSAT-ORF seq 220 deny 147.225.80.148/30
ip prefix-list VSAT-ORF seq 225 deny 147.225.80.192/30
ip prefix-list VSAT-ORF seq 230 deny 147.225.229.20/30
ip prefix-list VSAT-ORF seq 235 deny 152.176.42.232/30
ip prefix-list VSAT-ORF seq 240 deny 152.176.61.100/30
ip prefix-list VSAT-ORF seq 245 deny 152.176.84.68/30
ip prefix-list VSAT-ORF seq 250 deny 198.5.176.144/28
ip prefix-list VSAT-ORF seq 255 deny 198.6.14.128/27
ip prefix-list VSAT-ORF seq 260 deny 198.6.68.160/27
ip prefix-list VSAT-ORF seq 265 deny 198.6.75.128/27
ip prefix-list VSAT-ORF seq 270 deny 198.6.96.192/28
ip prefix-list VSAT-ORF seq 275 deny 199.220.34.40/30
ip prefix-list VSAT-ORF seq 280 deny 199.220.146.96/30
ip prefix-list VSAT-ORF seq 285 deny 206.113.119.0/26
ip prefix-list VSAT-ORF seq 290 deny 206.113.119.128/26
ip prefix-list VSAT-ORF seq 295 deny 216.141.33.71/32
ip prefix-list VSAT-ORF seq 300 deny 216.240.197.3/32
ip prefix-list VSAT-ORF seq 305 permit 0.0.0.0/0 le 32
!
ip prefix-list VSAT-ORF-1 seq 5 permi 0.0.0.0/0
ip prefix-list VSAT-ORF-1 seq 20 permit 10.0.0.0/8
ip prefix-list VSAT-ORF-1 seq 25 permit 151.140.0.0/16
ip prefix-list VSAT-ORF-1 seq 30 permit 165.130.0.0/16
ip prefix-list VSAT-ORF-1 seq 35 permit 172.16.0.0/12
ip prefix-list VSAT-ORF-1 seq 40 permit 207.11.0.0/17
ip prefix-list VSAT-ORF-1 seq 55 permit 192.168.0.0/16
!
!
ip prefix-list store_agg_L0_pfxlst seq 10 permit %bgp_agg_addr%
ip prefix-list store_agg_L0_pfxlst seq 20 permit %loopback_0_ip%/32
!
ip prefix-list R3_Lo0 seq 10 permit 10.120.0.0/16 ge 32                 
!
ip aspath-list 1 seq 10 permit ^&
!
! route-map EBGP-OUT has been replaced with EBPG-OUT-SUP effective on 20211015.
route-map EBGP-OUT permit seq 10
     match ip address prefix-list EBGP-OUT
route-map EBGP-OUT permit seq 20
    match aspath-list 1
! route-map VSAT-EBGP-OUT has been replaced with VSAT-EBPG-OUT-SUP effective on 20211015.
route-map VSAT-EBGP-OUT permit seq 10
    match ip address prefix-list EBGP-OUT
    set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
route-map VSAT-EBGP-OUT permit seq 20
    match aspath-list 1
    set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
route-map MPLS-ORF permit seq 10
     match ip address prefix-list MPLS-ORF
route-map VSAT-ORF permit seq 10
     match ip address prefix-list VSAT-ORF
route-map VSAT-ORF-1 permit seq 10
     match ip address prefix-list VSAT-ORF-1
route-map NO-EXPORT permit seq 10
     set community no-export
route-map RED permit seq 10
     match ip address prefix-list RED
route-map RED deny seq 20
route-map SD-WAN-IN permit seq 10
     match ip address prefix-list MPLS-ORF
     set community no-export
route-map UNSUP permit seq 10
     match ip address prefix-list RED
route-map VSAT-prepend-10 permit seq 10
     match aspath-list 1
     set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
route-map VSAT-prepend-9 permit seq 10
     match aspath-list 1
     set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
route-map EBGP-OUT-SUP deny seq 10
    match ip address prefix-list SUP
route-map EBGP-OUT-SUP permit seq 20
     match ip address prefix-list EBGP-OUT
     set community "65450:6000 65450:%bgp_asn%"
route-map EBGP-OUT-SUP permit seq 30
    match aspath-list 1
    set community "65450:6000 65450:%bgp_asn%"
route-map VSAT-EBGP-OUT-SUP deny seq 10
    match ip address prefix-list SUP
route-map VSAT-EBGP-OUT-SUP permit seq 20
    match ip address prefix-list EBGP-OUT
    set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
route-map VSAT-EBGP-OUT-SUP permit seq 30
    match aspath-list 1
    set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
!
route-map store_agg_L0_rmap-OUT permit seq 10
    match ip address prefix-list store_agg_L0_pfxlst
    set community "65450:6000 65450:%bgp_asn%"
route-map store_agg_l0_rmap-OUT permit seq 20
    match aspath-list 1
    set community "65450:6000 65450:%bgp_asn%"
!
route-map StAgL0_R3L0_VSAT-OUT permit seq 10
     match ip address prefix-list store_agg_L0_pfxlst
     set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%    
     set community "65450:6000 65450:%bgp_asn%"
route-map StAgL0_R3L0_VSAT-OUT permit seq 20                                  
     match ip address prefix-list R3_Lo0
     set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn%
     set community "65450:6000 65450:%bgp_asn%"
route-map StAgL0_R3L0_VSAT-OUT permit seq 30                                  
    match aspath-list 1
    set as-path prepend %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% %bgp_asn% 
    set community "65450:6000 65450:%bgp_asn%"
!
router bgp %bgp_asn%
    bgp router-id %loopback_0_ip%
    timers bgp 15 25
    timers bgp connect-retry 5
    bgp log-neighbor-changes
    neighbor mpls peer-group
    neighbor mpls remote-as %bgp_mpls_asn%
    neighbor mpls description AT&T MPLS PER
    neighbor mpls timers connect-retry 5
    neighbor %bgp_mpls_peer% peer-group mpls
    neighbor %bgp_inside_sdwan% remote-as %bgp_asn%
    neighbor %bgp_inside_sdwan% description SD-WAN
    neighbor %bgp_inside_sdwan% password ciphertext %bgp_inside_sdwan_pwd%
    neighbor %bgp_inside_lte% remote-as %bgp_asn%
    neighbor %bgp_inside_lte% description Router-3
    neighbor %bgp_inside_lte% timers connect-retry 5
%if is_t1% 
%if is_t1=Y%
    neighbor %bgp_t1_peer_1% remote-as %bgp_asn%
    neighbor %bgp_t1_peer_1% description T1 Peer 
    neighbor %bgp_t1_peer_1% timers connect-retry 5
%else%
    neighbor %bgp_vsat_peer_1% remote-as %bgp_vsat_asn%
    neighbor %bgp_vsat_peer_1% description VSAT Peer
    neighbor %bgp_vsat_peer_1% ebgp-multihop 10
    neighbor %bgp_vsat_peer_1% timers 15 25
    neighbor %bgp_vsat_peer_1% timers connect-retry 5
    neighbor %bgp_vsat_peer_2% remote-as %bgp_vsat_asn%
    neighbor %bgp_vsat_peer_2% description VSAT Peer
    neighbor %bgp_vsat_peer_2% ebgp-multihop 10
    neighbor %bgp_vsat_peer_2% timers 15 25
    neighbor %bgp_vsat_peer_2% timers connect-retry 5
%endif%
%else%
    neighbor %bgp_vsat_peer_1% remote-as %bgp_vsat_asn%
    neighbor %bgp_vsat_peer_1% description VSAT Peer
    neighbor %bgp_vsat_peer_1% ebgp-multihop 10
    neighbor %bgp_vsat_peer_1% timers 15 25
    neighbor %bgp_vsat_peer_1% timers connect-retry 5
    neighbor %bgp_vsat_peer_2% remote-as %bgp_vsat_asn%
    neighbor %bgp_vsat_peer_2% description VSAT Peer
    neighbor %bgp_vsat_peer_2% ebgp-multihop 10
    neighbor %bgp_vsat_peer_2% timers 15 25
    neighbor %bgp_vsat_peer_2% timers connect-retry 5
%endif%
    address-family ipv4 unicast
        network %loopback_6_ip%/32
        network %vlan_1379_net%%vlan_1379_mask%
        network %loopback_0_ip%/32
        network 192.168.77.0/29 route-map NO-EXPORT
        aggregate-address %bgp_agg_addr% as-set
        redistribute connected route-map RED
        neighbor mpls send-community
        neighbor mpls next-hop-self
        neighbor mpls route-map MPLS-ORF in
        neighbor mpls route-map EBGP-OUT-SUP out
        neighbor %bgp_mpls_peer% activate
        neighbor %bgp_inside_sdwan% activate
        neighbor %bgp_inside_sdwan% next-hop-self
        neighbor %bgp_inside_sdwan% route-map MPLS-ORF in
        neighbor %bgp_inside_sdwan% route-map store_agg_L0_rmap-OUT out
        neighbor %bgp_inside_sdwan% send-community standard
        neighbor %bgp_inside_sdwan% soft-reconfiguration inbound
        neighbor %bgp_inside_lte% activate
        neighbor %bgp_inside_lte% next-hop-self
        neighbor %bgp_inside_lte% send-community standard
        neighbor %bgp_inside_lte% soft-reconfiguration inbound
%if is_t1%
%if is_t1=Y%
        neighbor %bgp_t1_peer_1% activate
        neighbor %bgp_t1_peer_1% next-hop-self
%else%
        neighbor %bgp_vsat_peer_1% activate
        neighbor %bgp_vsat_peer_1% next-hop-self
        neighbor %bgp_vsat_peer_1% capability orf prefix-list send
        neighbor %bgp_vsat_peer_1% soft-reconfiguration inbound
        neighbor %bgp_vsat_peer_1% route-map VSAT-ORF-1 in
        neighbor %bgp_vsat_peer_1% route-map StAgL0_R3L0_VSAT-OUT out       
        neighbor %bgp_vsat_peer_2% activate
        neighbor %bgp_vsat_peer_2% next-hop-self
        neighbor %bgp_vsat_peer_2% capability orf prefix-list send
        neighbor %bgp_vsat_peer_2% soft-reconfiguration inbound
        neighbor %bgp_vsat_peer_2% route-map VSAT-ORF-1 in
        neighbor %bgp_vsat_peer_2% route-map StAgL0_R3L0_VSAT-OUT out
%endif% 
%else%
        neighbor %bgp_vsat_peer_1% activate
        neighbor %bgp_vsat_peer_1% next-hop-self
        neighbor %bgp_vsat_peer_1% capability orf prefix-list send
        neighbor %bgp_vsat_peer_1% soft-reconfiguration inbound
        neighbor %bgp_vsat_peer_1% route-map VSAT-ORF-1 in
        neighbor %bgp_vsat_peer_1% route-map StAgL0_R3L0_VSAT-OUT out       
        neighbor %bgp_vsat_peer_2% activate
        neighbor %bgp_vsat_peer_2% next-hop-self
        neighbor %bgp_vsat_peer_2% capability orf prefix-list send
        neighbor %bgp_vsat_peer_2% soft-reconfiguration inbound
        neighbor %bgp_vsat_peer_2% route-map VSAT-ORF-1 in
        neighbor %bgp_vsat_peer_2% route-map StAgL0_R3L0_VSAT-OUT out
%endif%        
    exit-address-family
!
!
!   *** BGP Config modify for for VSAT, T1 & MPLS ***
!
%if is_t1=MPLS%
router bgp %bgp_asn%
no neighbor %bgp_vsat_peer_1% ebgp-multihop 10
no neighbor %bgp_vsat_peer_2% remote-as %bgp_vsat_asn%
%endif%
!   *** END BGP Config modify for for VSAT, T1 & MPLS ***
!
!    *** PIM configuration for VSAT & T1 & MPLS Link ***
!
%if is_t1%
    %if is_t1=Y%
router pim
    enable
    ip mroute 10.64.169.248/32 %bgp_t1_peer_1%
    ip mroute 10.64.171.238/32 %bgp_t1_peer_1%
    ip mroute 151.140.196.0/23 %bgp_t1_peer_1%
    ip mroute 172.17.193.254/32 %bgp_t1_peer_1%
    rp-address 172.17.193.254 239.129.1.0/24 override
    rp-address 192.168.50.6 239.192.2.2/32 override
     %else%
     %if is_t1=MPLS%
router pim
    enable
    ip mroute 10.64.169.248/32 %route_next_hop_vsat% 
    ip mroute 10.64.171.238/32 %route_next_hop_vsat% 
    ip mroute 151.140.196.0/23 %route_next_hop_vsat%
    ip mroute 172.17.193.254/32 %route_next_hop_vsat%
    rp-address 172.17.193.254 239.129.1.0/24 override
    rp-address 192.168.50.6 239.192.2.2/32 override
     %else%
router pim
    enable
    ip mroute 10.64.169.248/32 vlan80 
    ip mroute 10.64.171.238/32 vlan80
    ip mroute 172.17.193.254/32 vlan80
    ip mroute 151.140.196.0/23 vlan80
    rp-address 172.17.193.254 239.129.1.0/24 override
    rp-address 192.168.50.6 239.192.2.2/32 override
    %endif%
    %endif%
%else%
router pim
    enable
    ip mroute 10.64.169.248/32 vlan80 
    ip mroute 10.64.171.238/32 vlan80
    ip mroute 172.17.193.254/32 vlan80
    ip mroute 151.140.196.0/23 vlan80
    rp-address 172.17.193.254 239.129.1.0/24 override
    rp-address 192.168.50.6 239.192.2.2/32 override
%endif%
!
!    *** END of PIM configuration for VSAT & T1 & MPLS Link ***
!    *** Router PIM & Vlan 80 PIM configuration for MCAST over MPLS Circuit *** !
!
%if is_McastMpls=Y%
!
interface vlan 80
    no ip pim-sparse enable
!
no router pim
router pim
    enable
    ip mroute 10.64.169.248/32 %bgp_mpls_peer% 
    ip mroute 10.64.171.238/32 %bgp_mpls_peer%
    ip mroute 172.17.193.254/32 %bgp_mpls_peer%
    ip mroute 151.140.196.0/23 %bgp_mpls_peer%
    rp-address 172.17.193.254 239.129.1.0/24 override
    rp-address 192.168.50.6 239.192.2.2/32 override
%endif%
!    *** END of PIM configuration for MCAST over MPLS Circuit *** !
!
!
copp-policy default
    class ip-tracker priority 0 rate 25 burst 25
    class mirror-to-cpu priority 0 rate 1000 burst 1000
!---Port Mirror---
!---Port Mirror---
mirror session 1
    destination interface 1/1/15
    source vlan 999 both
    source vlan 50 both
%if is_t1%
%if is_t1=Y%
! nothing
%else%
     source vlan 80 both
%endif%
%else%
     source vlan 80 both
%endif%
    enable
!
mirror Session 2
disable
%if is_armis_poc=Y%
! !!!! Armis POC mirror session 2 !!!!!
    destination interface 2/1/15
    source vlan 90 both
    source vlan 105 both
    source vlan 150 both
    source vlan 555 both
    source vlan 802 both
    source vlan 2 both
    source vlan 30 both
    source vlan 44 both
    source vlan 14 both
    source vlan 12 both
    source vlan 10 both
    source vlan 26 both
    source vlan 50 both
    source vlan 51 both
    source vlan 190 both
    source vlan 815 both
    source vlan 999 both
%if is_t1%
%if is_t1=Y%
! nothing
%else%
     source vlan 80 both
%endif%
%else%
     source vlan 80 both
%endif%
    enable
%endif%
!     !!!! END Armis POC mirrir session 2 !!!
!     !!!! START PaloAlto POC mirror session 2 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
%if is_paloalto_poc=Y%
    mirror Session 1
     disable
! !!!! PaloAlto POC mirror session 2 !!!!!
   mirror Session 2
    destination interface 1/1/15,2/1/15
	Source vlan 19 both
	Source vlan 999 both
	Source vlan 2 both
	Source vlan 51 both
	Source vlan 190 both
	Source vlan 12 both
	Source vlan 815 both
	Source vlan 44 both
	Source vlan 14 both
	Source vlan 30 both
	Source vlan 802 both
	Source vlan 26 both
	Source vlan 555 both
	Source vlan 50 both
	Source vlan 150 both
	Source vlan 105 both
	Source vlan 10 both
	Source vlan 90 both
	Source vlan 767 both 
	Source vlan 997 both 
	Source vlan 1379 both
%if is_t1%
%if is_t1=Y%
! nothing
%else%
     source vlan 80 both
%endif%
%else%
     source vlan 80 both
%endif%
    enable
%endif%
!     !!!! END PaloAlto POC mirror session 2 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
mirror session 3
    destination interface 1/1/4
%if is_ecaas_srvr=Y%
    destination interface 1/1/16
%endif%
%if is_ecaas_live=Y%
    no destination interface 1/1/4 
%endif%
    source vlan 90 both
    source vlan 105 both
    source vlan 150 both
    source vlan 30 both
    source vlan 14 both
    source vlan 44 both
    source vlan 12 both
    source vlan 802 both
    source vlan 555 both
    source vlan 2 both
    source vlan 10 both
    source vlan 26 both
    source vlan 50 both
    source vlan 51 both
    source vlan 190 both
    source vlan 815 both
    source vlan 999 both
%if is_t1%
%if is_t1=Y%
! nothing
%else%
     source vlan 80 both
%endif%
%else%
     source vlan 80 both
%endif%
    enable
mirror session 4
    destination interface 1/1/6
%if is_ecaas_srvr=Y%
    destination interface 2/1/16
%endif%
%if is_ecaas_live=Y%
    no destination interface 1/1/6
%endif%
    source vlan 90 both
    source vlan 105 both
    source vlan 150 both
    source vlan 30 both
    source vlan 14 both
    source vlan 44 both
    source vlan 12 both
    source vlan 802 both
    source vlan 555 both
    source vlan 2 both
    source vlan 10 both
    source vlan 26 both
    source vlan 50 both
    source vlan 51 both
    source vlan 190 both
    source vlan 815 both
    source vlan 999 both
%if is_t1%
%if is_t1=Y%
! nothing
%else%
     source vlan 80 both
%endif%
%else%
     source vlan 80 both
%endif%
    enable
!
! !!! CONFIG for NO VSAT SITES !!!
%if is_novsat=Y% 
router bgp %bgp_asn%
    no neighbor %bgp_vsat_peer_1%
    no neighbor %bgp_vsat_peer_2%
no ip route %bgp_vsat_peer_1%/32 %route_next_hop_vsat%
no ip route %bgp_vsat_peer_2%/32 %route_next_hop_vsat%
!   **** changes for Mcast over MPLS *** !
%if is_McastMpls=Y%
!  *** Then do nothing since PIM config for MPLS Circuit & Needed !!!
%else%
router pim
    no ip mroute 10.64.169.248/32 vlan80 
    no ip mroute 10.64.171.238/32 vlan80
    no ip mroute 172.17.193.254/32 vlan80
    no ip mroute 151.140.196.0/23 vlan80
%endif%
!   **** END of changes for Mcast Over MPLS *** !
interface 1/1/8-1/1/9,2/1/8-2/1/9
    no vlan trunk allowed 80
    no loop-protect vlan 80
interface 1/1/4,1/1/6
    no vlan trunk allowed 80
    no loop-protect vlan 80
interface 1/1/15
    no vlan trunk allowed 80
interface lag 24
    no vlan trunk allowed 80
mirror session 1
    no source vlan 80 both
mirror session 3
    no source vlan 80 both
mirror session 4
    no source vlan 80 both
%if is_ecaas_srvr=Y%
interface 1/1/13-1/1/14,2/1/13-2/1/14,1/1/16,2/1/16
    no vlan trunk allowed 80
    no loop-protect vlan 80
%endif%
%if is_armis_poc=Y%
mirror session 2
    no source vlan 80 both
interface 2/1/15
    no vlan trunk allowed 80
%endif%
!  !!!!!This is PaloAlto-FW MirrorSession POC Config !!!!
%if is_paloalto_poc=Y%
mirror session 2
    no source vlan 80 both
interface 2/1/15
    no vlan trunk allowed 80    
%endif%
!  !!!!! END PaloAlto-FW MirrorSession POC Config !!!!
no interface vlan80
no vlan 80
%endif%
! !!! END NO VSAT CONFIG !!!
ip dns domain-name swm1.%_site_type%%_site_number%.homedepot.com
ip dns server-address %dns_server_primary%
ip dns server-address %dns_server_secondary%
ip dns server-address 8.8.8.8 vrf mgmt
ip dns server-address 8.8.4.4 vrf mgmt
!
!
!
!
!
! Do not set IP Source VLAN if is_staging=Y
%if is_staging=Y%
%else%
    ip source-interface all interface vlan802
%endif%
https-server vrf default
https-server vrf mgmt
nae-script Routing_BGP_Agent_Monitor false IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIwojIChjKSBDb3B5cmlnaHQgMjAxOC0yMDIxIEhld2xldHQgUGFja2FyZCBFbnRlcnByaXNlIERldmVsb3BtZW50IExQCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAojIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiMgIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiMgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiMgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwojIHVuZGVyIHRoZSBMaWNlbnNlLgoKIyAgICAgICAgICAgICAgIC0tICBSb3V0aW5nIEJHUCBIZWFsdGggZnVuY3Rpb25hbGl0eSAgLS0KIyBUaGUgb3ZlcmFsbCwgdGVyc2UgZ29hbCBvZiB0aGlzIHNjcmlwdCBpcyB0byBtb25pdG9yIHJvdXRpbmcgaGVhbHRoLAojIGRlY2lkZSBpZiB0aGluZ3MgaGF2ZSBnb25lIGJhZCwgYW5kIGlmIHNvLCBnZW5lcmF0ZSBzb21lIGhlbHBmdWwgY2xpL3NoZWxsCiMgb3V0cHV0IGZyb20gdGhlIGFwcHJvcGlhdGUgbW9tZW50IG9mIHRoZSBldmVudC4KIwojIDEuIEJHUAojICAgLSBtb25pdG9yIEJHUCBuZWlnaGJvcnMKIyAgIC0gYWxlcnQgaWYKIyAgICAgLSBCR1AgbmVpZ2hib3JzIGdldHRpbmcgc3R1Y2sgaW4gSWRsZSwgQWN0aXZlLCBDb25uZWN0LCBPcGVuQ29uZmlybQojICAgICAgIHN0YXRlcwojICAgICAgIC0gYWxlcnQgaXMgc2V0IGJldHdlZW4gQkdQIHRocmVzaG9sZCB0aW1lIGFuZCB1cHRvIDUgcG9sbCBjeWNsZXMKIyAgICAgLSBCR1AgbmVpZ2hib3JzIGdvaW5nIGRvd24gZnJvbSBFc3RhYmxpc2hlZCBzdGF0ZQojICAgICAtIEJHUCBuZWlnaGJvciBzdGF0ZSBmbGFwcyB3aXRoaW4gYSBzaW5nbGUgcG9sbCBpbnRlcnZhbAojICAgICAtIEJHUCBuZWlnaGJvciBleGNoYW5nZXMgYSBuZXcgZXJyb3IsIHN1Yi1lcnJvciBjb2RlIHRoYW4gYmVmb3JlCiMgICAtIHB1Ymxpc2ggb3V0cHV0IGZyb206CiMgICAgIC0gc2hvdyBiZ3AgYWxsIHN1bW1hcnkgLSB0byBrbm93IGFsbCB0aGUgbmVpZ2hib3Igc3RhdGVzCiMgICAgIC0gcGluZyA8YmdwX25icj4gPHNvdXJjZT4gLSB0byBjaGVjayBpZiBwZWVyIGFkZHJlc3MgaXMgcmVhY2hhYmxlCiMgICAgIC0gdHJhY2Vyb3V0ZSA8YmdwX25icj4gLSB0byBjaGVjayB3aGVyZSBpcyB0aGUgcGFja2V0IGRyb3BwZWQKIyAgICAgLSBzeXNsb2dzIHRvIGluZGljYXRlIHRoZSBlcnJvciBhbmQgc3ViLWVycm9yIGNvZGVzIHNlbnQvcmVjZWl2ZWQgZnJvbQojICAgICAgIEJHUCBuZWlnaGJvcgojICAgLSBjbGVhciBhbGVydCBpZgojICAgICAtIEFsbCBuZWlnaGJvcnMgcHJlc2VudCBhcmUgaW4gZ29vZCBzdGF0ZQojICAgLSBmaWx0ZXJzCiMgICAgIC0gYmFzZWQgb24gdnJmLCBuZWlnaGJvciBhZGRyZXNzCiMgICAtIGFsZXJ0cwojICAgICAgIC0gQ1JJVElDQUwKIyAgICAgICAgICAgLSBuZWlnaGJvciBzdGF0ZSBjaGFuZ2VkIGZyb20gZXN0YWJpc2hlZCB0byBpZGxlL2Nvbm5lY3QvYWN0aXZlCiMgICAgICAgICAgIC0gbmVpZ2hib3Igc3R1Y2sgaW4gc3RhdGVzIGlkbGUvY29ubmVjdC9hY3RpdmUvT3BlbkNvbmZpcm0KIyAgICAgICAtIE1BSk9SCiMgICAgICAgICAgIC0gbmVpZ2hib3IgaXMgZmxhcHBpbmcoIG5laWdoYm9yIHN0YXRlIGlzICdlc3RhYmxpc2hlZCcgaW4gbGFzdCBhbmQKIyAgICAgICAgICAgICBjdXJyZW50IGN5Y2xlIGJ1dCAnYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQnIGluIGN1cnJlbnQgY3ljbGUKIyAgICAgICAgICAgICBpcyBncmVhdGVyIHRoYW4gbGFzdCBjeWNsZSkKIwojCiMgIDIuIFJvdXRpbmcgaGVhbHRoCiMgICAgIC0gbW9uaXRvciBSb3V0aW5nIGRhZW1vbiBoaWdoIGNwdQojICAgICAtIGFsZXJ0IGlmCiMgICAgICAgLSBDUFUgc3RheXMgaGlnaCBmb3IgY3B1X3RocmVzaG9sZCBmb3IgY3B1X3RpbWVfaW50ZXJ2YWwKIyAgICAgLSBhY3Rpb25zCiMgICAgICAgLSBmb3IgdGhlIGNwdV9jb29sZG93bl9pbnRlcnZhbCBkbyBub3QgcXVlcnkgYmdwIG5laWdoYm9ycwojICAgICAgIC0gZG8gbm90IGNhc2UgYWRkaXRpb25hbCBjcHUgc3Bpa2UKIyAgICAgICAtIGdpdmUgdGltZSBmb3IgY29vbCBkb3duCgppbXBvcnQganNvbgpmcm9tIHRpbWUgaW1wb3J0IChzbGVlcCwgY2xvY2tfZ2V0dGltZSwgQ0xPQ0tfUFJPQ0VTU19DUFVUSU1FX0lEKQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIGlwYWRkcmVzcyBpbXBvcnQgKGlwX2FkZHJlc3MsIElQdjRBZGRyZXNzKQppbXBvcnQgcmVxdWVzdHMKCk1hbmlmZXN0ID0gewogICAgJ05hbWUnOiAnUm91dGluZ19CR1BfQWdlbnRfTW9uaXRvcicsCiAgICAnRGVzY3JpcHRpb24nOiAnQWdlbnQgZm9yIG1vbml0b3JpbmcgUm91dGluZyBCR1AgaGVhbHRoJywKICAgICdWZXJzaW9uJzogJzEuMCcsCiAgICAnVGFyZ2V0U29mdHdhcmVWZXJzaW9uJzogJzEwLjcnLAogICAgJ0F1dGhvcic6ICdBcnViYSBOZXR3b3JrcycKfQoKUGFyYW1ldGVyRGVmaW5pdGlvbnMgPSB7CiAgICAnY3B1X3RocmVzaG9sZCc6IHsKICAgICAgICAnTmFtZSc6ICdIaWdoIENQVSBUaHJlc2hvbGQgUGVyY2VudGFnZScsCiAgICAgICAgJ0Rlc2NyaXB0aW9uJzogJ05vdGlmeSBhbGVydCB3aGVuIENQVSB1dGlsaXphdGlvbiBzdGF5cyBhYm92ZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoaXMgdGhyZXNob2xkIHZhbHVlIGZvciBocGVfcm91dGluZ19kYWVtb24gJwogICAgICAgICAgICAgICAgICAgICAgICdmb3IgdGhlIG1lbnRpb25lZCBjcHVfdGltZV9pbnRlcnZhbC4nLAogICAgICAgICdUeXBlJzogJ0ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogODAKICAgIH0sCiAgICAnY3B1X3RpbWVfaW50ZXJ2YWwnOiB7CiAgICAgICAgJ05hbWUnOiAnVGltZSBpbnRlcnZhbCBpbiBzZWNvbmRzIHRvIGNvbnNpZGVyIGZvciBDUFUgdXRpbGl6YXRpb24nLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdUaW1lIGludGVydmFsIGluIHNlY29uZHMgdG8gY29uc2lkZXIgZm9yICcKICAgICAgICAgICAgICAgICAgICAgICAnaHBlX3JvdXRpbmdfZGFlbW9uIENQVSB1dGlsaXphdGlvbicsCiAgICAgICAgJ1R5cGUnOiAnSW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiA2MAogICAgfSwKICAgICdjcHVfY29vbGRvd25faW50ZXJ2YWwnOiB7CiAgICAgICAgJ05hbWUnOiAnVGltZSBpbnRlcnZhbCBpbiBzZWNvbmRzIHRvIHBhdXNlIG1vbml0b3Jpbmcgcm91dGluZyBoZWFsdGgnLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdUaW1lIGludGVydmFsIGluIHNlY29uZHMgdG8gZGVmZXIgQkdQIGhlYWx0aCcKICAgICAgICAgICAgICAgICAgICAgICAnIG1vbml0b3JpbmcgZHVyaW5nIGhpZ2ggY3B1IHV0aWxpemF0aW9uIGJ5JwogICAgICAgICAgICAgICAgICAgICAgICcgaHBlX3JvdXRpbmdfZGFlbW9uLiAnLAogICAgICAgICdUeXBlJzogJ0ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMzAwCiAgICB9LAogICAgJ3BvbGxfaW50ZXJ2YWwnOiB7CiAgICAgICAgJ05hbWUnOiAnUG9sbGluZyBJbnRlcnZhbCcsCiAgICAgICAgJ0Rlc2NyaXB0aW9uJzogJ0hvdyBvZnRlbiB0byBwb2xsIGZvciByb3V0aW5nIGhlYWx0aCBtZXRyaWNzLicKICAgICAgICAgICAgICAgICAgICAgICAnIE1lYXN1cmVkIGluIHNlY29uZHMuIERlZmF1bHQgaXMgNjAnLAogICAgICAgICdUeXBlJzogJ0ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogNjAKICAgIH0sCiAgICAndnJmJzogewogICAgICAgICdOYW1lJzogJ1ZSRicsCiAgICAgICAgJ0Rlc2NyaXB0aW9uJzogJ1ZSRiB0byBtb25pdG9yLiBCeSBkZWZhdWx0IGFsbCBWUkZzIGFyZSBtb25pdG9yZWQuJywKICAgICAgICAnVHlwZSc6ICdTdHJpbmcnLAogICAgICAgICdEZWZhdWx0JzogIioiCiAgICB9LAogICAgJ2JncF9uZWlnaGJvcic6IHsKICAgICAgICAnTmFtZSc6ICdCR1AgTmVpZ2hib3InLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdCR1AgTmVpZ2hib3IgdG8gbW9uaXRvci4gQnkgZGVmYXVsdCBhbGwgbmVpZ2hib3JzIGFyZScKICAgICAgICAgICAgICAgICAgICAgICAnIG1vbml0b3JlZC4nLAogICAgICAgICdUeXBlJzogJ1N0cmluZycsCiAgICAgICAgJ0RlZmF1bHQnOiAnKicKICAgIH0KfQoKCkFsZXJ0X2UgPSBbCiAgICBBbGVydExldmVsLk5PTkUsCiAgICBBbGVydExldmVsLk1JTk9SLAogICAgQWxlcnRMZXZlbC5NQUpPUiwKICAgIEFsZXJ0TGV2ZWwuQ1JJVElDQUwKXQoKRFBSSU5UID0gRmFsc2UKCgpkZWYgZHByaW50KCphcmdzKToKICAgICcnJ3RoaXMgZnVuY3Rpb24gaXMgdXNlZCBmb3IgcHJpbnRpbmcgZGVidWcgbG9ncycnJwogICAgaWYgRFBSSU5UOgogICAgICAgIHByaW50KGFyZ3MpCgoKY2xhc3MgQWdlbnQoTkFFKToKICAgICIiIgoKICAgIE5vdGU6IHNldmVyYWwgdXNlZnVsIHZhcmlhYmxlcyBhcmUgZGVmaW5lZCBpbiBOQUUgd2hpY2ggd2Ugd2lsbCByZWZlcmVuY2UKICAgIGhlcmU6CgogICAgSFRUUF9BQUREUkVTUyA9PiAiaHR0cDovLzEyNy4wLjAuMTo4MDgwIgogICAgQWxlcnRMZXZlbC5OT05FL01JTk9SL01BSk9SL0NSSVRJQ0FMID0+IE5vbmUsIE1pbm9yLCBNYWpvciwgQ3JpdGljYWwKICAgIFNZU0xPR19XQVJOSU5HID0+IDQgIyMgcmZjLTU0MjQgZGVmaW5lZCBudW1iZXIgZm9yIHN5c2xvZyBXYXJuaW5nIGxldmVsCiAgICBBY3Rpb25TeXNsb2coKQogICAgQWN0aW9uQ2xpKCkKICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKCiAgICAgICAgIyBkcHJpbnQoIldJUC0tLS0tLS0gQWdlbnQ6X19pbml0X18iKQogICAgICAgIHNlbGYuYmdwX2FnZW50ID0gQkdQQWdlbnQoc2VsZikKICAgICAgICBzZWxmLnJvdXRpbmdfYWdlbnQgPSBSb3V0aW5nQWdlbnQoc2VsZikKICAgICAgICBzZWxmLmFjdGlvbnNfYmdwID0gc2V0KCkKICAgICAgICBzZWxmLmFsZXJ0X2xldmVsc19nZW5lcmF0ZWRfd2l0aGluX3BvbGxfYmdwID0gc2V0KCkKCiAgICAgICAgcnVsZSA9IFJ1bGUoIlJvdXRpbmcgSGVhbHRoIFJ1bGUiKQogICAgICAgIHJ1bGUuY29uZGl0aW9uKCJldmVyeSB7fSBzZWNvbmRzIiwgW3NlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ11dKQogICAgICAgIHJ1bGUuYWN0aW9uKHNlbGYucm91dGluZ19iZ3BfaGVhbHRoX3BvbGxlcikKICAgICAgICBzZWxmLnJ1bGUgPSBydWxlCgogICAgICAgICMgUGVyc2lzdGFudCB2YXJpYWJsZXMgYWNyb3NzIGV2ZXJ5IHJ1biBvZiB0aGlzIHNjcmlwdAogICAgICAgICMgYXJlIHN0b3JlZCBpbiBzZWxmLnZhcmlhYmxlcy4gVGhleSBtdXN0IGJlIG9mIHR5cGUKICAgICAgICAjIHN0cmluZy4KICAgICAgICBpZiAnYmdwX2FsZXJ0JyBub3QgaW4gc2VsZi52YXJpYWJsZXMua2V5cygpOgogICAgICAgICAgICBzZWxmLnZhcmlhYmxlc1snYmdwX2FsZXJ0J10gPSBBbGVydExldmVsLk5PTkUKICAgICAgICBpZiAnY3B1X2FsZXJ0JyBub3QgaW4gc2VsZi52YXJpYWJsZXMua2V5cygpOgogICAgICAgICAgICBzZWxmLnZhcmlhYmxlc1snY3B1X2FsZXJ0J10gPSBBbGVydExldmVsLk5PTkUKICAgICAgICBpZiAnY3VycmVudF9hbGVydCcgbm90IGluIHNlbGYudmFyaWFibGVzLmtleXMoKToKICAgICAgICAgICAgc2VsZi52YXJpYWJsZXNbJ2N1cnJlbnRfYWxlcnQnXSA9IEFsZXJ0TGV2ZWwuTk9ORQogICAgICAgIGlmICdiZ3BfbmJyX2xpc3QnIG5vdCBpbiBzZWxmLnZhcmlhYmxlcy5rZXlzKCk6CiAgICAgICAgICAgIHNlbGYudmFyaWFibGVzWydiZ3BfbmJyX2xpc3QnXSA9IGpzb24uZHVtcHMoe30pCiAgICAgICAgaWYgJ2JncF9uYnJfY291bnQnIG5vdCBpbiBzZWxmLnZhcmlhYmxlcy5rZXlzKCk6CiAgICAgICAgICAgIHNlbGYudmFyaWFibGVzWydiZ3BfbmJyX2NvdW50J10gPSBzdHIoMCkKICAgICAgICBpZiAnYmdwX25icl9hbGVydCcgbm90IGluIHNlbGYudmFyaWFibGVzLmtleXMoKToKICAgICAgICAgICAgc2VsZi52YXJpYWJsZXNbJ2JncF9uYnJfYWxlcnQnXSA9ICJmYWxzZSIKICAgICAgICBpZiAnbW9uaXRvcmluZ19yZXN1bWVfdGltZScgbm90IGluIHNlbGYudmFyaWFibGVzLmtleXMoKToKICAgICAgICAgICAgc2VsZi52YXJpYWJsZXNbJ21vbml0b3JpbmdfcmVzdW1lX3RpbWUnXSA9IHN0cigwKQoKICAgIGRlZiByb3V0aW5nX2JncF9oZWFsdGhfcG9sbGVyKHNlbGYsIGV2ZW50KToKICAgICAgICAnJyd0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBldmVyeSBwb2xsIGN5Y2xlIHRvIGNvbGxlY3QgQkdQIGRhdGEnJycKICAgICAgICAjIGRwcmludCgiV0lQLS0tLS0tLXJvdXRpbmdfYmdwX2hlYWx0aF9wb2xsZXIiLCBldmVudCkKICAgICAgICB0aW1lMCA9IDAKICAgICAgICB0aW1lMSA9IDAKICAgICAgICBkYXRlX3RpbWUgPSBkYXRldGltZS5ub3coKQogICAgICAgIGN1cnJlbnRfdGltZSA9IGludChkYXRlX3RpbWUudGltZXN0YW1wKCkpCiAgICAgICAgaWYgY3VycmVudF90aW1lIDwgaW50KHNlbGYudmFyaWFibGVzWydtb25pdG9yaW5nX3Jlc3VtZV90aW1lJ10pOgogICAgICAgICAgICBkcHJpbnQoIk1vbml0b3JpbmcgcGF1c2VkIGR1ZSB0byBoaWdoIGNwdSBVdGlsaXphdGlvbiIpCiAgICAgICAgICAgIGRwcmludCgiV2lsbCByZXN1bWUgaW4ge30gc2Vjb25kcyIuZm9ybWF0KAogICAgICAgICAgICAgICAgaW50KHNlbGYudmFyaWFibGVzWydtb25pdG9yaW5nX3Jlc3VtZV90aW1lJ10pLWN1cnJlbnRfdGltZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGltZTAgPSBjbG9ja19nZXR0aW1lKENMT0NLX1BST0NFU1NfQ1BVVElNRV9JRCkKICAgICAgICAgICAgc2VsZi5iZ3BfYWdlbnQuYmdwX2hhbmRsZXIoKQogICAgICAgICAgICBzZWxmLnJvdXRpbmdfaGVhbHRoX3NldF9hbGVydCgpCiAgICAgICAgICAgIHNlbGYuZXhlY3V0ZV9iZ3BfYWN0aW9uX2NsaSgpCiAgICAgICAgICAgIHRpbWUxID0gY2xvY2tfZ2V0dGltZShDTE9DS19QUk9DRVNTX0NQVVRJTUVfSUQpCgogICAgICAgIGRwcmludCgiVGltZSBSZXBvcnQsIEJHUCAgOiB7fSBzZWNvbmRzIi5mb3JtYXQodGltZTEtdGltZTApKQoKICAgIGRlZiByb3V0aW5nX2hlYWx0aF9zZXRfYWxlcnQoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgY2FsbGVycyBtdXN0IGZpcnN0IHNldCBvbmUgb2YgdGhlc2UgdmFyaWFibGVzOgogICAgICAgICAgICBzZWxmLnZhcmlhYmxlcy5rZXlzWydiZ3BfYWxlcnQnXQogICAgICAgIFRoZW4sIGEgc3Vic2VxdWVudCBjYWxsIHRvIHRoaXMgZnVuY3Rpb24gd2lsbCBzZXQgdGhpcyBhZ2VudHMKICAgICAgICBBbGVydExldmVsIHRvIHRoZSBoaWdoZXN0IGxldmVsIGFtb25nIHRoZSBjaG9pY2VzLgogICAgICAgICIiIgogICAgICAgIGRwcmludCgiV0lQIC0tLSByb3V0aW5nX2hlYWx0aF9zZXRfYWxlcnQiKQogICAgICAgICMgY29sbGVjdCB0aGUgYWxlcnQgcG9zc2liaWxpdGllcyBpbnRvIGEgc2ltcGxlIGxpc3QKICAgICAgICBkcHJpbnQoImFsZXJ0X2xldmVsc19nZW5lcmF0ZWRfd2l0aGluX3BvbGxfYmdwIikKICAgICAgICBkcHJpbnQoc2VsZi5hbGVydF9sZXZlbHNfZ2VuZXJhdGVkX3dpdGhpbl9wb2xsX2JncCkKICAgICAgICBjdXJyZW50ID0gQWxlcnRfZS5pbmRleChzZWxmLnZhcmlhYmxlc1snY3VycmVudF9hbGVydCddKQogICAgICAgIHNlbGYudmFyaWFibGVzWydiZ3BfYWxlcnQnXSA9IGN1cnJlbnQgaWYgXAogICAgICAgICAgICBzZWxmLmFsZXJ0X2xldmVsc19nZW5lcmF0ZWRfd2l0aGluX3BvbGxfYmdwID09IHNldCgpIGVsc2UgXAogICAgICAgICAgICBtYXgoc2VsZi5hbGVydF9sZXZlbHNfZ2VuZXJhdGVkX3dpdGhpbl9wb2xsX2JncCkKICAgICAgICBiZ3BfYWxlcnRfbGV2ZWwgPSBzZWxmLnZhcmlhYmxlc1snYmdwX2FsZXJ0J10KICAgICAgICBjcHVfYWxlcnRfbGV2ZWwgPSBBbGVydF9lLmluZGV4KHNlbGYudmFyaWFibGVzWydjcHVfYWxlcnQnXSkKCiAgICAgICAgYWxlcnRzID0gW2JncF9hbGVydF9sZXZlbCwKICAgICAgICAgICAgICAgICAgY3B1X2FsZXJ0X2xldmVsXQoKICAgICAgICBkZXNpcmVkX21heCA9IG1heChhbGVydHMpCgogICAgICAgIGRwcmludCgiV0lQIC0tLSBhbGVydHMge306IG1heCB7fTogY3VycmVudCB7fVwKICAgICAgICAgICAgIi5mb3JtYXQoYWxlcnRzLCBkZXNpcmVkX21heCwgY3VycmVudCkpCgogICAgICAgIGlmIGRlc2lyZWRfbWF4ICE9IGN1cnJlbnQ6CiAgICAgICAgICAgICMgcmFpc2UvbG93ZXIgbGV2ZWwgdG8gY3VycmVudCBtYXgKICAgICAgICAgICAgZGVzaXJlZCA9IEFsZXJ0X2VbZGVzaXJlZF9tYXhdCiAgICAgICAgICAgIGRwcmludCgiV0lQIC0tLSByYWlzZSB0byB7fSIuZm9ybWF0KGRlc2lyZWQpKQogICAgICAgICAgICBzZWxmLnNldF9hbGVydF9sZXZlbChkZXNpcmVkKQogICAgICAgICAgICBpZiBkZXNpcmVkID09IEFsZXJ0TGV2ZWwuTk9ORToKICAgICAgICAgICAgICAgIHNlbGYuYWN0aW9uX3N5c2xvZyhMb2cuV0FSTklORywgJ0FsbCBCR1AgcGVlcnMgaGF2ZSByZWFjaGVkICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0VzdGFibGlzaGVkIHN0YXRlJykKICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmRlYnVnKCdBbGwgQkdQIHBlZXJzIGhhdmUgcmVhY2hlZCBFc3RhYmxpc2hlZCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3RhdGUnKQogICAgICAgICAgICBzZWxmLnZhcmlhYmxlc1snY3VycmVudF9hbGVydCddID0gZGVzaXJlZAogICAgICAgICMgZWxzZSBkbyBub3RoaW5nCgogICAgZGVmIGFjdGlvbl9zeXNsb2coc2VsZiwgbGV2ZWwsIG1ldHJpY19hcmdzKToKICAgICAgICAnJyd0aGlzIGZ1bmN0aW9uIGlzIHVzZWQgZm9yIGRpc3BsYXlpbmcgc3lzbG9nIGluIGFsZXJ0IHdpbmRvdycnJwogICAgICAgIGlmIGxldmVsID09IExvZy5ERUJVRzoKICAgICAgICAgICAgc2V2ZXJpdHkgPSBTWVNMT0dfREVCVUcKICAgICAgICBlbGlmIGxldmVsID09IExvZy5JTkZPOgogICAgICAgICAgICBzZXZlcml0eSA9IFNZU0xPR19JTkZPCiAgICAgICAgZWxpZiBsZXZlbCA9PSBMb2cuV0FSTklORzoKICAgICAgICAgICAgc2V2ZXJpdHkgPSBTWVNMT0dfV0FSTklORwogICAgICAgIGVsaWYgbGV2ZWwgPT0gTG9nLkVSUjoKICAgICAgICAgICAgc2V2ZXJpdHkgPSBTWVNMT0dfRVJSCiAgICAgICAgZWxpZiBsZXZlbCA9PSBMb2cuQ1JJVDoKICAgICAgICAgICAgc2V2ZXJpdHkgPSBTWVNMT0dfQ1JJVAogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgd3JvbmcgbGV2ZWwKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIEFjdGlvblN5c2xvZyhtZXRyaWNfYXJncywgc2V2ZXJpdHk9c2V2ZXJpdHkpCgogICAgZGVmIGFjdGlvbl9jbGkoc2VsZiwgY21kcyk6CiAgICAgICAgJycndGhpcyBmdW5jdGlvbiBpcyBhIHdyYXBwZXIgZm9yIEFjdGlvbkNMSSBBUEknJycKICAgICAgICBBY3Rpb25DTEkoY21kcykKCiAgICBkZWYgZmV0Y2hfdXJsKHNlbGYsIHVybCk6CiAgICAgICAgJycndGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGZldGNoIGRhdGEgZm9yIGdpdmVuIFJFU1QgdXJsLiBSZXRyaWVzIEdFVAogICAgICAgICAgIHJlcXVlc3QgaWYgT1ZTREIgaGFzbid0IGJlZW4gcG9wdWxhdGVkJycnCiAgICAgICAgZm9yIGNvdW50IGluIHJhbmdlKDgpOgogICAgICAgICAgICByZXNwb25zZSA9IE5vbmUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzX29iaiA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgICAgICAgICBpZiByZXNfb2JqLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHJlc19vYmouanNvbigpCiAgICAgICAgICAgICAgICBlbGlmIHJlc19vYmouc3RhdHVzX2NvZGUgPT0gNDA0OgogICAgICAgICAgICAgICAgICAgICMgdmFsaWQgdG8gZ2V0IG5vdCBmb3VuZCByZXNwb25zZS4gc2F5IGlmIG5iciBpcyBub3QgdGhlcmUKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgI3NlbGYubG9nZ2VyLmFsZXJ0KCdObyBEYXRhIGF2YWlsYWJsZSBmcm9tIHt9Jy5mb3JtYXQodXJsKSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgICMgc2VsZi5sb2dnZXIuZXJyb3IoImh0dHAgZXJyb3Ige30gIgogICAgICAgICAgICAgICAgICAgICMgICAgICAgICAgICAgICAgICAiV2hpbGUgY29sbGVjdGluZyBkYXRhIHt9IgogICAgICAgICAgICAgICAgICAgICMgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJlc19vYmouc3RhdHVzX2NvZGUsIHVybCkpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBleGNlcHQganNvbi5kZWNvZGVyLkpTT05EZWNvZGVFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgaWYgY291bnQgPCA3OgogICAgICAgICAgICAgICAgICAgIHNsZWVwKDE1KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcigic3lzdGVtIGVycm9yIHdoaWxlIGNvbGxlY3Rpbmcgc3RhdCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZXJyb3I6IHswfXwgdXJsOiB7MX0iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChlLCB1cmwpKQogICAgICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGlmIGNvdW50IDwgNzoKICAgICAgICAgICAgICAgICAgICBzbGVlcCgxNSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoInN5c3RlbSBlcnJvciB3aGlsZSBjb2xsZWN0aW5nIHN0YXQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImVycm9yOiB7MH18IHVybDogezF9IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQoZSwgdXJsKSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoInN5c3RlbSBlcnJvciB7fSBXaGlsZSBjb2xsZWN0aW5nIHN0YXQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHVybCkpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlCgogICAgZGVmIGFjdGlvbl9oaWdoX2NwdShzZWxmLCBldmVudCk6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiBleGVjdXRlcyBhbGVydCBmb3IgSGlnaCBDUFUgdXRpbGl6YXRpb24gYnkKICAgICAgICAgaHBlLXJvdXRpbmcnJycKICAgICAgICBkcHJpbnQoIkhpZ2ggQ1BVIFV0aWxpemF0aW9uIikKICAgICAgICBzZWxmLnZhcmlhYmxlc1snY3B1X2FsZXJ0J10gPSBBbGVydExldmVsLkNSSVRJQ0FMCiAgICAgICAgc2VsZi5yb3V0aW5nX2hlYWx0aF9zZXRfYWxlcnQoKQogICAgICAgIHNlbGYuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgTG9nLldBUk5JTkcsICdIaWdoIENQVSB1dGlsaXphdGlvbiBieSBocGUtcm91dGluZyBkYWVtb24nKQogICAgICAgIHNlbGYuYWN0aW9uX2NsaSgnc2hvdyBzeXN0ZW0gcmVzb3VyY2UtdXRpbGl6YXRpb24gZGFlbW9uIGhwZS1yb3V0aW5nJykKICAgICAgICBkYXRlX3RpbWUgPSBkYXRldGltZS5ub3coKQogICAgICAgIGN1cnJlbnRfdGltZSA9IGludChkYXRlX3RpbWUudGltZXN0YW1wKCkpCiAgICAgICAgc2VsZi52YXJpYWJsZXNbJ21vbml0b3JpbmdfcmVzdW1lX3RpbWUnXSA9IHN0cigKICAgICAgICAgICAgY3VycmVudF90aW1lICsgaW50KHNlbGYucGFyYW1zWydjcHVfY29vbGRvd25faW50ZXJ2YWwnXS52YWx1ZSkpCgogICAgZGVmIGFjdGlvbl9ub3JtYWxfY3B1KHNlbGYsIGV2ZW50KToKICAgICAgICAnJydUaGlzIGZ1bmN0aW9uIGJyaW5ncyBkb3duIGFsZXJ0IHRvIG5vcm1hbCB3aGVuIGhwZS1yb3V0aW5nIGNwdSBpcwogICAgICAgICBiYWNrIHRvIG5vcm1hbCcnJwogICAgICAgIGRwcmludCgnTm9ybWFsIENQVSBVdGlsaXphdGlvbicpCiAgICAgICAgc2VsZi52YXJpYWJsZXNbJ2NwdV9hbGVydCddID0gQWxlcnRMZXZlbC5OT05FCiAgICAgICAgc2VsZi5yb3V0aW5nX2hlYWx0aF9zZXRfYWxlcnQoKQoKICAgIGRlZiBleGVjdXRlX2JncF9hY3Rpb25fY2xpKHNlbGYpOgogICAgICAgICcnJ3RoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBleGVjdXRlIGFjdGlvbiBDTElzIGZvciBCR1AnJycKICAgICAgICBhY3Rpb25zID0gc2VsZi5hY3Rpb25zX2JncAogICAgICAgIGNtZHNfbGlzdCA9IHNvcnRlZChhY3Rpb25zKQogICAgICAgIGRwcmludCgiY21kc19saXN0PSB7MH0iLmZvcm1hdChjbWRzX2xpc3QpKQogICAgICAgIGZvciBjbWQgaW4gY21kc19saXN0OgogICAgICAgICAgICBzZWxmLmFjdGlvbl9jbGkoY21kKQoKCmNsYXNzIFJvdXRpbmdBZ2VudChBZ2VudCk6CiAgICAnJydUaGlzIGNsYXNzIGRlZmluZXMgbW9uaXRvciBmb3IgaHBlLXJvdXRpbmcgQ1BVIHV0aWxpemF0aW9uJycnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFnZW50KToKICAgICAgICBzZWxmLmFnZW50ID0gYWdlbnQKICAgICAgICBjcHVfdXJpX3ZhciA9ICdjcHVfbW9uaXRvcicKICAgICAgICBjcHVfdXJpID0gJy9yZXN0L3YxL3N5c3RlbS9zdWJzeXN0ZW1zLyovKi9kYWVtb25zL2hwZS1yb3V0aW5nPycgXAogICAgICAgICAgICAnYXR0cmlidXRlcz1yZXNvdXJjZV91dGlsaXphdGlvbi5jcHUmZmlsdGVyPW5hbWU6aHBlLXJvdXRpbmcnCiAgICAgICAgY3B1X21vbml0b3IgPSBNb25pdG9yKAogICAgICAgICAgICBjcHVfdXJpLAogICAgICAgICAgICAnKENQVS9NZW1vcnkgdXRpbGl6YXRpb24gaW4gJSknKQogICAgICAgIHNldGF0dHIoc2VsZi5hZ2VudCwgY3B1X3VyaV92YXIsIGNwdV9tb25pdG9yKQoKICAgICAgICBjcHVfcnVsZV92YXIgPSAnY3B1X3J1bGUnCiAgICAgICAgY3B1X3J1bGUgPSBSdWxlKCdIaWdoIENQVSB1dGlsaXphdGlvbiBieSBocGUtcm91dGluZycpCiAgICAgICAgY3B1X3J1bGUuY29uZGl0aW9uKAogICAgICAgICAgICAne30gPj0ge30gZm9yIHt9IHNlY29uZHMnLAogICAgICAgICAgICBbY3B1X21vbml0b3IsCiAgICAgICAgICAgICBzZWxmLmFnZW50LnBhcmFtc1snY3B1X3RocmVzaG9sZCddLAogICAgICAgICAgICAgc2VsZi5hZ2VudC5wYXJhbXNbJ2NwdV90aW1lX2ludGVydmFsJ11dKQogICAgICAgIGNwdV9ydWxlLmFjdGlvbihzZWxmLmFjdGlvbl9oaWdoX2NwdSkKICAgICAgICBjcHVfcnVsZS5jbGVhcl9jb25kaXRpb24oJ3t9IDwge30gZm9yIHt9IHNlY29uZHMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbY3B1X21vbml0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LnBhcmFtc1snY3B1X3RocmVzaG9sZCddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5wYXJhbXNbJ2NwdV90aW1lX2ludGVydmFsJ11dKQogICAgICAgIGNwdV9ydWxlLmNsZWFyX2FjdGlvbihzZWxmLmFjdGlvbl9ub3JtYWxfY3B1KQogICAgICAgIHNldGF0dHIoc2VsZi5hZ2VudCwgY3B1X3J1bGVfdmFyLCBjcHVfcnVsZSkKCgpjbGFzcyBCR1BBZ2VudChBZ2VudCk6CiAgICAnJydUaGlzIGNsYXNzIHBlcmlvZGljYWxseSBjb2xsZWN0cyBCR1AgZGF0YSB1c2luZyBSRVNUIHF1ZXJ5IGFuZAogICAgIEFuYWx5emVzIGl0JycnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFnZW50KToKICAgICAgICBzZWxmLmFnZW50ID0gYWdlbnQKICAgICAgICBzZWxmLmFjdGlvbiA9IHNldCgpCiAgICAgICAgc2VsZi5iZ3BfYWxlcnRfb25fdGhpc19jeWNsZSA9IEZhbHNlCiAgICAgICAgc2VsZi5iZ3BfbmVpZ2hib3Jfbm90X2luX3N0YWJsZV9zdGF0ZSA9IEZhbHNlCiAgICAgICAgc2VsZi51bmlxdWVfdnJmX2Jhc2VfdXJsID0gSFRUUF9BRERSRVNTICsgXAogICAgICAgICAgICAnL3Jlc3QvdjEvc3lzdGVtL3ZyZnMvJyArIFwKICAgICAgICAgICAgc2VsZi5hZ2VudC5wYXJhbXNbJ3ZyZiddLnZhbHVlICsgJy9iZ3Bfcm91dGVycy8qL2JncF9uZWlnaGJvcnMnCgogICAgICAgIHNlbGYudnJmX2xpc3QgPSBbXQoKICAgIGRlZiBiZ3BfaGFuZGxlcihzZWxmKToKICAgICAgICAnJydUaGlzIGZ1bmN0aW9uIGlzIHdyYXBwZXIgZm9yIGhhbmRsZV9iZ3BfZGF0YScnJwogICAgICAgIHNlbGYuaGFuZGxlX2JncF9kYXRhKCkKCiAgICAjIEZ1bmN0aW9uIHRvIHBhcnNlIGJncCByZXNwb25zZSBhbmQgcmV0dXJuIGEgbGlzdCBvZiB1bmlxdWUgdnJmcyBpbiB0aGUKICAgICMgcmVzcG9uc2UKICAgICMgSW5wdXQgUGFyYW1ldGVyczoKICAgICMgcmVzOiBiZ3AgcmVzcG9uc2UganNvbgogICAgIyBPdXRwdXQgUGFyYW1ldGVyczoKICAgICMgdnJmX2xpc3QgOiBsaXN0IG9mIHVuaXF1ZSB2cmZzIGluIHRoZSByZXNwb25zZSBFeC4gWydyZWQnLCdkZWZhdWx0J10KICAgIGRlZiBnZXRfdnJmX2xpc3Qoc2VsZiwgcmVzKToKICAgICAgICAnJydGdW5jdGlvbiB0byBwYXJzZSBiZ3AgcmVzcG9uc2UgYW5kIHJldHVybiBhIGxpc3Qgb2YgdW5pcXVlIHZyZnMKICAgICAgICAgaW4gdGhlIHJlc3BvbnNlJycnCiAgICAgICAgaWYgcmVzIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIHZyZl9zZXQgPSBzZXQoW10pCiAgICAgICAgZm9yIHZyZl9kaWN0IGluIHJlczoKICAgICAgICAgICAgZm9yIGJncF9uYnJfa2V5IGluIHZyZl9kaWN0OgogICAgICAgICAgICAgICAgdnJmID0gdnJmX2RpY3RbYmdwX25icl9rZXldLnNwbGl0KCIvIilbNV0KICAgICAgICAgICAgICAgIHZyZl9zZXQuYWRkKHZyZikKICAgICAgICByZXR1cm4gbGlzdCh2cmZfc2V0KQoKICAgICMgRnVuY3Rpb24gdG8gbW9kaWZ5IGlucHV0IHJlc3BvbnNlIGRpY3QgaW50byBhIHNpbXBsaWZpZWQgZGljdCB3aGljaAogICAgIyBjb250YWlucyB2cmYvYmdwX25icl9hZGRyIGFzIGtleSBhbmQgaXRzIGNvcnJlc3BvbmRpbmcgbmVpZ2hib3IgaW5mbyBhcwogICAgIyB2YWx1ZQoKICAgICMgSW5wdXQgUGFyYW1ldGVycwogICAgIyByZXNwb25zZV9kaWN0IDogQ29udGFpbnMga2V5IGFzIHZyZiBhbmQgdmFsdWUgYXMgYWxsIHRoZSBuZWlnaGJvcnMKICAgICMgRXhhbXBsZToKICAgICMgcmVzcG9uc2VfZGljdCA9IHsKICAgICMgICAgICAgdnJmMTp7CiAgICAjICAgICAgICAgICBuZWlnaGJvcjE6e25laWdoYm9yaW5mb30KICAgICMgICAgICAgICAgIG5laWdoYm9yMjp7bmVpZ2hib3JpbmZvfQogICAgIyAgICAgICB9CiAgICAjICAgICAgIHZyZjI6ewogICAgIyAgICAgICAgICAgbmVpZ2hib3IxOntuZWlnaGJvcmluZm99CiAgICAjICAgICAgICAgICBuZWlnaGJvcjM6e25laWdoYm9yaW5mb30KICAgICMgICAgICAgfQogICAgIyB9CgogICAgIyBPdXRwdXQgUGFyYW1ldGVycwogICAgIyBmaW5hbF9yZXNwb25zZTogQ29uYXRpbnMga2V5IHZyZi9uZWlnaGJvcl9pcF9hZGRyIGFuZCB2YWx1ZSBhcyBuZWlnaGJvcgogICAgIyBpbmZvCiAgICAjIEV4YW1wbGU6CiAgICAjIGZpbmFsX3Jlc3BvbnNlID0gewogICAgIyAgICAgICB2cmYxL25laWdoYm9yMTp7bmVpZ2hib3JpbmZvfQogICAgIyAgICAgICB2cmYxL25laWdoYm9yMjp7bmVpZ2hib3JpbmZvfQogICAgIyAgICAgICB2cmYyL25laWdoYm9yMTp7bmVpZ2hib3JpbmZvfQogICAgIyAgICAgICB2cmYyL25laWdoYm9yMzp7bmVpZ2hib3JpbmZvfQogICAgIyB9CiAgICBkZWYgc2ltcGxpZnlfcmVzcG9uc2Uoc2VsZiwgcmVzcG9uc2VfZGljdCk6CiAgICAgICAgJycnRnVuY3Rpb24gdG8gbW9kaWZ5IGlucHV0IHJlc3BvbnNlIGRpY3QgaW50byBhIHNpbXBsaWZpZWQgZGljdAogICAgICAgICB3aGljaCBjb250YWlucyB2cmYvYmdwX25icl9hZGRyIGFzIGtleSBhbmQgaXRzIGNvcnJlc3BvbmRpbmcgbmVpZ2hib3IKICAgICAgICAgIGluZm8gYXMgdmFsdWUnJycKICAgICAgICB1c2VyX2lucHV0X25laWdoYm9yX2xpc3QgPSAoCiAgICAgICAgICAgIHNlbGYuYWdlbnQucGFyYW1zWydiZ3BfbmVpZ2hib3InXS52YWx1ZSkuc3BsaXQoJywnKQogICAgICAgIGZpbmFsX3Jlc3BvbnNlID0ge30KICAgICAgICBmb3IgdnJmIGluIHJlc3BvbnNlX2RpY3Q6CiAgICAgICAgICAgIGJncF9uZWlnaGJvcnMgPSByZXNwb25zZV9kaWN0W3ZyZl1bMF1bImJncF9uZWlnaGJvcnMiXQogICAgICAgICAgICBmb3IgYmdwX25icl9hZGRyIGluIGJncF9uZWlnaGJvcnM6CiAgICAgICAgICAgICAgICAjIHNraXAgYWRkaW5nIGJncCBwZWVyIGdyb3VwIHRvIGJncCBuZWlnaGJvcnM6CiAgICAgICAgICAgICAgICAjIFJFU1Qgb3V0cHV0IG9mIGJncCBuYnJzIHdpbGwgaGF2ZSB0aGUgaW5kaXZpZHVhbCBiZ3AgbmJycwogICAgICAgICAgICAgICAgIyBhbmQgYW4gZW50cnkgZm9yIGVhY2ggcGVlciBncm91cCB3aGljaCBpcyBjb25maWd1cmVkLgogICAgICAgICAgICAgICAgIyBCR1AgcGVlci1ncm91cCBjb25zaXN0cyBvZiAxIG9yIG1vcmUgYmdwIG5laWdoYm9ycy4gV2UgYXJlCiAgICAgICAgICAgICAgICAjIGFscmVhZHkgbW9uaXRvcmluZyB0aGUgaW5kaXZpZHVhbCBCR1AgbmVpZ2hib3JzIHdoaWNoIGFyZQogICAgICAgICAgICAgICAgIyBwYXJ0IG9mIHBlZXIgZ3JvdXAuIEhlbmNlIG5vIG5lZWQgdG8gbW9uaXRvciB0aGUgcGVlciBncm91cAogICAgICAgICAgICAgICAgIyBlbnRyeS4gQWxzbyB0aGUgcGVlci1ncm91cCBjYW5ub3QgYmUgY29uc2lkZXJlZCBhIEJHUCBuYnIKICAgICAgICAgICAgICAgIGlmIGJncF9uZWlnaGJvcnNbYmdwX25icl9hZGRyXVsiaXNfcGVlcl9ncm91cCJdIGlzIFRydWU6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIHVzZXJfaW5wdXRfbmVpZ2hib3JfbGlzdFswXSA9PSAnKic6CiAgICAgICAgICAgICAgICAgICAgZmluYWxfcmVzcG9uc2VbdnJmKyIvIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9hZGRyXSA9IGJncF9uZWlnaGJvcnNbYmdwX25icl9hZGRyXQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBiZ3BfbmJyX2FkZHIgaW4gdXNlcl9pbnB1dF9uZWlnaGJvcl9saXN0OgogICAgICAgICAgICAgICAgICAgICAgICAjIGRwcmludCgiezB9IHsxfSIuZm9ybWF0KHZyZiwgYmdwX25icl9hZGRyKSkKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxfcmVzcG9uc2VbdnJmKyIvIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfYWRkcl0gPSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmVpZ2hib3JzW2JncF9uYnJfYWRkcl0KICAgICAgICByZXR1cm4gZmluYWxfcmVzcG9uc2UKCiAgICBkZWYgaGFuZGxlX2JncF9kYXRhKHNlbGYpOgogICAgICAgICcnJ0Z1bmN0aW9uIHRvIGZldGNoIGJncCBuZWlnaGJvciByZXNwb25zZSBhbmQgaGFuZGxlIGl0JycnCiAgICAgICAgcmVzcG9uc2VfZGljdCA9IHt9CiAgICAgICAgZmluYWxfcmVzcG9uc2UgPSBOb25lCgogICAgICAgIGlmIHNlbGYuYWdlbnQucGFyYW1zWyd2cmYnXS52YWx1ZSA9PSAiKiI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5hZ2VudC5mZXRjaF91cmwoc2VsZi51bmlxdWVfdnJmX2Jhc2VfdXJsKQogICAgICAgICAgICBkcHJpbnQoInVuaXF1ZV92cmZfYmFzZV91cmw9e30iLmZvcm1hdChzZWxmLnVuaXF1ZV92cmZfYmFzZV91cmwpKQogICAgICAgICAgICBkcHJpbnQoInJlc3BvbnNlIHVuaXF1ZV92cmZfYmFzZV91cmw9e30iLmZvcm1hdChyZXNwb25zZSkpCiAgICAgICAgICAgIHNlbGYudnJmX2xpc3QgPSBzZWxmLmdldF92cmZfbGlzdChyZXNwb25zZSkKICAgICAgICAgICAgZHByaW50KCJ2cmZfbGlzdD17fSIuZm9ybWF0KHNlbGYudnJmX2xpc3QpKQogICAgICAgICAgICBmb3IgdnJmIGluIHNlbGYudnJmX2xpc3Q6CiAgICAgICAgICAgICAgICB2cmZfdXJsID0gSFRUUF9BRERSRVNTICsgJy9yZXN0L3YxL3N5c3RlbS92cmZzLycgKyBcCiAgICAgICAgICAgICAgICAgICAgc3RyKHZyZikgKyAnL2JncF9yb3V0ZXJzLyo/ZGVwdGg9MScKICAgICAgICAgICAgICAgIGRwcmludCgidnJmX3VybD17MH0iLmZvcm1hdCh2cmZfdXJsKSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlX2RpY3RbdnJmXSA9IHNlbGYuYWdlbnQuZmV0Y2hfdXJsKHZyZl91cmwpCiAgICAgICAgICAgIGZpbmFsX3Jlc3BvbnNlID0gc2VsZi5zaW1wbGlmeV9yZXNwb25zZShyZXNwb25zZV9kaWN0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHZyZl91cmwgPSBIVFRQX0FERFJFU1MgKyAnL3Jlc3QvdjEvc3lzdGVtL3ZyZnMvJyArIFwKICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQucGFyYW1zWyd2cmYnXS52YWx1ZSArICcvYmdwX3JvdXRlcnMvKj9kZXB0aD0xJwogICAgICAgICAgICBkcHJpbnQoInZyZl91cmxfcGVyX3ZyZj17MH0iLmZvcm1hdCh2cmZfdXJsKSkKICAgICAgICAgICAgcmVzcG9uc2VfZGljdFtzZWxmLmFnZW50LnBhcmFtc1sndnJmJ10udmFsdWVdID0gXAogICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5mZXRjaF91cmwodnJmX3VybCkKICAgICAgICAgICAgZmluYWxfcmVzcG9uc2UgPSBzZWxmLnNpbXBsaWZ5X3Jlc3BvbnNlKHJlc3BvbnNlX2RpY3QpCgogICAgICAgIHNlbGYuYW5hbHl6ZV9iZ3BfZGF0YShmaW5hbF9yZXNwb25zZSkKCiAgICAgICAgaWYgc2VsZi5iZ3BfYWxlcnRfb25fdGhpc19jeWNsZSAhPSBUcnVlOgogICAgICAgICAgICBpZiBzZWxmLmJncF9uZWlnaGJvcl9ub3RfaW5fc3RhYmxlX3N0YXRlICE9IFRydWU6CiAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmFsZXJ0X2xldmVsc19nZW5lcmF0ZWRfd2l0aGluX3BvbGxfYmdwLmFkZCgKICAgICAgICAgICAgICAgICAgICBBbGVydF9lLmluZGV4KEFsZXJ0TGV2ZWwuTk9ORSkpCgogICAgICAgICcnJwogICAgICAgIFN0cnVjdHVyZSBvZiBCR1AgTmVpZ2hib3IKICAgICAgICB7CiAgICAgICAgICAgICJPUkZfY2FwYWJpbGl0eSI6IHt9LAogICAgICAgICAgICAiT1JGX3ByZWZpeF9saXN0Ijoge30sCiAgICAgICAgICAgICJPUkZfcmVjZWl2ZWRfcHJlZml4X2xpc3QiOiB7fSwKICAgICAgICAgICAgImFjdGl2YXRlIjogewogICAgICAgICAgICAiaXB2NC11bmljYXN0IjogZmFsc2UsCiAgICAgICAgICAgICJpcHY2LXVuaWNhc3QiOiB0cnVlLAogICAgICAgICAgICAibDJ2cG4tZXZwbiI6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhZGRfcGF0aHMiOiB7CiAgICAgICAgICAgICJpcHY0LXVuaWNhc3QiOiAiZGlzYWJsZSIsCiAgICAgICAgICAgICJpcHY2LXVuaWNhc3QiOiAiZGlzYWJsZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFkZF9wYXRoc19hZHZfYmVzdF9uIjogewogICAgICAgICAgICAiaXB2NC11bmljYXN0IjogMSwKICAgICAgICAgICAgImlwdjYtdW5pY2FzdCI6IDEKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFkdmVydGlzZW1lbnRfaW50ZXJ2YWwiOiB7fSwKICAgICAgICAgICAgImFmX3N0YXR1cyI6IHt9LAogICAgICAgICAgICAiYWxsb3dfYXNfaW4iOiB7fSwKICAgICAgICAgICAgImFzcGF0aF9maWx0ZXJzIjoge30sCiAgICAgICAgICAgICJiZmRfZW5hYmxlIjogZmFsc2UsCiAgICAgICAgICAgICJjYXBhYmlsaXRlc19yZWNldmllZCI6IFsKICAgICAgICAgICAgIjQtb2N0ZXQtYXNuIiwKICAgICAgICAgICAgImNpc2NvLXJvdXRlLXJlZnJlc2giLAogICAgICAgICAgICAiZ3JhY2VmdWwtcmVzdGFydCIsCiAgICAgICAgICAgICJtcC1pcHY2LXVuaWNhc3QiLAogICAgICAgICAgICAicm91dGUtcmVmcmVzaCIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgImNhcGFiaWxpdGVzX3NlbnQiOiBbCiAgICAgICAgICAgICI0LW9jdGV0LWFzbiIsCiAgICAgICAgICAgICJjaXNjby1yb3V0ZS1yZWZyZXNoIiwKICAgICAgICAgICAgImdyYWNlZnVsLXJlc3RhcnQiLAogICAgICAgICAgICAibXAtaXB2Ni11bmljYXN0IiwKICAgICAgICAgICAgInJvdXRlLXJlZnJlc2giCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJkZWZhdWx0X29yaWdpbmF0ZSI6IHsKICAgICAgICAgICAgImlwdjQtdW5pY2FzdCI6IGZhbHNlLAogICAgICAgICAgICAiaXB2Ni11bmljYXN0IjogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImRlZmF1bHRfb3JpZ2luYXRlX3JvdXRlX21hcCI6IHt9LAogICAgICAgICAgICAiZWJncF9ob3BfY291bnQiOiAxLAogICAgICAgICAgICAiZmFsbF9vdmVyIjogZmFsc2UsCiAgICAgICAgICAgICJnc2h1dCI6IHsKICAgICAgICAgICAgImxvY2FsX3ByZWYiOiAwLAogICAgICAgICAgICAidGltZXIiOiAxODAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImluYm91bmRfc29mdF9yZWNvbmZpZ3VyYXRpb24iOiB7CiAgICAgICAgICAgICJpcHY0LXVuaWNhc3QiOiBmYWxzZSwKICAgICAgICAgICAgImlwdjYtdW5pY2FzdCI6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJpc19wZWVyX2dyb3VwIjogZmFsc2UsCiAgICAgICAgICAgICJsb2NhbF9hc19tb2RlIjogIm5vbmUiLAogICAgICAgICAgICAibG9jYWxfaW50ZXJmYWNlIjogIi9yZXN0L3YxL3N5c3RlbS9wb3J0cy9sb29wYmFjazEiLAogICAgICAgICAgICAibWF4X3ByZWZpeF9vcHRpb25zIjoge30sCiAgICAgICAgICAgICJuZWdvdGlhdGVkX2FkZF9wYXRocyI6IHsKICAgICAgICAgICAgImlwdjQtdW5pY2FzdCI6ICJkaXNhYmxlIiwKICAgICAgICAgICAgImlwdjYtdW5pY2FzdCI6ICJkaXNhYmxlIgogICAgICAgICAgICB9LAogICAgICAgICAgICAibmVnb3RpYXRlZF9ob2xkdGltZSI6IDIwLAogICAgICAgICAgICAibmVnb3RpYXRlZF9rZWVwYWxpdmUiOiA1LAogICAgICAgICAgICAibmV4dF9ob3Bfc2VsZiI6IHsKICAgICAgICAgICAgImlwdjQtdW5pY2FzdCI6IGZhbHNlLAogICAgICAgICAgICAiaXB2Ni11bmljYXN0IjogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgIm5leHRfaG9wX3VuY2hhbmdlZCI6IHsKICAgICAgICAgICAgImwydnBuLWV2cG4iOiBmYWxzZQogICAgICAgICAgICB9LAogICAgICAgICAgICAicGFzc2l2ZSI6IGZhbHNlLAogICAgICAgICAgICAicGVlcl9ydHJpZCI6ICIyLjIuMi4yIiwKICAgICAgICAgICAgInByZWZpeF9saXN0cyI6IHt9LAogICAgICAgICAgICAicmVtb3RlX2FzIjogMjAsCiAgICAgICAgICAgICJyZW1vdmVfcHJpdmF0ZV9hcyI6IGZhbHNlLAogICAgICAgICAgICAicm91dGVfbWFwcyI6IHt9LAogICAgICAgICAgICAicm91dGVfcmVmbGVjdG9yX2NsaWVudCI6IHsKICAgICAgICAgICAgImlwdjQtdW5pY2FzdCI6IGZhbHNlLAogICAgICAgICAgICAiaXB2Ni11bmljYXN0IjogZmFsc2UsCiAgICAgICAgICAgICJsMnZwbi1ldnBuIjogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInNlbF9sb2NhbF9wb3J0IjogNDE0OTksCiAgICAgICAgICAgICJzZWxfcmVtb3RlX3BvcnQiOiAxNzksCiAgICAgICAgICAgICJzZW5kX2NvbW11bml0eSI6IHsKICAgICAgICAgICAgImlwdjQtdW5pY2FzdCI6ICJub25lIiwKICAgICAgICAgICAgImlwdjYtdW5pY2FzdCI6ICJub25lIiwKICAgICAgICAgICAgImwydnBuLWV2cG4iOiAibm9uZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInNodXRkb3duIjogZmFsc2UsCiAgICAgICAgICAgICJzdGF0aXN0aWNzIjogewogICAgICAgICAgICAiYmdwX3BlZXJfZHJvcHBlZF9jb3VudCI6IDAsCiAgICAgICAgICAgICJiZ3BfcGVlcl9lc3RhYmxpc2hlZF9jb3VudCI6IDEsCiAgICAgICAgICAgICJiZ3BfcGVlcl9rZWVwYWxpdmVfaW5fY291bnQiOiAyODY0LAogICAgICAgICAgICAiYmdwX3BlZXJfa2VlcGFsaXZlX291dF9jb3VudCI6IDI4NjIsCiAgICAgICAgICAgICJiZ3BfcGVlcl9ub3RpZnlfaW5fY291bnQiOiAwLAogICAgICAgICAgICAiYmdwX3BlZXJfbm90aWZ5X291dF9jb3VudCI6IDAsCiAgICAgICAgICAgICJiZ3BfcGVlcl9vcGVuX2luX2NvdW50IjogMSwKICAgICAgICAgICAgImJncF9wZWVyX29wZW5fb3V0X2NvdW50IjogMSwKICAgICAgICAgICAgImJncF9wZWVyX3JlZnJlc2hfaW5fY291bnQiOiAwLAogICAgICAgICAgICAiYmdwX3BlZXJfcmVmcmVzaF9vdXRfY291bnQiOiAwLAogICAgICAgICAgICAiYmdwX3BlZXJfdXBkYXRlX2luX2NvdW50IjogMSwKICAgICAgICAgICAgImJncF9wZWVyX3VwZGF0ZV9vdXRfY291bnQiOiAxLAogICAgICAgICAgICAiYmdwX3BlZXJfdXB0aW1lIjogMTI0NjIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInN0YXR1cyI6IHsKICAgICAgICAgICAgImJncF9wZWVyX3N0YXRlIjogIkVzdGFibGlzaGVkIgogICAgICAgICAgICB9LAogICAgICAgICAgICAidGltZXJzIjogewogICAgICAgICAgICAiY29ubmVjdC1yZXRyeSI6IDEyMCwKICAgICAgICAgICAgImhvbGR0aW1lIjogMTgwLAogICAgICAgICAgICAia2VlcGFsaXZlIjogNjAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICB9CiAgICAgICAgJycnCgogICAgIyBGdW5jdGlvbiB0byBhbmFseXplIGJncCByZXNwb25zZQogICAgIyBJbnB1dCBQYXJhbWV0ZXJzCiAgICAjIHJlczogYmdwIHJlc3BvbnNlIGpzb24KICAgIGRlZiBhbmFseXplX2JncF9kYXRhKHNlbGYsIHJlcyk6CiAgICAgICAgJycnRnVuY3Rpb24gdG8gYW5hbHl6ZSBiZ3AgcmVzcG9uc2UnJycKICAgICAgICByZXMgPSB7fSBpZiByZXMgaXMgTm9uZSBlbHNlIHJlcwogICAgICAgIGJncF9uYnJfZGljdF9uZXcgPSB7fQogICAgICAgIGJncF9uYnJfY291bnQgPSAwCiAgICAgICAgZm9yIGJncF9uYnJfa2V5IGluIHJlczoKICAgICAgICAgICAgYmdwX25icl9jb3VudCArPSAxCiAgICAgICAgICAgIGJncF9wZWVyX3N0YXRlID0gcmVzW2JncF9uYnJfa2V5XVsic3RhdHVzIl1bImJncF9wZWVyX3N0YXRlIl0KICAgICAgICAgICAgZHByaW50KCJiZ3BfbmJyX2tleT17MH0iLmZvcm1hdChiZ3BfbmJyX2tleSkpCiAgICAgICAgICAgIGRwcmludCgicmVzW2JncF9uYnJfa2V5XVsiInN0YXR1cyIiXVsiImJncF9wZWVyX3N0YXRlIiJdPXswfSIuZm9ybWF0KAogICAgICAgICAgICAgICAgcmVzW2JncF9uYnJfa2V5XVsic3RhdHVzIl1bImJncF9wZWVyX3N0YXRlIl0pKQogICAgICAgICAgICBiZ3BfcGVlcl91cHRpbWUgPSByZXNbYmdwX25icl9rZXldWyJzdGF0aXN0aWNzIl1bImJncF9wZWVyX3VwdGltZSJdCiAgICAgICAgICAgIGRwcmludCgiYmdwX3BlZXJfdXB0aW1lPXswfSIuZm9ybWF0KAogICAgICAgICAgICAgICAgcmVzW2JncF9uYnJfa2V5XVsic3RhdGlzdGljcyJdKSkKCiAgICAgICAgICAgIGJncF9sb2NhbF9pbnRlcmZhY2UgPSAiTm9uZSIKICAgICAgICAgICAgaWYgJ2xvY2FsX2ludGVyZmFjZScgaW4gcmVzW2JncF9uYnJfa2V5XToKICAgICAgICAgICAgICAgIGJncF9sb2NhbF9pbnRlcmZhY2UgPSBcCiAgICAgICAgICAgICAgICAgICAgcmVzW2JncF9uYnJfa2V5XVsibG9jYWxfaW50ZXJmYWNlIl0uc3BsaXQoIi8iKVstMV0KCiAgICAgICAgICAgIGJncF91cGRhdGVfc291cmNlID0gcmVzW2JncF9uYnJfa2V5XS5nZXQoInVwZGF0ZV9zb3VyY2UiLCAiTm9uZSIpCgogICAgICAgICAgICBiZ3BfcGVlcl9sYXN0X2Vycl9yeCA9IHJlc1tiZ3BfbmJyX2tleV1bInN0YXR1cyJdLmdldCgKICAgICAgICAgICAgICAgICJiZ3BfcmN2ZF9lcnJfY29kZSIsICJObyBFcnJvciIpCgogICAgICAgICAgICBiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfcnggPSByZXNbYmdwX25icl9rZXldWyJzdGF0dXMiXS5nZXQoCiAgICAgICAgICAgICAgICAiYmdwX3JjdmRfZXJyX3N1Yl9jb2RlIiwgIk5vIEVycm9yIikKCiAgICAgICAgICAgIGJncF9wZWVyX2xhc3RfZXJyX3R4ID0gcmVzW2JncF9uYnJfa2V5XVsic3RhdHVzIl0uZ2V0KAogICAgICAgICAgICAgICAgImJncF9zZW50X2Vycl9jb2RlIiwgIk5vIEVycm9yIikKCiAgICAgICAgICAgIGJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCA9IHJlc1tiZ3BfbmJyX2tleV1bInN0YXR1cyJdLmdldCgKICAgICAgICAgICAgICAgICJiZ3Bfc2VudF9lcnJfc3ViX2NvZGUiLCAiTm8gRXJyb3IiKQoKICAgICAgICAgICAgYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQgPSByZXNbYmdwX25icl9rZXldWyJzdGF0aXN0aWNzIl1bCiAgICAgICAgICAgICAgICAiYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQiCiAgICAgICAgICAgIF0KCiAgICAgICAgICAgIGJncF9wZWVyX3N0dWNrX3N0YXRlID0gIk5vbmUiCgogICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XSA9IHsKICAgICAgICAgICAgICAgICJiZ3BfcGVlcl9zdGF0ZSI6IGJncF9wZWVyX3N0YXRlLAogICAgICAgICAgICAgICAgImJncF9wZWVyX3VwdGltZSI6IGJncF9wZWVyX3VwdGltZSwKICAgICAgICAgICAgICAgICJiZ3BfcGVlcl9sYXN0X2Vycl9yeCI6IGJncF9wZWVyX2xhc3RfZXJyX3J4LAogICAgICAgICAgICAgICAgImJncF9wZWVyX2xhc3RfZXJyX3R4IjogYmdwX3BlZXJfbGFzdF9lcnJfdHgsCiAgICAgICAgICAgICAgICAiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4IjogYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4LAogICAgICAgICAgICAgICAgImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCI6IGJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCwKICAgICAgICAgICAgICAgICJiZ3BfcGVlcl9lc3RhYmxpc2hlZF9jb3VudCI6IGJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50LAogICAgICAgICAgICAgICAgImJncF9sb2NhbF9pbnRlcmZhY2UiOiBiZ3BfbG9jYWxfaW50ZXJmYWNlLAogICAgICAgICAgICAgICAgImJncF91cGRhdGVfc291cmNlIjogYmdwX3VwZGF0ZV9zb3VyY2UsCiAgICAgICAgICAgICAgICAiYmdwX3BlZXJfc3R1Y2tfc3RhdGUiOiBiZ3BfcGVlcl9zdHVja19zdGF0ZX0KCiAgICAgICAgYmdwX25icl9kaWN0X29sZCA9IGpzb24ubG9hZHMoc2VsZi5hZ2VudC52YXJpYWJsZXNbImJncF9uYnJfbGlzdCJdKQoKICAgICAgICBkcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCiAgICAgICAgZHByaW50KCdCR1AgZGljdCBvbGQ6JykKICAgICAgICBmb3Iga2V5IGluIGJncF9uYnJfZGljdF9vbGQ6CiAgICAgICAgICAgIGRwcmludCgiezB9OiB7MX0gezJ9Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICBrZXksIGJncF9uYnJfZGljdF9vbGRba2V5XVsnYmdwX2xvY2FsX2ludGVyZmFjZSddLAogICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtrZXldWydiZ3BfdXBkYXRlX3NvdXJjZSddKSkKICAgICAgICBkcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCiAgICAgICAgZHByaW50KCJCR1AgZGljdCBuZXc6IikKICAgICAgICBmb3Iga2V5IGluIGJncF9uYnJfZGljdF9uZXc6CiAgICAgICAgICAgIGRwcmludCgiezB9OiB7MX0gezJ9Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICBrZXksIGJncF9uYnJfZGljdF9uZXdba2V5XVsnYmdwX2xvY2FsX2ludGVyZmFjZSddLAogICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1trZXldWydiZ3BfdXBkYXRlX3NvdXJjZSddKSkKICAgICAgICBkcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCgogICAgICAgIHNlbGYubW9uaXRvcl9iZ3BfbmJyX3N0YXRlX2NoYW5nZXMoYmdwX25icl9kaWN0X29sZCwgYmdwX25icl9kaWN0X25ldykKICAgICAgICBzZWxmLm1vbml0b3JfYmdwX25icl9zdHVjayhiZ3BfbmJyX2RpY3Rfb2xkLCBiZ3BfbmJyX2RpY3RfbmV3KQogICAgICAgIHNlbGYubW9uaXRvcl9iZ3BfbmJyX2ZsYXBzKGJncF9uYnJfZGljdF9vbGQsIGJncF9uYnJfZGljdF9uZXcpCgogICAgICAgIGlmIHNlbGYuYWdlbnQudmFyaWFibGVzWydiZ3BfbmJyX2FsZXJ0J10gPT0gImZhbHNlIjoKICAgICAgICAgICAgc2VsZi5tb25pdG9yX2JncF9uYnJfZXJyb3JzKGJncF9uYnJfZGljdF9vbGQsIGJncF9uYnJfZGljdF9uZXcpCgogICAgICAgICMgQWxsIGNvbW1vbiBCR1AgYWxlcnRzIHRvIGJlIGludm9rZWQgaGVyZQogICAgICAgIGlmIHNlbGYuYWdlbnQudmFyaWFibGVzWydiZ3BfbmJyX2FsZXJ0J10gPT0gInRydWUiOgogICAgICAgICAgICBzZWxmLmFjdGlvbi5hZGQoInNob3cgYmdwIGFsbC12cmYgYWxsIHN1bW1hcnkiKQoKICAgICAgICBzZWxmLmFnZW50LmFjdGlvbnNfYmdwLnVwZGF0ZShzZWxmLmFjdGlvbikKCiAgICAgICAgIyBkcHJpbnQoIlRlc3QgQkdQLVN0YXRlIGNoYW5nZSwgdGltZS1vdXQgYW5kIGVycm9yIGNvZGVzIGZvciIKICAgICAgICAjICAgICAgICAiYWRqYWNlbmN5IikKCiAgICAgICAgc2VsZi5hZ2VudC52YXJpYWJsZXNbJ2JncF9uYnJfbGlzdCddID0ganNvbi5kdW1wcyhiZ3BfbmJyX2RpY3RfbmV3KQogICAgICAgIHNlbGYuYWdlbnQudmFyaWFibGVzWydiZ3BfbmJyX2NvdW50J10gPSBzdHIoYmdwX25icl9jb3VudCkKICAgICAgICBzZWxmLmFnZW50LnZhcmlhYmxlc1snYmdwX25icl9hbGVydCddID0gImZhbHNlIgoKICAgICcnJwogICAgU3RydWN0dXJlIG9mIGJncCBuZWlnaGJvciBkaWN0OgogICAga2V5czogdnJmL2JncF9uYnJfYWRkcgogICAgdmFsdWVzOnsKICAgICAgICBiZ3BfcGVlcl9zdGF0ZSwKICAgICAgICBiZ3BfcGVlcl91cF90aW1lLAogICAgICAgIGJncF9wZWVyX2xhc3RfZXJyX3J4LAogICAgICAgIGJncF9wZWVyX2xhc3RfZXJyX3R4LAogICAgICAgIGJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50LAogICAgICAgIGJncF9wZWVyX2xhc3Rfc3ViX2Vycl9yeCwKICAgICAgICBiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfdHgsCiAgICAgICAgYmdwX3BlZXJfc3R1Y2tfc3RhdGUKICAgIH0KICAgICcnJwoKICAgIGRlZiB1cGRhdGVfYWN0aW9uX2NsaShzZWxmLCBiZ3BfcGVlcl9hZGRyLCB2cmYsIHVwZGF0ZV9zb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlLCBhbGVydF9sZXZlbCk6CiAgICAgICAgJycnRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBhY3Rpb24gQ0xJcyB0byB0aGUgYWN0aW9uIHNldCcnJwogICAgICAgIHNlbGYuYWdlbnQuYWxlcnRfbGV2ZWxzX2dlbmVyYXRlZF93aXRoaW5fcG9sbF9iZ3AuYWRkKAogICAgICAgICAgICBBbGVydF9lLmluZGV4KGFsZXJ0X2xldmVsKSkKICAgICAgICBzZWxmLmFnZW50LnZhcmlhYmxlc1snYmdwX25icl9hbGVydCddID0gInRydWUiCiAgICAgICAgc2VsZi5iZ3BfYWxlcnRfb25fdGhpc19jeWNsZSA9IFRydWUKICAgICAgICBpZiBpc2luc3RhbmNlKGlwX2FkZHJlc3MoYmdwX3BlZXJfYWRkciksIElQdjRBZGRyZXNzKToKICAgICAgICAgICAgc2VsZi5hY3Rpb24uYWRkKCJzaG93IGlwIHJvdXRlIHswfSB2cmYgezF9Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLCB2cmYpKQogICAgICAgICAgICBpZiB1cGRhdGVfc291cmNlICE9ICJOb25lIjoKICAgICAgICAgICAgICAgIHNlbGYuYWN0aW9uLmFkZCgicGluZyB7MH0gc291cmNlIHsxfSB2cmYgezJ9IHJlcGV0aXRpb25zIDIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChiZ3BfcGVlcl9hZGRyLCB1cGRhdGVfc291cmNlLCB2cmYpKQogICAgICAgICAgICBlbGlmIGxvY2FsX2ludGVyZmFjZSAhPSAiTm9uZSI6CiAgICAgICAgICAgICAgICBzZWxmLmFjdGlvbi5hZGQoInBpbmcgezB9IHNvdXJjZSB7MX0gdnJmIHsyfSByZXBldGl0aW9ucyAyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQoYmdwX3BlZXJfYWRkciwgbG9jYWxfaW50ZXJmYWNlLCB2cmYpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5hY3Rpb24uYWRkKCJwaW5nIHswfSB2cmYgezF9IHJlcGV0aXRpb25zIDIiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLCB2cmYpKQogICAgICAgICAgICBzZWxmLmFjdGlvbi5hZGQoInRyYWNlcm91dGUgezB9IHZyZiB7MX0gcHJvYmVzIDEgbWF4dHRsIDYiLmZvcm1hdCgKICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsIHZyZikpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYWN0aW9uLmFkZCgic2hvdyBpcHY2IHJvdXRlIHswfSB2cmYgezF9Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLCB2cmYpKQogICAgICAgICAgICBpZiB1cGRhdGVfc291cmNlICE9ICJOb25lIjoKICAgICAgICAgICAgICAgIHNlbGYuYWN0aW9uLmFkZCgicGluZzYgezB9IHNvdXJjZSB7MX0gdnJmIHsyfSByZXBldGl0aW9ucyAyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQoYmdwX3BlZXJfYWRkciwgdXBkYXRlX3NvdXJjZSwgdnJmKSkKICAgICAgICAgICAgZWxpZiBsb2NhbF9pbnRlcmZhY2UgIT0gIk5vbmUiOgogICAgICAgICAgICAgICAgc2VsZi5hY3Rpb24uYWRkKCJwaW5nNiB7MH0gc291cmNlIHsxfSB2cmYgezJ9IHJlcGV0aXRpb25zIDIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChiZ3BfcGVlcl9hZGRyLCBsb2NhbF9pbnRlcmZhY2UsIHZyZikpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmFjdGlvbi5hZGQoInBpbmc2IHswfSB2cmYgezF9IHJlcGV0aXRpb25zIDIiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLCB2cmYpKQogICAgICAgICAgICBzZWxmLmFjdGlvbi5hZGQoInRyYWNlcm91dGU2IHswfSB2cmYgezF9IHByb2JlcyAxIG1heHR0bCA2Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLCB2cmYpKQoKICAgICMgRnVuY3Rpb24gdG8gbW9uaXRvciBiZ3AgbmVpZ2hib3Igc3RhdGUgY2hhbmdlcwogICAgIyBJbnB1dCBQYXJhbWV0ZXJzCiAgICAjIGJncF9uYnJfZGljdF9vbGQ6IERhdGEgc3RydWN0dXJlIGNvbmF0aW5pbmcgbmVpZ2hib3IgZGljdGlvbmFyeSBvZgogICAgIyBwcmV2aW91cyBjeWNsZQogICAgIyBiZ3BfbmJyX2RpY3RfbmV3OiBEYXRhIHN0cnVjdHVyZSBjb25hdGluaW5nIG5laWdoYm9yIGRpY3Rpb25hcnkgb2YKICAgICMgY3VycmVudCBjeWNsZQogICAgZGVmIG1vbml0b3JfYmdwX25icl9zdGF0ZV9jaGFuZ2VzKHNlbGYsIGJncF9uYnJfZGljdF9vbGQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ldyk6CiAgICAgICAgJycnRnVuY3Rpb24gdG8gbW9uaXRvciBiZ3AgbmVpZ2hib3Igc3RhdGUgY2hhbmdlcycnJwogICAgICAgIGZvciBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3RfbmV3OgogICAgICAgICAgICBpZiBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3Rfb2xkOgogICAgICAgICAgICAgICAgdnJmID0gYmdwX25icl9rZXkuc3BsaXQoIi8iKVswXQogICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciA9IGJncF9uYnJfa2V5LnNwbGl0KCIvIilbMV0KICAgICAgICAgICAgICAgIHVwZGF0ZV9zb3VyY2UgPSBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsnYmdwX3VwZGF0ZV9zb3VyY2UnXQogICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlID0gYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bJ2JncF9sb2NhbF9pbnRlcmZhY2UnXQoKICAgICAgICAgICAgICAgICMgRGV0ZWN0aW5nIGlmIGFueSBCR1AgbmVpZ2hib3IgaXMgbm90IGluIEVzdGFibGlzaGVkIHN0YXRlCiAgICAgICAgICAgICAgICAjIFRoaXMgaXMgbWFpbmx5IGZvciBjbGVhcmluZyB0aGUgYWxlcnQKICAgICAgICAgICAgICAgIGlmIChiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXSAhPQogICAgICAgICAgICAgICAgICAgICAgICAiRXN0YWJsaXNoZWQiKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmJncF9uZWlnaGJvcl9ub3RfaW5fc3RhYmxlX3N0YXRlID0gVHJ1ZQoKICAgICAgICAgICAgICAgICMgRGV0ZWN0aW5nIGEgbmVpZ2hib3IncyBzdGF0ZSBjaGFuZ2UgZnJvbSBlc3RhYmxpc2hlZCB0byBpZGxlCiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICJFc3RhYmxpc2hlZCIKICAgICAgICAgICAgICAgICAgICAgICAgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICJJZGxlIgogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZV9hY3Rpb25fY2xpKGJncF9wZWVyX2FkZHIsIHZyZiwgdXBkYXRlX3NvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsX2ludGVyZmFjZSwgQWxlcnRMZXZlbC5DUklUSUNBTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICdCR1AgUGVlciB7MH0gc3RhdGUgY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvIElkbGUuICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgU2VudCAtIHsxfSAsICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgU3ViIEVycm9yIFNlbnQgLSB7Mn0gLCcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgUmVjZWl2ZWQgLSB7M30gLCAnCiAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBSZWNlaXZlZCAtIHs0fScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3R4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5sb2dnZXIuZGVidWcoCiAgICAgICAgICAgICAgICAgICAgICAgICdGb3IgZGVidWdnaW5nOiBCR1AgUGVlciB7MH0gJwogICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvIElkbGUnLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICAjIERldGVjdGluZyBhIG5laWdoYm9yJ3Mgc3RhdGUgY2hhbmdlIGZyb20gZXN0YWJsaXNoZWQgdG8KICAgICAgICAgICAgICAgICMgY29ubmVjdAogICAgICAgICAgICAgICAgZWxpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICJFc3RhYmxpc2hlZCIKICAgICAgICAgICAgICAgICAgICAgICAgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICJDb25uZWN0IgogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZV9hY3Rpb25fY2xpKGJncF9wZWVyX2FkZHIsIHZyZiwgdXBkYXRlX3NvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsX2ludGVyZmFjZSwgQWxlcnRMZXZlbC5DUklUSUNBTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICJCR1AgUGVlciB7MH0gc3RhdGUgY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvIgogICAgICAgICAgICAgICAgICAgICAgICAiIENvbm5lY3QuICIKICAgICAgICAgICAgICAgICAgICAgICAgIkxhc3QgRXJyb3IgU2VudCAtIHsxfSAiCiAgICAgICAgICAgICAgICAgICAgICAgICJMYXN0IFN1YiBFcnJvciBTZW50IC0gezJ9LCAiCiAgICAgICAgICAgICAgICAgICAgICAgICJMYXN0IEVycm9yIFJlY2VpdmVkIC0gezN9ICIKICAgICAgICAgICAgICAgICAgICAgICAgIkxhc3QgU3ViIEVycm9yIFJlY2VpdmVkIC0gezR9Ii5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmxvZ2dlci5kZWJ1ZygiRm9yIGRlYnVnZ2luZzogQkdQIFBlZXIgezB9ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29ubmVjdCIuZm9ybWF0KGJncF9wZWVyX2FkZHIpKQoKICAgICAgICAgICAgICAgICMgRGV0ZWN0aW5nIGEgbmVpZ2hib3IncyBzdGF0ZSBjaGFuZ2UgZnJvbSBlc3RhYmxpc2hlZCB0bwogICAgICAgICAgICAgICAgIyBhY3RpdmUKICAgICAgICAgICAgICAgIGVsaWYgKAogICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXSA9PQogICAgICAgICAgICAgICAgICAgICAgICAiRXN0YWJsaXNoZWQiCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXSA9PQogICAgICAgICAgICAgICAgICAgICAgICAiQWN0aXZlIgogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZV9hY3Rpb25fY2xpKGJncF9wZWVyX2FkZHIsIHZyZiwgdXBkYXRlX3NvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsX2ludGVyZmFjZSwgQWxlcnRMZXZlbC5DUklUSUNBTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICdCR1AgUGVlciB7MH0gc3RhdGUgY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvJwogICAgICAgICAgICAgICAgICAgICAgICAnIEFjdGl2ZS4gJwogICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBTZW50IC0gezF9ICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgU3ViIEVycm9yIFNlbnQgLSB7Mn0sICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgUmVjZWl2ZWQgLSB7M30gJwogICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBTdWIgRXJyb3IgUmVjZWl2ZWQgLSB7NH0nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3R4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQubG9nZ2VyLmRlYnVnKCJGb3IgZGVidWdnaW5nOiBCR1AgUGVlciB7MH0gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjaGFuZ2VkIGZyb20gRXN0YWJsaXNoZWQgdG8gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBY3RpdmUiLmZvcm1hdChiZ3BfcGVlcl9hZGRyKSkKCiAgICAgICAgICAgICAgICAjIERldGVjdGluZyBhIG5laWdoYm9yJ3Mgc3RhdGUgY2hhbmdlIGZyb20gZXN0YWJsaXNoZWQgdG8KICAgICAgICAgICAgICAgICMgb3BlbmNvbmZpcm0KICAgICAgICAgICAgICAgIGVsaWYgKAogICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXSA9PQogICAgICAgICAgICAgICAgICAgICAgICAiRXN0YWJsaXNoZWQiCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXSA9PQogICAgICAgICAgICAgICAgICAgICAgICAiT3BlbkNvbmZpcm0iCiAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlX2FjdGlvbl9jbGkoYmdwX3BlZXJfYWRkciwgdnJmLCB1cGRhdGVfc291cmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlLCBBbGVydExldmVsLkNSSVRJQ0FMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5hY3Rpb25fc3lzbG9nKAogICAgICAgICAgICAgICAgICAgICAgICBMb2cuV0FSTklORywKICAgICAgICAgICAgICAgICAgICAgICAgJ0JHUCBQZWVyIHswfSBzdGF0ZSBjaGFuZ2VkIGZyb20gRXN0YWJsaXNoZWQgdG8nCiAgICAgICAgICAgICAgICAgICAgICAgICcgT3BlbkNvbmZpcm0uICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgU2VudCAtIHsxfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBTZW50IC0gezJ9LCAnCiAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IEVycm9yIFJlY2VpdmVkIC0gezN9ICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgU3ViIEVycm9yIFJlY2VpdmVkIC0gezR9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmxvZ2dlci5kZWJ1ZygiRm9yIGRlYnVnZ2luZzogQkdQIFBlZXIgezB9ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2hhbmdlZCBmcm9tIEVzdGFibGlzaGVkIHRvICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiT3BlbkNvbmZpcm0iLmZvcm1hdChiZ3BfcGVlcl9hZGRyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKCiAgICAjIEZ1bmN0aW9uIHRvIG1vbml0b3IgYmdwIG5laWdoYm9yIGluIHN0dWNrIHN0YXRlCiAgICAjIElucHV0IFBhcmFtZXRlcnMKICAgICMgYmdwX25icl9kaWN0X29sZDogRGF0YSBzdHJ1Y3R1cmUgY29uYXRpbmluZyBuZWlnaGJvciBkaWN0aW9uYXJ5IG9mCiAgICAjIHByZXZpb3VzIGN5Y2xlCiAgICAjIGJncF9uYnJfZGljdF9uZXc6IERhdGEgc3RydWN0dXJlIGNvbmF0aW5pbmcgbmVpZ2hib3IgZGljdGlvbmFyeSBvZgogICAgIyBjdXJyZW50IGN5Y2xlCiAgICBkZWYgbW9uaXRvcl9iZ3BfbmJyX3N0dWNrKHNlbGYsIGJncF9uYnJfZGljdF9vbGQsIGJncF9uYnJfZGljdF9uZXcpOgogICAgICAgICcnJ0Z1bmN0aW9uIHRvIG1vbml0b3IgYmdwIG5laWdoYm9yIGluIHN0dWNrIHN0YXRlJycnCiAgICAgICAgZm9yIGJncF9uYnJfa2V5IGluIGJncF9uYnJfZGljdF9uZXc6CiAgICAgICAgICAgIGlmIGJncF9uYnJfa2V5IGluIGJncF9uYnJfZGljdF9vbGQ6CiAgICAgICAgICAgICAgICB2cmYgPSBiZ3BfbmJyX2tleS5zcGxpdCgiLyIpWzBdCiAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyID0gYmdwX25icl9rZXkuc3BsaXQoIi8iKVsxXQogICAgICAgICAgICAgICAgdXBkYXRlX3NvdXJjZSA9IGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfdXBkYXRlX3NvdXJjZSJdCiAgICAgICAgICAgICAgICBsb2NhbF9pbnRlcmZhY2UgPSBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsiYmdwX2xvY2FsX2ludGVyZmFjZSJdCgogICAgICAgICAgICAgICAgIyBEZXRlY3RpbmcgYSBuZWlnaGJvciBiZWluZyBzdHVjayBpbiBpZGxlCiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSWRsZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0YXRlIl0gPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJZGxlIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfdXB0aW1lIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgID49IGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfcGVlcl91cHRpbWUiXQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9lc3RhYmxpc2hlZF9jb3VudCJdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA9PSBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9lc3RhYmxpc2hlZF9jb3VudCJdCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfc3R1Y2tfc3RhdGUiXSAhPSAiSWRsZSIKICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZV9hY3Rpb25fY2xpKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZyZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9zb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbF9pbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbGVydExldmVsLkNSSVRJQ0FMLAogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZy5XQVJOSU5HLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0JHUCBQZWVyIHswfSBzdHVjayBpbiBJZGxlIHN0YXRlLiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBTZW50IC0gezF9ICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBTZW50IC0gezJ9LCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBSZWNlaXZlZCAtIHszfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBTdWIgRXJyb3IgUmVjZWl2ZWQgLSB7NH0nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmxvZ2dlci5kZWJ1ZygiRm9yIGRlYnVnZ2luZzogQkdQIFBlZXIgezB9ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInN0dWNrIGluIElkbGUgU3RhdGUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQoYmdwX3BlZXJfYWRkcikpCiAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0dWNrX3N0YXRlIl0gPSBcCiAgICAgICAgICAgICAgICAgICAgICAgICJJZGxlIgogICAgICAgICAgICAgICAgIyBEZXRlY3RpbmcgYSBuZWlnaGJvciBiZWluZyBzdHVjayBpbiBjb25uZWN0CiAgICAgICAgICAgICAgICBlbGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0YXRlIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgID09ICJDb25uZWN0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfc3RhdGUiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPT0gIkNvbm5lY3QiCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgYW5kICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl91cHRpbWUiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPiBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfdXB0aW1lIl0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBhbmQgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50Il0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdICE9ICJDb25uZWN0IgogICAgICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlX2FjdGlvbl9jbGkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlX3NvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsX2ludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFsZXJ0TGV2ZWwuQ1JJVElDQUwsCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5hY3Rpb25fc3lzbG9nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQkdQIFBlZXIgezB9IHN0dWNrIGluIENvbm5lY3Qgc3RhdGUuICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IEVycm9yIFNlbnQgLSB7MX0gJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgU3ViIEVycm9yIFNlbnQgLSB7Mn0sICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IEVycm9yIFJlY2VpdmVkIC0gezN9ICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBSZWNlaXZlZCAtIHs0fScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3R4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5sb2dnZXIuZGVidWcoIkZvciBkZWJ1Z2dpbmc6IEJHUCBQZWVyIHswfSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdHVjayBpbiBDb25uZWN0IFN0YXRlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KGJncF9wZWVyX2FkZHIpKQogICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdID0gXAogICAgICAgICAgICAgICAgICAgICAgICAiQ29ubmVjdCIKICAgICAgICAgICAgICAgICMgRGV0ZWN0aW5nIGEgbmVpZ2hib3IgYmVpbmcgc3R1Y2sgaW4gYWN0aXZlCiAgICAgICAgICAgICAgICBlbGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0YXRlIl0gPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBY3RpdmUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQWN0aXZlIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfdXB0aW1lIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgID4gYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bImJncF9wZWVyX3VwdGltZSJdCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgYW5kICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50Il0KICAgICAgICAgICAgICAgICAgICAgICAgICAgID09IGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50Il0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdICE9ICJBY3RpdmUiCiAgICAgICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGVfYWN0aW9uX2NsaSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2cmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVfc291cmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQWxlcnRMZXZlbC5DUklUSUNBTCwKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmFjdGlvbl9zeXNsb2coCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2cuV0FSTklORywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCR1AgUGVlciB7MH0gc3R1Y2sgaW4gQWN0aXZlIHN0YXRlLiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBTZW50IC0gezF9ICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBTZW50IC0gezJ9LCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBSZWNlaXZlZCAtIHszfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBTdWIgRXJyb3IgUmVjZWl2ZWQgLSB7NH0nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQubG9nZ2VyLmRlYnVnKCJGb3IgZGVidWdnaW5nOiBCR1AgUGVlciB7MH0gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3R1Y2sgaW4gQWN0aXZlIFN0YXRlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KGJncF9wZWVyX2FkZHIpKQogICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdID0gXAogICAgICAgICAgICAgICAgICAgICAgICAiQWN0aXZlIgogICAgICAgICAgICAgICAgIyBEZXRlY3RpbmcgYSBuZWlnaGJvciBiZWluZyBzdHVjayBpbiBvcGVuQ29uZmlybQogICAgICAgICAgICAgICAgZWxpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiT3BlbkNvbmZpcm0iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdGF0ZSJdID09CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiT3BlbkNvbmZpcm0iCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgYW5kICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl91cHRpbWUiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPiBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsiYmdwX3BlZXJfdXB0aW1lIl0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBhbmQgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2VzdGFibGlzaGVkX2NvdW50Il0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdICE9ICJPcGVuQ29uZmlybSIKICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZV9hY3Rpb25fY2xpKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZyZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9zb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbF9pbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbGVydExldmVsLkNSSVRJQ0FMLAogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZy5XQVJOSU5HLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0JHUCBQZWVyIHswfSBzdHVjayBpbiBPcGVuQ29uZmlybSBzdGF0ZS4gJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgU2VudCAtIHsxfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBTdWIgRXJyb3IgU2VudCAtIHsyfSwgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgRXJyb3IgUmVjZWl2ZWQgLSB7M30gJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xhc3QgU3ViIEVycm9yIFJlY2VpdmVkIC0gezR9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3R4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmxvZ2dlci5kZWJ1ZygiRm9yIGRlYnVnZ2luZzogQkdQIFBlZXIgezB9ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInN0dWNrIGluIE9wZW5Db25maXJtIFN0YXRlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KGJncF9wZWVyX2FkZHIpKQogICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldWyJiZ3BfcGVlcl9zdHVja19zdGF0ZSJdID0gXAogICAgICAgICAgICAgICAgICAgICAgICAiT3BlbkNvbmZpcm0iCgogICAgIyBGdW5jdGlvbiB0byBtb25pdG9yIGJncCBuZWlnaGJvciBmbGFwcGluZwogICAgIyBJbnB1dCBQYXJhbWV0ZXJzCiAgICAjIGJncF9uYnJfZGljdF9vbGQ6IERhdGEgc3RydWN0dXJlIGNvbmF0aW5pbmcgbmVpZ2hib3IgZGljdGlvbmFyeSBvZgogICAgIyBwcmV2aW91cyBjeWNsZQogICAgIyBiZ3BfbmJyX2RpY3RfbmV3OiBEYXRhIHN0cnVjdHVyZSBjb25hdGluaW5nIG5laWdoYm9yIGRpY3Rpb25hcnkgb2YKICAgICMgY3VycmVudCBjeWNsZQogICAgZGVmIG1vbml0b3JfYmdwX25icl9mbGFwcyhzZWxmLCBiZ3BfbmJyX2RpY3Rfb2xkLCBiZ3BfbmJyX2RpY3RfbmV3KToKICAgICAgICAnJydGdW5jdGlvbiB0byBtb25pdG9yIGJncCBuZWlnaGJvciBmbGFwcGluZycnJwogICAgICAgIGZvciBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3RfbmV3OgogICAgICAgICAgICBpZiBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3Rfb2xkOgogICAgICAgICAgICAgICAgdnJmID0gYmdwX25icl9rZXkuc3BsaXQoIi8iKVswXQogICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciA9IGJncF9uYnJfa2V5LnNwbGl0KCIvIilbMV0KICAgICAgICAgICAgICAgIHVwZGF0ZV9zb3VyY2UgPSBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XVsnYmdwX3VwZGF0ZV9zb3VyY2UnXQogICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlID0gYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bJ2JncF9sb2NhbF9pbnRlcmZhY2UnXQogICAgICAgICAgICAgICAgIyBEZXRlY3RpbmcgaWYgbmVpZ2hib3IgaXMgZmxhcHBpbmcKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0YXRlIl0gPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFc3RhYmxpc2hlZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV1bImJncF9wZWVyX3N0YXRlIl0gPT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFc3RhYmxpc2hlZCIKICAgICAgICAgICAgICAgICAgICAgICAgKSBhbmQgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfZXN0YWJsaXNoZWRfY291bnQiXQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlX2FjdGlvbl9jbGkoYmdwX3BlZXJfYWRkciwgdnJmLCB1cGRhdGVfc291cmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxfaW50ZXJmYWNlLCBBbGVydExldmVsLk1BSk9SKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICdCR1AgUGVlciB7MH0gYWRqYWNlbmN5IHdlbnQgZG93biBhbmQgY2FtZSBiYWNrIHVwLiAnCiAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IEVycm9yIFNlbnQgLSB7MX0gJwogICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBTdWIgRXJyb3IgU2VudCAtIHsyfSwgJwogICAgICAgICAgICAgICAgICAgICAgICAnTGFzdCBFcnJvciBSZWNlaXZlZCAtIHszfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICdMYXN0IFN1YiBFcnJvciBSZWNlaXZlZCAtIHs0fScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3R4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X3N1Yl9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5sb2dnZXIuZGVidWcoCiAgICAgICAgICAgICAgICAgICAgICAgICdGb3IgZGVidWdnaW5nOiBCR1AgUGVlciB7MH0gYWRqYWNlbmN5IHdlbnQgZG93biAnCiAgICAgICAgICAgICAgICAgICAgICAgICdhbmQgY2FtZSBiYWNrIHVwJy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCgogICAgIyBGdW5jdGlvbiB0byBtb25pdG9yIGJncCBuZWlnaGJvciBlcnJvcnMKICAgICMgSW5wdXQgUGFyYW1ldGVycwogICAgIyBiZ3BfbmJyX2RpY3Rfb2xkOiBEYXRhIHN0cnVjdHVyZSBjb25hdGluaW5nIG5laWdoYm9yIGRpY3Rpb25hcnkgb2YKICAgICMgcHJldmlvdXMgY3ljbGUKICAgICMgYmdwX25icl9kaWN0X25ldzogRGF0YSBzdHJ1Y3R1cmUgY29uYXRpbmluZyBuZWlnaGJvciBkaWN0aW9uYXJ5IG9mCiAgICAjIGN1cnJlbnQgY3ljbGUKICAgIGRlZiBtb25pdG9yX2JncF9uYnJfZXJyb3JzKHNlbGYsIGJncF9uYnJfZGljdF9vbGQsIGJncF9uYnJfZGljdF9uZXcpOgogICAgICAgICcnJ0Z1bmN0aW9uIHRvIG1vbml0b3IgYmdwIG5laWdoYm9yIGVycm9ycycnJwogICAgICAgIGZvciBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3RfbmV3OgogICAgICAgICAgICBpZiBiZ3BfbmJyX2tleSBpbiBiZ3BfbmJyX2RpY3Rfb2xkOgogICAgICAgICAgICAgICAgYmdwX3BlZXJfYWRkciA9IGJncF9uYnJfa2V5LnNwbGl0KCIvIilbMV0KICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIT0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3R4Il0KICAgICAgICAgICAgICAgICAgICAgICAgKSBhbmQgKGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3R4Il0gIT0gIk5vIEVycm9yIikKICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC5hbGVydF9sZXZlbHNfZ2VuZXJhdGVkX3dpdGhpbl9wb2xsX2JncC5hZGQoCiAgICAgICAgICAgICAgICAgICAgICAgIEFsZXJ0X2UuaW5kZXgoQWxlcnRMZXZlbC5NSU5PUikpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZ2VudC52YXJpYWJsZXNbImJncF9uYnJfYWxlcnQiXSA9ICJ0cnVlIgogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWN0aW9uX3N5c2xvZygKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLldBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICdOZXcgRXJyb3Igc2VudCB0byBCR1AgUGVlciB7MH0uICcKICAgICAgICAgICAgICAgICAgICAgICAgJ1ByZXZpb3VzIEVycm9yIFNlbnQgLSB7MX0gJwogICAgICAgICAgICAgICAgICAgICAgICAnUHJldmlvdXMgU3ViIEVycm9yIFNlbnQgLSB7Mn0sICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0N1cnJlbnQgRXJyb3IgU2VudCAtIHszfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICdDdXJyZW50IFN1YiBFcnJvciBTZW50IC0gezR9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3Rfc3ViX2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmxvZ2dlci5kZWJ1ZygKICAgICAgICAgICAgICAgICAgICAgICAgJ0ZvciBkZWJ1Z2dpbmc6IFByZXZpb3VzIEVycm9yIFNlbnQgezB9ICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0N1cnJlbnQgRXJyb3IgU2VudCB7MX0gdG8gQkdQIFBlZXIgezJ9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl90eCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfdHgiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9vbGRbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3J4Il0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICE9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl9yeCJdCiAgICAgICAgICAgICAgICAgICAgICAgICkgYW5kIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSAhPSAiTm8gRXJyb3IiCiAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQuYWxlcnRfbGV2ZWxzX2dlbmVyYXRlZF93aXRoaW5fcG9sbF9iZ3AuYWRkKAogICAgICAgICAgICAgICAgICAgICAgICBBbGVydF9lLmluZGV4KEFsZXJ0TGV2ZWwuTUlOT1IpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQudmFyaWFibGVzWyJiZ3BfbmJyX2FsZXJ0Il0gPSAidHJ1ZSIKICAgICAgICAgICAgICAgICAgICBzZWxmLmFnZW50LmFjdGlvbl9zeXNsb2coCiAgICAgICAgICAgICAgICAgICAgICAgIExvZy5XQVJOSU5HLAogICAgICAgICAgICAgICAgICAgICAgICAnTmV3IEVycm9yIHJlY2VpdmVkIGZyb20gQkdQIFBlZXIgezB9LiAnCiAgICAgICAgICAgICAgICAgICAgICAgICdQcmV2aW91cyBFcnJvciBSZWNlaXZlZCAtIHsxfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICdQcmV2aW91cyBTdWIgRXJyb3IgUmVjZWl2ZWQgLSB7Mn0sICcKICAgICAgICAgICAgICAgICAgICAgICAgJ0N1cnJlbnQgRXJyb3IgUmVjZWl2ZWQgLSB7M30gJwogICAgICAgICAgICAgICAgICAgICAgICAnQ3VycmVudCBTdWIgRXJyb3IgUmVjZWl2ZWQgLSB7NH0nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9wZWVyX2FkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3Rfb2xkW2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfbmJyX2RpY3RfbmV3W2JncF9uYnJfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJiZ3BfcGVlcl9sYXN0X2Vycl9yeCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X25ld1tiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9zdWJfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYWdlbnQubG9nZ2VyLmRlYnVnKAogICAgICAgICAgICAgICAgICAgICAgICAnRm9yIGRlYnVnZ2luZzogUHJldmlvdXMgRXJyb3IgUmVjZWl2ZWQgLSB7MH0gJwogICAgICAgICAgICAgICAgICAgICAgICAnQ3VycmVudCBFcnJvciBSZWNlaXZlZCAtIHsxfSAnCiAgICAgICAgICAgICAgICAgICAgICAgICdmcm9tIEJHUCBQZWVyIHsyfScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdwX25icl9kaWN0X29sZFtiZ3BfbmJyX2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiYmdwX3BlZXJfbGFzdF9lcnJfcngiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJncF9uYnJfZGljdF9uZXdbYmdwX25icl9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImJncF9wZWVyX2xhc3RfZXJyX3J4Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ3BfcGVlcl9hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKQo=
nae-script route_count_monitor false CiMgLSotIGNvZGluZzogdXRmLTggLSotCiMKIyAoYykgQ29weXJpZ2h0IDIwMjIgSGV3bGV0dCBQYWNrYXJkIEVudGVycHJpc2UgRGV2ZWxvcG1lbnQgTFAKIwojIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwojIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KIyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKIwojIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAojIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiMgIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiMgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKIyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiMgdW5kZXIgdGhlIExpY2Vuc2UuCgppbXBvcnQgdHJhY2ViYWNrCmltcG9ydCByZXF1ZXN0cwpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwCgpNYW5pZmVzdCA9IHsKICAgICdOYW1lJzogJ3JvdXRlX2NvdW50X21vbml0b3InLAogICAgJ0Rlc2NyaXB0aW9uJzogJ01vbml0b3JzIHRoZSByb3V0ZSBjb3VudCBvbiB0aGUgc3dpdGNoICcKICAgICAgICAgICAgICAgICAgICdpcyBiZWxvdyB0aGUgY3VzdG9tLWRlZmluZWQgbGltaXRzLiAnCiAgICAgICAgICAgICAgICAgICAnSWYgdGhlIGNvdW50IGV4Y2VlZHMgYSBsaW1pdCwgbm90aWZpY2F0aW9ucyAnCiAgICAgICAgICAgICAgICAgICAnd2lsbCBiZSBzZW50IHJlcGVhdGVkbHkgYXQgYSBjdXN0b20tZGVmaW5lZCByYXRlLicsCiAgICAnVmVyc2lvbic6ICczLjAnLAogICAgJ0F1dGhvcic6ICdBcnViYSBOZXR3b3JrcycsCiAgICAnQU9TQ1hQbGF0Zm9ybUxpc3QnOiBbJzYyMDAnLCAnNjMwMCcsICc2NHh4JywgJzg0MDAnLCAnODMyeCcsICc4MzYwJywgJzkzMDAnLCAnMTAwMDAnXSwKICAgICdBT1NDWFZlcnNpb25NaW4nOiAnMTAuMDcnCn0KClBhcmFtZXRlckRlZmluaXRpb25zID0gewogICAgJ2xpbWl0X2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ1JvdXRlIENvdW50IENyaXRpY2FsIExpbWl0JywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnV2hlbiB0aGUgbnVtYmVyIG9mIHJvdXRlcyBleGNlZWRzICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyBsaW1pdCwgdGhlIGFnZW50IHdpbGwgc2VuZCBhICcKICAgICAgICAgICAgICAgICAgICAgICAnU3lzbG9nIHdhcm5pbmcgYW5kIHNldCB0aGUgYWdlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICdzdGF0dXMgdG8gY3JpdGljYWwuIFN5c2xvZyBtZXNzYWdlcyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgY29udGludWUgdG8gYmUgc2VudCBvbiBhIHJlZ3VsYXInCiAgICAgICAgICAgICAgICAgICAgICAgJ2Jhc2lzIGRlZmluZWQgYnkgbm90aWZpY2F0aW9uX2NyaXRpY2FsLicKICAgICAgICAgICAgICAgICAgICAgICAnT25jZSB0aGUgbnVtYmVyIG9mIHJvdXRlcyBpcyBiZWxvdyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoaXMgdmFsdWUsIHRoZSBhZ2VudCBzdGF0dXMgd2lsbCBiZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3NldCB0byBtYWpvciBvciBub3JtYWwgc3RhdHVzLCBkZXBlbmRpbmcgJwogICAgICAgICAgICAgICAgICAgICAgICdvbiB0aGUgY291bnQgaW4gY29tcGFyaXNvbiB0byBsaW1pdF9tYWpvci4nCiAgICAgICAgICAgICAgICAgICAgICAgJ1RoaXMgdmFsdWUgaXMgZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoYW4gbGltaXRfbWFqb3InLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTUwMDAKICAgIH0sCiAgICAnbGltaXRfbWFqb3InOiB7CiAgICAgICAgJ05hbWUnOiAnUm91dGUgQ291bnQgTWFqb3IgTGltaXQnLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdXaGVuIHRoZSBudW1iZXIgb2Ygcm91dGVzIGV4Y2VlZHMgJwogICAgICAgICAgICAgICAgICAgICAgICd0aGlzIGxpbWl0LCB0aGUgYWdlbnQgd2lsbCBzZW5kIGEgJwogICAgICAgICAgICAgICAgICAgICAgICdTeXNsb2cgd2FybmluZyBhbmQgc2V0IHRoZSBhZ2VudCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cyB0byBtYWpvci4gU3lzbG9nIG1lc3NhZ2VzICcKICAgICAgICAgICAgICAgICAgICAgICAnd2lsbCBjb250aW51ZSB0byBiZSBzZW50IG9uIGEgcmVndWxhcicKICAgICAgICAgICAgICAgICAgICAgICAnYmFzaXMgZGVmaW5lZCBieSBub3RpZmljYXRpb25fbWFqb3IuJwogICAgICAgICAgICAgICAgICAgICAgICdPbmNlIHRoZSBudW1iZXIgb2Ygcm91dGVzIGlzIGJlbG93ICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyB2YWx1ZSwgdGhlIGFnZW50IHN0YXR1cyB3aWxsIGJlJwogICAgICAgICAgICAgICAgICAgICAgICdzZXQgdG8gbm9ybWFsLiBUaGlzIHZhbHVlIGlzIGV4cGVjdGVkICcKICAgICAgICAgICAgICAgICAgICAgICAndG8gYmUgc21hbGxlciB0aGFuIGxpbWl0X2NyaXRpY2FsJywKICAgICAgICAnVHlwZSc6ICdpbnRlZ2VyJywKICAgICAgICAnRGVmYXVsdCc6IDgwMDAKICAgIH0sCiAgICAnbm90aWZpY2F0aW9uX2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ0NyaXRpY2FsIE5vdGlmaWNhdGlvbiBSYXRlIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgYSBzeXNsb2cgbWVzc2FnZSB3aWxsIGJlIHNlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICd3aGVuIHRoZSBhZ2VudCBpcyBpbiBjcml0aWNhbCBzdGF0dXMuIFRoaXMgdmFsdWUgJwogICAgICAgICAgICAgICAgICAgICAgICdpcyBleHBlY3RlZCB0byBiZSBsZXNzIHRoYW4gbm90aWZpY2F0aW9uX21ham9yLCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ2ZvciBtb3JlIGZyZXF1ZW50IG5vdGlmaWNhdGlvbnMuIFRoZSBmaXJzdCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ25vdGlmaWNhdGlvbiBhZnRlciB0aGUgaW5pdGlhbCBldmVudCBtYXkgYmUgdXAgdG8gJwogICAgICAgICAgICAgICAgICAgICAgICdwb2xsX2ludGVydmFsIHRpbWUgbGVzcyB0aGFuIHRoaXMgdmFsdWUuIElmIHRoaXMgJwogICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSBpcyBub3QgYSBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsLCBhY3R1YWwgcmF0ZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgYmUgdGhlIGZpcnN0IG11bHRpcGxlIG9mIHBvbGxfaW50ZXJ2YWwgJwogICAgICAgICAgICAgICAgICAgICAgICdncmVhdGVyIHRoYW4gdGhpcyB2YWx1ZS4gRGVmYXVsdCBpcyAxMjAgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICcoNSBkYXlzKS4nLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTIwCiAgICB9LAogICAgJ25vdGlmaWNhdGlvbl9tYWpvcic6IHsKICAgICAgICAnTmFtZSc6ICdNYWpvciBOb3RpZmljYXRpb24gUmF0ZSAoaW4gaG91cnMpJywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnSG93IG9mdGVuIGluIGhvdXJzIGEgc3lzbG9nIG1lc3NhZ2Ugd2lsbCBiZSBzZW50ICcKICAgICAgICAgICAgICAgICAgICAgICAnd2hlbiB0aGUgYWdlbnQgaXMgaW4gbWFqb3Igc3RhdHVzLiBUaGlzIHZhbHVlIGlzICcKICAgICAgICAgICAgICAgICAgICAgICAnZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciB0aGFuIG5vdGlmaWNhdGlvbl9jcml0aWNhbCwgJwogICAgICAgICAgICAgICAgICAgICAgICdmb3IgbGVzcyBmcmVxdWVudCBub3RpZmljYXRpb25zLiBUaGUgZmlyc3QgJwogICAgICAgICAgICAgICAgICAgICAgICdub3RpZmljYXRpb24gYWZ0ZXIgdGhlIGluaXRpYWwgZXZlbnQgbWF5IGJlIHVwIHRvICcKICAgICAgICAgICAgICAgICAgICAgICAncG9sbF9pbnRlcnZhbCB0aW1lIGxlc3MgdGhhbiB0aGlzIHZhbHVlLiBJZiB0aGlzICcKICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUgaXMgbm90IGEgbXVsdGlwbGUgb2YgcG9sbF9pbnRlcnZhbCwgYWN0dWFsIHJhdGUgJwogICAgICAgICAgICAgICAgICAgICAgICd3aWxsIGJlIHRoZSBmaXJzdCBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsICcKICAgICAgICAgICAgICAgICAgICAgICAnZ3JlYXRlciB0aGFuIHRoaXMgdmFsdWUuIERlZmF1bHQgaXMgMzM2IGhvdXJzICcKICAgICAgICAgICAgICAgICAgICAgICAnKDIgd2Vla3MpLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiAzMzYKICAgIH0sCiAgICAncG9sbF9pbnRlcnZhbCc6IHsKICAgICAgICAnTmFtZSc6ICdQb2xsIEludGVydmFsIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgdG8gcG9sbCB0aGUgcm91dGUgY291bnQuICcKICAgICAgICAgICAgICAgICAgICAgICAnQW4gYWxlcnQgbWF5IG9jY3VyIHVwIHRvIHBvbGxfaW50ZXJ2YWwgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICdhZnRlciB0aGUgcm91dGUgY291bnQgaGFzIGV4Y2VlZGVkIGEgbGltaXQuICcKICAgICAgICAgICAgICAgICAgICAgICAnRGVmYXVsdCBpcyA0IGhvdXJzLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiA0CiAgICB9Cn0KCgpjbGFzcyBQb2xpY3koTkFFKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICB1cmkgPSAnL3Jlc3QvdjEvc3lzdGVtL3ZyZnMvKi9yb3V0ZXM/Y291bnQnCiAgICAgICAgc2VsZi5tMSA9IE1vbml0b3IodXJpLCBuYW1lPSdSb3V0ZSBDb3VudCcpCgogICAgICAgIHNlbGYucjEgPSBSdWxlKCdSb3V0ZSBDb3VudCBNb25pdG9yIENyaXRpY2FsJykKICAgICAgICBzZWxmLnIxLmNvbmRpdGlvbigne30gPiB7fSAnLCBbc2VsZi5tMSwgc2VsZi5wYXJhbXNbImxpbWl0X2NyaXRpY2FsIl1dKQogICAgICAgIHNlbGYucjEuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICBzZWxmLnIyID0gUnVsZSgnUm91dGUgQ291bnQgTW9uaXRvciBNYWpvcicpCiAgICAgICAgc2VsZi5yMi5jb25kaXRpb24oJ3t9ID4ge30gJywgW3NlbGYubTEsIHNlbGYucGFyYW1zWyJsaW1pdF9tYWpvciJdXSkKICAgICAgICBzZWxmLnIyLmFjdGlvbihzZWxmLnJvdXRlX2NvdW50X3BvbGxlcikKCiAgICAgICAgc2VsZi5yMyA9IFJ1bGUoIlJvdXRlIENvdW50IFBvbGxlciIpCiAgICAgICAgc2VsZi5yMy5jb25kaXRpb24oJ2V2ZXJ5IHt9IGhvdXJzJywgW3NlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ11dKQogICAgICAgIHNlbGYucjMuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICAjIHBhcmFtZXRlciB2YWxpZGF0aW9uCiAgICAgICAgcGFyYW1fZXJyb3JzID0gW10KICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ2xpbWl0X21ham9yJ10udmFsdWUgPgogICAgICAgICAgICAgICAgc2VsZi5wYXJhbXNbJ2xpbWl0X2NyaXRpY2FsJ10udmFsdWUpOgogICAgICAgICAgICBwYXJhbV9lcnJvcnMuYXBwZW5kKAogICAgICAgICAgICAgICAgImxpbWl0X21ham9yIG11c3QgYmUgbGVzcyB0aGFuIGxpbWl0X2NyaXRpY2FsLiIKICAgICAgICAgICAgKQoKICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ25vdGlmaWNhdGlvbl9tYWpvciddLnZhbHVlIDwKICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAibm90aWZpY2F0aW9uX21ham9yIG11c3QgYmUgZ3JlYXRlciB0aGFuICIKICAgICAgICAgICAgICAgICJub3RpZmljYXRpb25fY3JpdGljYWwuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHNlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ10udmFsdWUgPD0gMDoKICAgICAgICAgICAgcGFyYW1fZXJyb3JzLmFwcGVuZCgKICAgICAgICAgICAgICAgICJwb2xsX2ludGVydmFsIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAuIgogICAgICAgICAgICApCgogICAgICAgIGlmIChzZWxmLnBhcmFtc1sncG9sbF9pbnRlcnZhbCddLnZhbHVlID4KICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAicG9sbF9pbnRlcnZhbCBpcyB0b28gbGFyZ2UuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHBhcmFtX2Vycm9yczoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdQYXJhbWV0ZXIgZXJyb3JzOiB7fScuZm9ybWF0KCcgJy5qb2luKHBhcmFtX2Vycm9ycykpCiAgICAgICAgICAgICkKCiAgICAgICAgIyBwb2xsX2NvdW50ZXIgd2lsbCBpbmNyZWFzZSBpbiBldmVyeSBjaGVjayB0aGF0IHRoZSBjb3VudCBpcyBpbiBtYWpvcgogICAgICAgICMgb3IgY3JpdGljYWwgc3RhdGUuIEl0IHdpbGwgZ2V0IHJlc2V0IHRvIDAgZXZlcnl0aW1lIGEgc3lzbG9nCiAgICAgICAgIyBtZXNzYWdlIGlzIHNlbnQKICAgICAgICBzZWxmLnZhcmlhYmxlc1sicG9sbF9jb3VudGVyIl0gPSBzdHIoMCkKICAgICAgICBzZWxmLnZhcmlhYmxlc1siY3VycmVudF9hbGVydCJdID0gQWxlcnRMZXZlbC5OT05FCgogICAgZGVmIGdldF9yZXF1ZXN0KHNlbGYsIHVybCwgcmV0cnk9MTIsIHdhaXRfYmV0d2Vlbl9yZXRyaWVzPTEwKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdGhhdCB3aWxsIHRyeSB0byBnZXQgdGhlIHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gKICAgICAgICB0aHJvdWdoIGEgcmVzdCByZXF1ZXN0LiBGdW5jdGlvbiB3aWxsIHJldHJ5IHVwIHRvIDIgbWludXRlcyBpbiBjYXNlCiAgICAgICAgdGhlIGRhdGEgaXMgbm90IGF2YWlsYWJsZS4KCiAgICAgICAgOnBhcmFtIHVybDogdXJsIGZvciB0aGUgcmVzdCByZXF1ZXN0CiAgICAgICAgOnBhcmFtIHJldHJ5OiBudW1iZXIgb2YgdGltZXMgZm9yIHRoZSBmdW5jdGlvbiB0byByZXRyeQogICAgICAgIDpwYXJhbSB3YWl0X2JldHdlZW5fcmV0cmllczogaG93IGxvbmcgdG8gc2xlZXAgaW4gYmV0d2VlbiByZXRyaWVzCiAgICAgICAgOnJldHVybiBkaWN0OiBkYXRhIGZyb20gdGhlIHJlc3QgcmVxdWVzdCBpcyByZXR1cm5lZAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICAgICAgaWYgcmV0cnkgPCAyOgogICAgICAgICAgICAgICAgZXJyb3JfbXNnID0gKAogICAgICAgICAgICAgICAgICAgICJVbmFibGUgdG8gYSBwZXJmb3JtIFJFU1QgR0VUIGNhbGwgdG86ICIgKyB1cmwgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIGlmIGludChyLnN0YXR1c19jb2RlKSAhPSAyMDA6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiUkVTVCBjYWxsOiAiICsgdXJsICsgIlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJldHVybmVkIHdpdGggc3RhdHVzIGNvZGU6ICIgKyBzdHIoci5zdGF0dXNfY29kZSkgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IHIuanNvbigpCiAgICAgICAgZXhjZXB0IGpzb24uZGVjb2Rlci5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiVW5hYmxlIHRvIGNvbnZlcnQgUkVTVCByZXNwb25zZSBpbnRvIEpTT04gZm9ybWF0LlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRyYWNlYmFjazogIiArIHRyYWNlYmFjay5mb3JtYXRfZXhjKCkpCiAgICAgICAgICAgICAgICByYWlzZSBOQUVFeGNlcHRpb24oZXJyb3JfbXNnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2xlZXAod2FpdF9iZXR3ZWVuX3JldHJpZXMpCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfcmVxdWVzdCh1cmwsIHJldHJ5PXJldHJ5LTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0X2JldHdlZW5fcmV0cmllcz13YWl0X2JldHdlZW5fcmV0cmllcykKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgY2hhbmdlX2FsZXJ0X2xldmVsKHNlbGYsIGFsZXJ0X2xldmVsKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGJvdGggdGhlIGFnZW50IHN0YXR1cyBhbmQga2VlcCB0cmFjayBvZgogICAgICAgIHRoZSBzdGF0dXMgd2l0aCB0aGUgbG9jYWwgdmFyaWFibGVzCgogICAgICAgIDpwYXJhbSBhbGVydF9sZXZlbDogYWxlcnRfbGV2ZWwgdG8gYmUgc2V0LCBzaG91bGQgYmUgZnJvbSBjbGFzcyBBbGVydExldmVsCiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHNlbGYuc2V0X2FsZXJ0X2xldmVsKGFsZXJ0X2xldmVsKQogICAgICAgIHNlbGYudmFyaWFibGVzWydjdXJyZW50X2FsZXJ0J10gPSBhbGVydF9sZXZlbAoKICAgIGRlZiByb3V0ZV9jb3VudF9wb2xsZXIoc2VsZiwgZXZlbnQpOgogICAgICAgICIiIgogICAgICAgIE1haW4gYWN0aW9uIGZ1bmN0aW9uOiBHZXRzIHRoZSBjdXJyZW50IHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gsIGFuZAogICAgICAgIGlmIHRoZSBjb3VudCBpcyBoaWdoZXIgdGhhbiBlaXRoZXIgb2YgdGhlIGxpbWl0cyBkZWZpbmVkLCBpdCB3aWxsCiAgICAgICAgZGV0ZXJtaW5lIGlmIHRoZSBhZ2VudCBpcyBhbHJlYWR5IGluIHRoZSBhY2N1cmF0ZSBzdGF0ZS4gSWYgbm90LAogICAgICAgIHRoZSBhbGVydCBsZXZlbCB3aWxsIGJlIGNoYW5nZWQgYW5kIGEgc3lzbG9nIHdhcm5pbmcgbWVzc2FnZSBzZW50CiAgICAgICAgc3RhdGluZyB0aGUgY2hhbmdlIG9mIHJvdXRlIGNvdW50LiBJZiB0aGUgYWdlbnQgaXMgaW4gdGhlIHJpZ2h0IHN0YXRlLAogICAgICAgIGl0IHdpbGwga2VlcCBjb3VudCBvZiB0aGUgYW1vdW50IG9mIHRpbWVzIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkCiAgICAgICAgdW50aWwgYW5vdGhlciBzeXNsb2cgd2FybmluZyBtZXNzYWdlIHNob3VsZCBiZSBzZW50LgoKICAgICAgICA6cGFyYW0gZXZlbnQ6IE5BRSBldmVudCBkaWN0aW9uYXJ5CiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHVyaSA9ICcvcmVzdC92MS9zeXN0ZW0vdnJmcy8qL3JvdXRlcz9jb3VudCcKICAgICAgICByb3V0ZV9jb3VudCA9IHNlbGYuZ2V0X3JlcXVlc3QoSFRUUF9BRERSRVNTICsgdXJpKVsnY291bnQnXQoKICAgICAgICBjdXJyZW50X2FsZXJ0ID0gc2VsZi52YXJpYWJsZXNbJ2N1cnJlbnRfYWxlcnQnXQogICAgICAgIGNvdW50ZXIgPSBpbnQoc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddKQoKICAgICAgICBsaW1pdF9tYWpvciA9IHNlbGYucGFyYW1zWydsaW1pdF9tYWpvciddLnZhbHVlCiAgICAgICAgbGltaXRfY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbGltaXRfY3JpdGljYWwnXS52YWx1ZQoKICAgICAgICBub3RpZmljYXRpb25fbWFqb3IgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX21ham9yJ10udmFsdWUKICAgICAgICBub3RpZmljYXRpb25fY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX2NyaXRpY2FsJ10udmFsdWUKICAgICAgICBwb2xsX2ludGVydmFsID0gc2VsZi5wYXJhbXNbJ3BvbGxfaW50ZXJ2YWwnXS52YWx1ZQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgY3JpdGljYWwgbGltaXQKICAgICAgICBpZiByb3V0ZV9jb3VudCA+IGxpbWl0X2NyaXRpY2FsOgogICAgICAgICAgICAjIExldCB0aGUgQ3JpdGljYWwgbW9uaXRvciBydWxlIGhhbmRsZSB0aGlzIGV2ZW50CiAgICAgICAgICAgIGlmICJNYWpvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgY3JpdGljYWwsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLkNSSVRJQ0FMKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgIEFjdGlvblN5c2xvZygKICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgY3JpdGljYWwgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICMgb3RoZXJ3aXNlLCBpbmNyZWFzZSBjb3VudGVyIGFuZCBjaGVjayBpZiBlbm91Z2ggdGltZSBoYXMgcGFzc2VkCiAgICAgICAgICAgICMgZm9yIGFub3RoZXIgc3lzbG9nLiBPbmx5IGRvIHRoaXMgZm9yIHBvbGxpbmcgZXZlbnRzCiAgICAgICAgICAgIGVsaWYgJ1BvbGxlcicgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIGNvdW50ZXIgKz0gMQogICAgICAgICAgICAgICAgaWYgKGNvdW50ZXIgKiBwb2xsX2ludGVydmFsKSA+PSBub3RpZmljYXRpb25fY3JpdGljYWw6CiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaXMgc3RpbGwgb3ZlciBjcml0aWNhbCBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgbWFqb3IgbGltaXQgb25seQogICAgICAgIGVsaWYgcm91dGVfY291bnQgPiBsaW1pdF9tYWpvcjoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgbWFqb3IsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTUFKT1I6CiAgICAgICAgICAgICAgICAjIHN5c2xvZyBtZXNzYWdlIHdpbGwgdmFyeSBkZXBlbmRpbmcgb24gd2hhdCBzdGF0ZSB0aGUgYWdlbnQKICAgICAgICAgICAgICAgICMgaXMgdHJhbnNpdGlvbmluZyBmcm9tCiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ID09IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICAgICAgaWYgIk1vbml0b3IiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICAgICAgICAgICMgTW9uaXRvciBydWxlIHNob3VsZCBvbmx5IFVQR1JBREUgdGhlIHN0YXRlLCBub3QgZG93bmdyYWRlCiAgICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBldmVudCB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG5leHQgcG9sbGVyIGV2ZW50CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAoCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaGFzIGRyb3BwZWQgYmVsb3cgdGhlIGNyaXRpY2FsICIKICAgICAgICAgICAgICAgICAgICAgICAgImxpbWl0ICh7fSksIGJ1dCBpcyBzdGlsbCBvdmVyIHRoZSBtYWpvciBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCwgbGltaXRfbWFqb3IpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgdGhlIG1ham9yIGxpbWl0ICh7fSkiCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQsIGxpbWl0X21ham9yKQogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLk1BSk9SKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2cobWVzc2FnZSwgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcpCgogICAgICAgICAgICAjIG90aGVyd2lzZSwgaW5jcmVhc2UgY291bnRlciBhbmQgY2hlY2sgaWYgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZAogICAgICAgICAgICAjIGZvciBhbm90aGVyIHN5c2xvZy4gT25seSBkbyB0aGlzIGZvciBwb2xsaW5nIGV2ZW50cwogICAgICAgICAgICBlbGlmICJQb2xsZXIiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICBjb3VudGVyICs9IDEKICAgICAgICAgICAgICAgIGlmIChjb3VudGVyICogcG9sbF9pbnRlcnZhbCkgPj0gbm90aWZpY2F0aW9uX21ham9yOgogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICAgICAgQWN0aW9uU3lzbG9nKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGlzIHN0aWxsIG92ZXIgbWFqb3IgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChyb3V0ZV9jb3VudCwgbGltaXRfbWFqb3IpLAogICAgICAgICAgICAgICAgICAgICAgICBzZXZlcml0eT1TWVNMT0dfV0FSTklORwogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgIyBSb3V0ZSBjb3VudCBpcyB1bmRlciB0aGUgZGVmaW5lZCBsaW1pdHMKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAiTW9uaXRvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgICMgT25seSBhbGxvdyBwb2xsZXIgdG8gaGFuZGxlIHRoaXMgZXZlbnQKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZWxpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTk9ORToKICAgICAgICAgICAgICAgIHNlbGYuY2hhbmdlX2FsZXJ0X2xldmVsKEFsZXJ0TGV2ZWwuTk9ORSkKICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgIkN1cnJlbnQgcm91dGUgY291bnQgKHt9KSBoYXMgZHJvcHBlZCBiZWxvdyBhbGwgbGltaXRzIgogICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQpLAogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICApCiAgICAgICAgc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddID0gc3RyKGNvdW50ZXIpCg==
nae-script route_count_monitor2 false CiMgLSotIGNvZGluZzogdXRmLTggLSotCiMKIyAoYykgQ29weXJpZ2h0IDIwMjIgSGV3bGV0dCBQYWNrYXJkIEVudGVycHJpc2UgRGV2ZWxvcG1lbnQgTFAKIwojIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwojIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KIyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKIwojIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAojIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiMgIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiMgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKIyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiMgdW5kZXIgdGhlIExpY2Vuc2UuCgppbXBvcnQgdHJhY2ViYWNrCmltcG9ydCByZXF1ZXN0cwpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwCgpNYW5pZmVzdCA9IHsKICAgICdOYW1lJzogJ3JvdXRlX2NvdW50X21vbml0b3InLAogICAgJ0Rlc2NyaXB0aW9uJzogJ01vbml0b3JzIHRoZSByb3V0ZSBjb3VudCBvbiB0aGUgc3dpdGNoICcKICAgICAgICAgICAgICAgICAgICdpcyBiZWxvdyB0aGUgY3VzdG9tLWRlZmluZWQgbGltaXRzLiAnCiAgICAgICAgICAgICAgICAgICAnSWYgdGhlIGNvdW50IGV4Y2VlZHMgYSBsaW1pdCwgbm90aWZpY2F0aW9ucyAnCiAgICAgICAgICAgICAgICAgICAnd2lsbCBiZSBzZW50IHJlcGVhdGVkbHkgYXQgYSBjdXN0b20tZGVmaW5lZCByYXRlLicsCiAgICAnVmVyc2lvbic6ICczLjAnLAogICAgJ0F1dGhvcic6ICdBcnViYSBOZXR3b3JrcycsCiAgICAnQU9TQ1hQbGF0Zm9ybUxpc3QnOiBbJzYyMDAnLCAnNjMwMCcsICc2NHh4JywgJzg0MDAnLCAnODMyeCcsICc4MzYwJywgJzkzMDAnLCAnMTAwMDAnXSwKICAgICdBT1NDWFZlcnNpb25NaW4nOiAnMTAuMDcnCn0KClBhcmFtZXRlckRlZmluaXRpb25zID0gewogICAgJ2xpbWl0X2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ1JvdXRlIENvdW50IENyaXRpY2FsIExpbWl0JywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnV2hlbiB0aGUgbnVtYmVyIG9mIHJvdXRlcyBleGNlZWRzICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyBsaW1pdCwgdGhlIGFnZW50IHdpbGwgc2VuZCBhICcKICAgICAgICAgICAgICAgICAgICAgICAnU3lzbG9nIHdhcm5pbmcgYW5kIHNldCB0aGUgYWdlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICdzdGF0dXMgdG8gY3JpdGljYWwuIFN5c2xvZyBtZXNzYWdlcyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgY29udGludWUgdG8gYmUgc2VudCBvbiBhIHJlZ3VsYXInCiAgICAgICAgICAgICAgICAgICAgICAgJ2Jhc2lzIGRlZmluZWQgYnkgbm90aWZpY2F0aW9uX2NyaXRpY2FsLicKICAgICAgICAgICAgICAgICAgICAgICAnT25jZSB0aGUgbnVtYmVyIG9mIHJvdXRlcyBpcyBiZWxvdyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoaXMgdmFsdWUsIHRoZSBhZ2VudCBzdGF0dXMgd2lsbCBiZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3NldCB0byBtYWpvciBvciBub3JtYWwgc3RhdHVzLCBkZXBlbmRpbmcgJwogICAgICAgICAgICAgICAgICAgICAgICdvbiB0aGUgY291bnQgaW4gY29tcGFyaXNvbiB0byBsaW1pdF9tYWpvci4nCiAgICAgICAgICAgICAgICAgICAgICAgJ1RoaXMgdmFsdWUgaXMgZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoYW4gbGltaXRfbWFqb3InLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTUwMDAKICAgIH0sCiAgICAnbGltaXRfbWFqb3InOiB7CiAgICAgICAgJ05hbWUnOiAnUm91dGUgQ291bnQgTWFqb3IgTGltaXQnLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdXaGVuIHRoZSBudW1iZXIgb2Ygcm91dGVzIGV4Y2VlZHMgJwogICAgICAgICAgICAgICAgICAgICAgICd0aGlzIGxpbWl0LCB0aGUgYWdlbnQgd2lsbCBzZW5kIGEgJwogICAgICAgICAgICAgICAgICAgICAgICdTeXNsb2cgd2FybmluZyBhbmQgc2V0IHRoZSBhZ2VudCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cyB0byBtYWpvci4gU3lzbG9nIG1lc3NhZ2VzICcKICAgICAgICAgICAgICAgICAgICAgICAnd2lsbCBjb250aW51ZSB0byBiZSBzZW50IG9uIGEgcmVndWxhcicKICAgICAgICAgICAgICAgICAgICAgICAnYmFzaXMgZGVmaW5lZCBieSBub3RpZmljYXRpb25fbWFqb3IuJwogICAgICAgICAgICAgICAgICAgICAgICdPbmNlIHRoZSBudW1iZXIgb2Ygcm91dGVzIGlzIGJlbG93ICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyB2YWx1ZSwgdGhlIGFnZW50IHN0YXR1cyB3aWxsIGJlJwogICAgICAgICAgICAgICAgICAgICAgICdzZXQgdG8gbm9ybWFsLiBUaGlzIHZhbHVlIGlzIGV4cGVjdGVkICcKICAgICAgICAgICAgICAgICAgICAgICAndG8gYmUgc21hbGxlciB0aGFuIGxpbWl0X2NyaXRpY2FsJywKICAgICAgICAnVHlwZSc6ICdpbnRlZ2VyJywKICAgICAgICAnRGVmYXVsdCc6IDgwMDAKICAgIH0sCiAgICAnbm90aWZpY2F0aW9uX2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ0NyaXRpY2FsIE5vdGlmaWNhdGlvbiBSYXRlIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgYSBzeXNsb2cgbWVzc2FnZSB3aWxsIGJlIHNlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICd3aGVuIHRoZSBhZ2VudCBpcyBpbiBjcml0aWNhbCBzdGF0dXMuIFRoaXMgdmFsdWUgJwogICAgICAgICAgICAgICAgICAgICAgICdpcyBleHBlY3RlZCB0byBiZSBsZXNzIHRoYW4gbm90aWZpY2F0aW9uX21ham9yLCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ2ZvciBtb3JlIGZyZXF1ZW50IG5vdGlmaWNhdGlvbnMuIFRoZSBmaXJzdCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ25vdGlmaWNhdGlvbiBhZnRlciB0aGUgaW5pdGlhbCBldmVudCBtYXkgYmUgdXAgdG8gJwogICAgICAgICAgICAgICAgICAgICAgICdwb2xsX2ludGVydmFsIHRpbWUgbGVzcyB0aGFuIHRoaXMgdmFsdWUuIElmIHRoaXMgJwogICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSBpcyBub3QgYSBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsLCBhY3R1YWwgcmF0ZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgYmUgdGhlIGZpcnN0IG11bHRpcGxlIG9mIHBvbGxfaW50ZXJ2YWwgJwogICAgICAgICAgICAgICAgICAgICAgICdncmVhdGVyIHRoYW4gdGhpcyB2YWx1ZS4gRGVmYXVsdCBpcyAxMjAgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICcoNSBkYXlzKS4nLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTIwCiAgICB9LAogICAgJ25vdGlmaWNhdGlvbl9tYWpvcic6IHsKICAgICAgICAnTmFtZSc6ICdNYWpvciBOb3RpZmljYXRpb24gUmF0ZSAoaW4gaG91cnMpJywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnSG93IG9mdGVuIGluIGhvdXJzIGEgc3lzbG9nIG1lc3NhZ2Ugd2lsbCBiZSBzZW50ICcKICAgICAgICAgICAgICAgICAgICAgICAnd2hlbiB0aGUgYWdlbnQgaXMgaW4gbWFqb3Igc3RhdHVzLiBUaGlzIHZhbHVlIGlzICcKICAgICAgICAgICAgICAgICAgICAgICAnZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciB0aGFuIG5vdGlmaWNhdGlvbl9jcml0aWNhbCwgJwogICAgICAgICAgICAgICAgICAgICAgICdmb3IgbGVzcyBmcmVxdWVudCBub3RpZmljYXRpb25zLiBUaGUgZmlyc3QgJwogICAgICAgICAgICAgICAgICAgICAgICdub3RpZmljYXRpb24gYWZ0ZXIgdGhlIGluaXRpYWwgZXZlbnQgbWF5IGJlIHVwIHRvICcKICAgICAgICAgICAgICAgICAgICAgICAncG9sbF9pbnRlcnZhbCB0aW1lIGxlc3MgdGhhbiB0aGlzIHZhbHVlLiBJZiB0aGlzICcKICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUgaXMgbm90IGEgbXVsdGlwbGUgb2YgcG9sbF9pbnRlcnZhbCwgYWN0dWFsIHJhdGUgJwogICAgICAgICAgICAgICAgICAgICAgICd3aWxsIGJlIHRoZSBmaXJzdCBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsICcKICAgICAgICAgICAgICAgICAgICAgICAnZ3JlYXRlciB0aGFuIHRoaXMgdmFsdWUuIERlZmF1bHQgaXMgMzM2IGhvdXJzICcKICAgICAgICAgICAgICAgICAgICAgICAnKDIgd2Vla3MpLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiAzMzYKICAgIH0sCiAgICAncG9sbF9pbnRlcnZhbCc6IHsKICAgICAgICAnTmFtZSc6ICdQb2xsIEludGVydmFsIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgdG8gcG9sbCB0aGUgcm91dGUgY291bnQuICcKICAgICAgICAgICAgICAgICAgICAgICAnQW4gYWxlcnQgbWF5IG9jY3VyIHVwIHRvIHBvbGxfaW50ZXJ2YWwgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICdhZnRlciB0aGUgcm91dGUgY291bnQgaGFzIGV4Y2VlZGVkIGEgbGltaXQuICcKICAgICAgICAgICAgICAgICAgICAgICAnRGVmYXVsdCBpcyA0IGhvdXJzLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiA0CiAgICB9Cn0KCgpjbGFzcyBQb2xpY3koTkFFKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICB1cmkgPSAnL3Jlc3QvdjEvc3lzdGVtL3ZyZnMvKi9yb3V0ZXM/Y291bnQnCiAgICAgICAgc2VsZi5tMSA9IE1vbml0b3IodXJpLCBuYW1lPSdSb3V0ZSBDb3VudCcpCgogICAgICAgIHNlbGYucjEgPSBSdWxlKCdSb3V0ZSBDb3VudCBNb25pdG9yIENyaXRpY2FsJykKICAgICAgICBzZWxmLnIxLmNvbmRpdGlvbigne30gPiB7fSAnLCBbc2VsZi5tMSwgc2VsZi5wYXJhbXNbImxpbWl0X2NyaXRpY2FsIl1dKQogICAgICAgIHNlbGYucjEuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICBzZWxmLnIyID0gUnVsZSgnUm91dGUgQ291bnQgTW9uaXRvciBNYWpvcicpCiAgICAgICAgc2VsZi5yMi5jb25kaXRpb24oJ3t9ID4ge30gJywgW3NlbGYubTEsIHNlbGYucGFyYW1zWyJsaW1pdF9tYWpvciJdXSkKICAgICAgICBzZWxmLnIyLmFjdGlvbihzZWxmLnJvdXRlX2NvdW50X3BvbGxlcikKCiAgICAgICAgc2VsZi5yMyA9IFJ1bGUoIlJvdXRlIENvdW50IFBvbGxlciIpCiAgICAgICAgc2VsZi5yMy5jb25kaXRpb24oJ2V2ZXJ5IHt9IGhvdXJzJywgW3NlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ11dKQogICAgICAgIHNlbGYucjMuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICAjIHBhcmFtZXRlciB2YWxpZGF0aW9uCiAgICAgICAgcGFyYW1fZXJyb3JzID0gW10KICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ2xpbWl0X21ham9yJ10udmFsdWUgPgogICAgICAgICAgICAgICAgc2VsZi5wYXJhbXNbJ2xpbWl0X2NyaXRpY2FsJ10udmFsdWUpOgogICAgICAgICAgICBwYXJhbV9lcnJvcnMuYXBwZW5kKAogICAgICAgICAgICAgICAgImxpbWl0X21ham9yIG11c3QgYmUgbGVzcyB0aGFuIGxpbWl0X2NyaXRpY2FsLiIKICAgICAgICAgICAgKQoKICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ25vdGlmaWNhdGlvbl9tYWpvciddLnZhbHVlIDwKICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAibm90aWZpY2F0aW9uX21ham9yIG11c3QgYmUgZ3JlYXRlciB0aGFuICIKICAgICAgICAgICAgICAgICJub3RpZmljYXRpb25fY3JpdGljYWwuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHNlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ10udmFsdWUgPD0gMDoKICAgICAgICAgICAgcGFyYW1fZXJyb3JzLmFwcGVuZCgKICAgICAgICAgICAgICAgICJwb2xsX2ludGVydmFsIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAuIgogICAgICAgICAgICApCgogICAgICAgIGlmIChzZWxmLnBhcmFtc1sncG9sbF9pbnRlcnZhbCddLnZhbHVlID4KICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAicG9sbF9pbnRlcnZhbCBpcyB0b28gbGFyZ2UuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHBhcmFtX2Vycm9yczoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdQYXJhbWV0ZXIgZXJyb3JzOiB7fScuZm9ybWF0KCcgJy5qb2luKHBhcmFtX2Vycm9ycykpCiAgICAgICAgICAgICkKCiAgICAgICAgIyBwb2xsX2NvdW50ZXIgd2lsbCBpbmNyZWFzZSBpbiBldmVyeSBjaGVjayB0aGF0IHRoZSBjb3VudCBpcyBpbiBtYWpvcgogICAgICAgICMgb3IgY3JpdGljYWwgc3RhdGUuIEl0IHdpbGwgZ2V0IHJlc2V0IHRvIDAgZXZlcnl0aW1lIGEgc3lzbG9nCiAgICAgICAgIyBtZXNzYWdlIGlzIHNlbnQKICAgICAgICBzZWxmLnZhcmlhYmxlc1sicG9sbF9jb3VudGVyIl0gPSBzdHIoMCkKICAgICAgICBzZWxmLnZhcmlhYmxlc1siY3VycmVudF9hbGVydCJdID0gQWxlcnRMZXZlbC5OT05FCgogICAgZGVmIGdldF9yZXF1ZXN0KHNlbGYsIHVybCwgcmV0cnk9MTIsIHdhaXRfYmV0d2Vlbl9yZXRyaWVzPTEwKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdGhhdCB3aWxsIHRyeSB0byBnZXQgdGhlIHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gKICAgICAgICB0aHJvdWdoIGEgcmVzdCByZXF1ZXN0LiBGdW5jdGlvbiB3aWxsIHJldHJ5IHVwIHRvIDIgbWludXRlcyBpbiBjYXNlCiAgICAgICAgdGhlIGRhdGEgaXMgbm90IGF2YWlsYWJsZS4KCiAgICAgICAgOnBhcmFtIHVybDogdXJsIGZvciB0aGUgcmVzdCByZXF1ZXN0CiAgICAgICAgOnBhcmFtIHJldHJ5OiBudW1iZXIgb2YgdGltZXMgZm9yIHRoZSBmdW5jdGlvbiB0byByZXRyeQogICAgICAgIDpwYXJhbSB3YWl0X2JldHdlZW5fcmV0cmllczogaG93IGxvbmcgdG8gc2xlZXAgaW4gYmV0d2VlbiByZXRyaWVzCiAgICAgICAgOnJldHVybiBkaWN0OiBkYXRhIGZyb20gdGhlIHJlc3QgcmVxdWVzdCBpcyByZXR1cm5lZAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICAgICAgaWYgcmV0cnkgPCAyOgogICAgICAgICAgICAgICAgZXJyb3JfbXNnID0gKAogICAgICAgICAgICAgICAgICAgICJVbmFibGUgdG8gYSBwZXJmb3JtIFJFU1QgR0VUIGNhbGwgdG86ICIgKyB1cmwgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIGlmIGludChyLnN0YXR1c19jb2RlKSAhPSAyMDA6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiUkVTVCBjYWxsOiAiICsgdXJsICsgIlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJldHVybmVkIHdpdGggc3RhdHVzIGNvZGU6ICIgKyBzdHIoci5zdGF0dXNfY29kZSkgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IHIuanNvbigpCiAgICAgICAgZXhjZXB0IGpzb24uZGVjb2Rlci5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiVW5hYmxlIHRvIGNvbnZlcnQgUkVTVCByZXNwb25zZSBpbnRvIEpTT04gZm9ybWF0LlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRyYWNlYmFjazogIiArIHRyYWNlYmFjay5mb3JtYXRfZXhjKCkpCiAgICAgICAgICAgICAgICByYWlzZSBOQUVFeGNlcHRpb24oZXJyb3JfbXNnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2xlZXAod2FpdF9iZXR3ZWVuX3JldHJpZXMpCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfcmVxdWVzdCh1cmwsIHJldHJ5PXJldHJ5LTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0X2JldHdlZW5fcmV0cmllcz13YWl0X2JldHdlZW5fcmV0cmllcykKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgY2hhbmdlX2FsZXJ0X2xldmVsKHNlbGYsIGFsZXJ0X2xldmVsKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGJvdGggdGhlIGFnZW50IHN0YXR1cyBhbmQga2VlcCB0cmFjayBvZgogICAgICAgIHRoZSBzdGF0dXMgd2l0aCB0aGUgbG9jYWwgdmFyaWFibGVzCgogICAgICAgIDpwYXJhbSBhbGVydF9sZXZlbDogYWxlcnRfbGV2ZWwgdG8gYmUgc2V0LCBzaG91bGQgYmUgZnJvbSBjbGFzcyBBbGVydExldmVsCiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHNlbGYuc2V0X2FsZXJ0X2xldmVsKGFsZXJ0X2xldmVsKQogICAgICAgIHNlbGYudmFyaWFibGVzWydjdXJyZW50X2FsZXJ0J10gPSBhbGVydF9sZXZlbAoKICAgIGRlZiByb3V0ZV9jb3VudF9wb2xsZXIoc2VsZiwgZXZlbnQpOgogICAgICAgICIiIgogICAgICAgIE1haW4gYWN0aW9uIGZ1bmN0aW9uOiBHZXRzIHRoZSBjdXJyZW50IHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gsIGFuZAogICAgICAgIGlmIHRoZSBjb3VudCBpcyBoaWdoZXIgdGhhbiBlaXRoZXIgb2YgdGhlIGxpbWl0cyBkZWZpbmVkLCBpdCB3aWxsCiAgICAgICAgZGV0ZXJtaW5lIGlmIHRoZSBhZ2VudCBpcyBhbHJlYWR5IGluIHRoZSBhY2N1cmF0ZSBzdGF0ZS4gSWYgbm90LAogICAgICAgIHRoZSBhbGVydCBsZXZlbCB3aWxsIGJlIGNoYW5nZWQgYW5kIGEgc3lzbG9nIHdhcm5pbmcgbWVzc2FnZSBzZW50CiAgICAgICAgc3RhdGluZyB0aGUgY2hhbmdlIG9mIHJvdXRlIGNvdW50LiBJZiB0aGUgYWdlbnQgaXMgaW4gdGhlIHJpZ2h0IHN0YXRlLAogICAgICAgIGl0IHdpbGwga2VlcCBjb3VudCBvZiB0aGUgYW1vdW50IG9mIHRpbWVzIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkCiAgICAgICAgdW50aWwgYW5vdGhlciBzeXNsb2cgd2FybmluZyBtZXNzYWdlIHNob3VsZCBiZSBzZW50LgoKICAgICAgICA6cGFyYW0gZXZlbnQ6IE5BRSBldmVudCBkaWN0aW9uYXJ5CiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHVyaSA9ICcvcmVzdC92MS9zeXN0ZW0vdnJmcy8qL3JvdXRlcz9jb3VudCcKICAgICAgICByb3V0ZV9jb3VudCA9IHNlbGYuZ2V0X3JlcXVlc3QoSFRUUF9BRERSRVNTICsgdXJpKVsnY291bnQnXQoKICAgICAgICBjdXJyZW50X2FsZXJ0ID0gc2VsZi52YXJpYWJsZXNbJ2N1cnJlbnRfYWxlcnQnXQogICAgICAgIGNvdW50ZXIgPSBpbnQoc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddKQoKICAgICAgICBsaW1pdF9tYWpvciA9IHNlbGYucGFyYW1zWydsaW1pdF9tYWpvciddLnZhbHVlCiAgICAgICAgbGltaXRfY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbGltaXRfY3JpdGljYWwnXS52YWx1ZQoKICAgICAgICBub3RpZmljYXRpb25fbWFqb3IgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX21ham9yJ10udmFsdWUKICAgICAgICBub3RpZmljYXRpb25fY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX2NyaXRpY2FsJ10udmFsdWUKICAgICAgICBwb2xsX2ludGVydmFsID0gc2VsZi5wYXJhbXNbJ3BvbGxfaW50ZXJ2YWwnXS52YWx1ZQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgY3JpdGljYWwgbGltaXQKICAgICAgICBpZiByb3V0ZV9jb3VudCA+IGxpbWl0X2NyaXRpY2FsOgogICAgICAgICAgICAjIExldCB0aGUgQ3JpdGljYWwgbW9uaXRvciBydWxlIGhhbmRsZSB0aGlzIGV2ZW50CiAgICAgICAgICAgIGlmICJNYWpvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgY3JpdGljYWwsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLkNSSVRJQ0FMKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgIEFjdGlvblN5c2xvZygKICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgY3JpdGljYWwgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICMgb3RoZXJ3aXNlLCBpbmNyZWFzZSBjb3VudGVyIGFuZCBjaGVjayBpZiBlbm91Z2ggdGltZSBoYXMgcGFzc2VkCiAgICAgICAgICAgICMgZm9yIGFub3RoZXIgc3lzbG9nLiBPbmx5IGRvIHRoaXMgZm9yIHBvbGxpbmcgZXZlbnRzCiAgICAgICAgICAgIGVsaWYgJ1BvbGxlcicgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIGNvdW50ZXIgKz0gMQogICAgICAgICAgICAgICAgaWYgKGNvdW50ZXIgKiBwb2xsX2ludGVydmFsKSA+PSBub3RpZmljYXRpb25fY3JpdGljYWw6CiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaXMgc3RpbGwgb3ZlciBjcml0aWNhbCBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgbWFqb3IgbGltaXQgb25seQogICAgICAgIGVsaWYgcm91dGVfY291bnQgPiBsaW1pdF9tYWpvcjoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgbWFqb3IsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTUFKT1I6CiAgICAgICAgICAgICAgICAjIHN5c2xvZyBtZXNzYWdlIHdpbGwgdmFyeSBkZXBlbmRpbmcgb24gd2hhdCBzdGF0ZSB0aGUgYWdlbnQKICAgICAgICAgICAgICAgICMgaXMgdHJhbnNpdGlvbmluZyBmcm9tCiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ID09IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICAgICAgaWYgIk1vbml0b3IiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICAgICAgICAgICMgTW9uaXRvciBydWxlIHNob3VsZCBvbmx5IFVQR1JBREUgdGhlIHN0YXRlLCBub3QgZG93bmdyYWRlCiAgICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBldmVudCB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG5leHQgcG9sbGVyIGV2ZW50CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAoCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaGFzIGRyb3BwZWQgYmVsb3cgdGhlIGNyaXRpY2FsICIKICAgICAgICAgICAgICAgICAgICAgICAgImxpbWl0ICh7fSksIGJ1dCBpcyBzdGlsbCBvdmVyIHRoZSBtYWpvciBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCwgbGltaXRfbWFqb3IpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgdGhlIG1ham9yIGxpbWl0ICh7fSkiCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQsIGxpbWl0X21ham9yKQogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLk1BSk9SKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2cobWVzc2FnZSwgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcpCgogICAgICAgICAgICAjIG90aGVyd2lzZSwgaW5jcmVhc2UgY291bnRlciBhbmQgY2hlY2sgaWYgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZAogICAgICAgICAgICAjIGZvciBhbm90aGVyIHN5c2xvZy4gT25seSBkbyB0aGlzIGZvciBwb2xsaW5nIGV2ZW50cwogICAgICAgICAgICBlbGlmICJQb2xsZXIiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICBjb3VudGVyICs9IDEKICAgICAgICAgICAgICAgIGlmIChjb3VudGVyICogcG9sbF9pbnRlcnZhbCkgPj0gbm90aWZpY2F0aW9uX21ham9yOgogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICAgICAgQWN0aW9uU3lzbG9nKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGlzIHN0aWxsIG92ZXIgbWFqb3IgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChyb3V0ZV9jb3VudCwgbGltaXRfbWFqb3IpLAogICAgICAgICAgICAgICAgICAgICAgICBzZXZlcml0eT1TWVNMT0dfV0FSTklORwogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgIyBSb3V0ZSBjb3VudCBpcyB1bmRlciB0aGUgZGVmaW5lZCBsaW1pdHMKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAiTW9uaXRvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgICMgT25seSBhbGxvdyBwb2xsZXIgdG8gaGFuZGxlIHRoaXMgZXZlbnQKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZWxpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTk9ORToKICAgICAgICAgICAgICAgIHNlbGYuY2hhbmdlX2FsZXJ0X2xldmVsKEFsZXJ0TGV2ZWwuTk9ORSkKICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgIkN1cnJlbnQgcm91dGUgY291bnQgKHt9KSBoYXMgZHJvcHBlZCBiZWxvdyBhbGwgbGltaXRzIgogICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQpLAogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICApCiAgICAgICAgc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddID0gc3RyKGNvdW50ZXIpCg==
nae-script route_count_monitor3 false CiMgLSotIGNvZGluZzogdXRmLTggLSotCiMKIyAoYykgQ29weXJpZ2h0IDIwMjIgSGV3bGV0dCBQYWNrYXJkIEVudGVycHJpc2UgRGV2ZWxvcG1lbnQgTFAKIwojIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwojIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KIyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKIwojIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAojIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiMgIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiMgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKIyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiMgdW5kZXIgdGhlIExpY2Vuc2UuCgppbXBvcnQgdHJhY2ViYWNrCmltcG9ydCByZXF1ZXN0cwpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwCgpNYW5pZmVzdCA9IHsKICAgICdOYW1lJzogJ3JvdXRlX2NvdW50X21vbml0b3InLAogICAgJ0Rlc2NyaXB0aW9uJzogJ01vbml0b3JzIHRoZSByb3V0ZSBjb3VudCBvbiB0aGUgc3dpdGNoICcKICAgICAgICAgICAgICAgICAgICdpcyBiZWxvdyB0aGUgY3VzdG9tLWRlZmluZWQgbGltaXRzLiAnCiAgICAgICAgICAgICAgICAgICAnSWYgdGhlIGNvdW50IGV4Y2VlZHMgYSBsaW1pdCwgbm90aWZpY2F0aW9ucyAnCiAgICAgICAgICAgICAgICAgICAnd2lsbCBiZSBzZW50IHJlcGVhdGVkbHkgYXQgYSBjdXN0b20tZGVmaW5lZCByYXRlLicsCiAgICAnVmVyc2lvbic6ICczLjAnLAogICAgJ0F1dGhvcic6ICdBcnViYSBOZXR3b3JrcycsCiAgICAnQU9TQ1hQbGF0Zm9ybUxpc3QnOiBbJzYyMDAnLCAnNjMwMCcsICc2NHh4JywgJzg0MDAnLCAnODMyeCcsICc4MzYwJywgJzkzMDAnLCAnMTAwMDAnXSwKICAgICdBT1NDWFZlcnNpb25NaW4nOiAnMTAuMDcnCn0KClBhcmFtZXRlckRlZmluaXRpb25zID0gewogICAgJ2xpbWl0X2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ1JvdXRlIENvdW50IENyaXRpY2FsIExpbWl0JywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnV2hlbiB0aGUgbnVtYmVyIG9mIHJvdXRlcyBleGNlZWRzICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyBsaW1pdCwgdGhlIGFnZW50IHdpbGwgc2VuZCBhICcKICAgICAgICAgICAgICAgICAgICAgICAnU3lzbG9nIHdhcm5pbmcgYW5kIHNldCB0aGUgYWdlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICdzdGF0dXMgdG8gY3JpdGljYWwuIFN5c2xvZyBtZXNzYWdlcyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgY29udGludWUgdG8gYmUgc2VudCBvbiBhIHJlZ3VsYXInCiAgICAgICAgICAgICAgICAgICAgICAgJ2Jhc2lzIGRlZmluZWQgYnkgbm90aWZpY2F0aW9uX2NyaXRpY2FsLicKICAgICAgICAgICAgICAgICAgICAgICAnT25jZSB0aGUgbnVtYmVyIG9mIHJvdXRlcyBpcyBiZWxvdyAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoaXMgdmFsdWUsIHRoZSBhZ2VudCBzdGF0dXMgd2lsbCBiZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3NldCB0byBtYWpvciBvciBub3JtYWwgc3RhdHVzLCBkZXBlbmRpbmcgJwogICAgICAgICAgICAgICAgICAgICAgICdvbiB0aGUgY291bnQgaW4gY29tcGFyaXNvbiB0byBsaW1pdF9tYWpvci4nCiAgICAgICAgICAgICAgICAgICAgICAgJ1RoaXMgdmFsdWUgaXMgZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3RoYW4gbGltaXRfbWFqb3InLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTUwMDAKICAgIH0sCiAgICAnbGltaXRfbWFqb3InOiB7CiAgICAgICAgJ05hbWUnOiAnUm91dGUgQ291bnQgTWFqb3IgTGltaXQnLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdXaGVuIHRoZSBudW1iZXIgb2Ygcm91dGVzIGV4Y2VlZHMgJwogICAgICAgICAgICAgICAgICAgICAgICd0aGlzIGxpbWl0LCB0aGUgYWdlbnQgd2lsbCBzZW5kIGEgJwogICAgICAgICAgICAgICAgICAgICAgICdTeXNsb2cgd2FybmluZyBhbmQgc2V0IHRoZSBhZ2VudCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cyB0byBtYWpvci4gU3lzbG9nIG1lc3NhZ2VzICcKICAgICAgICAgICAgICAgICAgICAgICAnd2lsbCBjb250aW51ZSB0byBiZSBzZW50IG9uIGEgcmVndWxhcicKICAgICAgICAgICAgICAgICAgICAgICAnYmFzaXMgZGVmaW5lZCBieSBub3RpZmljYXRpb25fbWFqb3IuJwogICAgICAgICAgICAgICAgICAgICAgICdPbmNlIHRoZSBudW1iZXIgb2Ygcm91dGVzIGlzIGJlbG93ICcKICAgICAgICAgICAgICAgICAgICAgICAndGhpcyB2YWx1ZSwgdGhlIGFnZW50IHN0YXR1cyB3aWxsIGJlJwogICAgICAgICAgICAgICAgICAgICAgICdzZXQgdG8gbm9ybWFsLiBUaGlzIHZhbHVlIGlzIGV4cGVjdGVkICcKICAgICAgICAgICAgICAgICAgICAgICAndG8gYmUgc21hbGxlciB0aGFuIGxpbWl0X2NyaXRpY2FsJywKICAgICAgICAnVHlwZSc6ICdpbnRlZ2VyJywKICAgICAgICAnRGVmYXVsdCc6IDgwMDAKICAgIH0sCiAgICAnbm90aWZpY2F0aW9uX2NyaXRpY2FsJzogewogICAgICAgICdOYW1lJzogJ0NyaXRpY2FsIE5vdGlmaWNhdGlvbiBSYXRlIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgYSBzeXNsb2cgbWVzc2FnZSB3aWxsIGJlIHNlbnQgJwogICAgICAgICAgICAgICAgICAgICAgICd3aGVuIHRoZSBhZ2VudCBpcyBpbiBjcml0aWNhbCBzdGF0dXMuIFRoaXMgdmFsdWUgJwogICAgICAgICAgICAgICAgICAgICAgICdpcyBleHBlY3RlZCB0byBiZSBsZXNzIHRoYW4gbm90aWZpY2F0aW9uX21ham9yLCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ2ZvciBtb3JlIGZyZXF1ZW50IG5vdGlmaWNhdGlvbnMuIFRoZSBmaXJzdCAnCiAgICAgICAgICAgICAgICAgICAgICAgJ25vdGlmaWNhdGlvbiBhZnRlciB0aGUgaW5pdGlhbCBldmVudCBtYXkgYmUgdXAgdG8gJwogICAgICAgICAgICAgICAgICAgICAgICdwb2xsX2ludGVydmFsIHRpbWUgbGVzcyB0aGFuIHRoaXMgdmFsdWUuIElmIHRoaXMgJwogICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSBpcyBub3QgYSBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsLCBhY3R1YWwgcmF0ZSAnCiAgICAgICAgICAgICAgICAgICAgICAgJ3dpbGwgYmUgdGhlIGZpcnN0IG11bHRpcGxlIG9mIHBvbGxfaW50ZXJ2YWwgJwogICAgICAgICAgICAgICAgICAgICAgICdncmVhdGVyIHRoYW4gdGhpcyB2YWx1ZS4gRGVmYXVsdCBpcyAxMjAgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICcoNSBkYXlzKS4nLAogICAgICAgICdUeXBlJzogJ2ludGVnZXInLAogICAgICAgICdEZWZhdWx0JzogMTIwCiAgICB9LAogICAgJ25vdGlmaWNhdGlvbl9tYWpvcic6IHsKICAgICAgICAnTmFtZSc6ICdNYWpvciBOb3RpZmljYXRpb24gUmF0ZSAoaW4gaG91cnMpJywKICAgICAgICAnRGVzY3JpcHRpb24nOiAnSG93IG9mdGVuIGluIGhvdXJzIGEgc3lzbG9nIG1lc3NhZ2Ugd2lsbCBiZSBzZW50ICcKICAgICAgICAgICAgICAgICAgICAgICAnd2hlbiB0aGUgYWdlbnQgaXMgaW4gbWFqb3Igc3RhdHVzLiBUaGlzIHZhbHVlIGlzICcKICAgICAgICAgICAgICAgICAgICAgICAnZXhwZWN0ZWQgdG8gYmUgZ3JlYXRlciB0aGFuIG5vdGlmaWNhdGlvbl9jcml0aWNhbCwgJwogICAgICAgICAgICAgICAgICAgICAgICdmb3IgbGVzcyBmcmVxdWVudCBub3RpZmljYXRpb25zLiBUaGUgZmlyc3QgJwogICAgICAgICAgICAgICAgICAgICAgICdub3RpZmljYXRpb24gYWZ0ZXIgdGhlIGluaXRpYWwgZXZlbnQgbWF5IGJlIHVwIHRvICcKICAgICAgICAgICAgICAgICAgICAgICAncG9sbF9pbnRlcnZhbCB0aW1lIGxlc3MgdGhhbiB0aGlzIHZhbHVlLiBJZiB0aGlzICcKICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUgaXMgbm90IGEgbXVsdGlwbGUgb2YgcG9sbF9pbnRlcnZhbCwgYWN0dWFsIHJhdGUgJwogICAgICAgICAgICAgICAgICAgICAgICd3aWxsIGJlIHRoZSBmaXJzdCBtdWx0aXBsZSBvZiBwb2xsX2ludGVydmFsICcKICAgICAgICAgICAgICAgICAgICAgICAnZ3JlYXRlciB0aGFuIHRoaXMgdmFsdWUuIERlZmF1bHQgaXMgMzM2IGhvdXJzICcKICAgICAgICAgICAgICAgICAgICAgICAnKDIgd2Vla3MpLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiAzMzYKICAgIH0sCiAgICAncG9sbF9pbnRlcnZhbCc6IHsKICAgICAgICAnTmFtZSc6ICdQb2xsIEludGVydmFsIChpbiBob3VycyknLAogICAgICAgICdEZXNjcmlwdGlvbic6ICdIb3cgb2Z0ZW4gaW4gaG91cnMgdG8gcG9sbCB0aGUgcm91dGUgY291bnQuICcKICAgICAgICAgICAgICAgICAgICAgICAnQW4gYWxlcnQgbWF5IG9jY3VyIHVwIHRvIHBvbGxfaW50ZXJ2YWwgaG91cnMgJwogICAgICAgICAgICAgICAgICAgICAgICdhZnRlciB0aGUgcm91dGUgY291bnQgaGFzIGV4Y2VlZGVkIGEgbGltaXQuICcKICAgICAgICAgICAgICAgICAgICAgICAnRGVmYXVsdCBpcyA0IGhvdXJzLicsCiAgICAgICAgJ1R5cGUnOiAnaW50ZWdlcicsCiAgICAgICAgJ0RlZmF1bHQnOiA0CiAgICB9Cn0KCgpjbGFzcyBQb2xpY3koTkFFKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICB1cmkgPSAnL3Jlc3QvdjEvc3lzdGVtL3ZyZnMvKi9yb3V0ZXM/Y291bnQnCiAgICAgICAgc2VsZi5tMSA9IE1vbml0b3IodXJpLCBuYW1lPSdSb3V0ZSBDb3VudCcpCgogICAgICAgIHNlbGYucjEgPSBSdWxlKCdSb3V0ZSBDb3VudCBNb25pdG9yIENyaXRpY2FsJykKICAgICAgICBzZWxmLnIxLmNvbmRpdGlvbigne30gPiB7fSAnLCBbc2VsZi5tMSwgc2VsZi5wYXJhbXNbImxpbWl0X2NyaXRpY2FsIl1dKQogICAgICAgIHNlbGYucjEuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICBzZWxmLnIyID0gUnVsZSgnUm91dGUgQ291bnQgTW9uaXRvciBNYWpvcicpCiAgICAgICAgc2VsZi5yMi5jb25kaXRpb24oJ3t9ID4ge30gJywgW3NlbGYubTEsIHNlbGYucGFyYW1zWyJsaW1pdF9tYWpvciJdXSkKICAgICAgICBzZWxmLnIyLmFjdGlvbihzZWxmLnJvdXRlX2NvdW50X3BvbGxlcikKCiAgICAgICAgc2VsZi5yMyA9IFJ1bGUoIlJvdXRlIENvdW50IFBvbGxlciIpCiAgICAgICAgc2VsZi5yMy5jb25kaXRpb24oJ2V2ZXJ5IHt9IGhvdXJzJywgW3NlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ11dKQogICAgICAgIHNlbGYucjMuYWN0aW9uKHNlbGYucm91dGVfY291bnRfcG9sbGVyKQoKICAgICAgICAjIHBhcmFtZXRlciB2YWxpZGF0aW9uCiAgICAgICAgcGFyYW1fZXJyb3JzID0gW10KICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ2xpbWl0X21ham9yJ10udmFsdWUgPgogICAgICAgICAgICAgICAgc2VsZi5wYXJhbXNbJ2xpbWl0X2NyaXRpY2FsJ10udmFsdWUpOgogICAgICAgICAgICBwYXJhbV9lcnJvcnMuYXBwZW5kKAogICAgICAgICAgICAgICAgImxpbWl0X21ham9yIG11c3QgYmUgbGVzcyB0aGFuIGxpbWl0X2NyaXRpY2FsLiIKICAgICAgICAgICAgKQoKICAgICAgICBpZiAoc2VsZi5wYXJhbXNbJ25vdGlmaWNhdGlvbl9tYWpvciddLnZhbHVlIDwKICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAibm90aWZpY2F0aW9uX21ham9yIG11c3QgYmUgZ3JlYXRlciB0aGFuICIKICAgICAgICAgICAgICAgICJub3RpZmljYXRpb25fY3JpdGljYWwuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHNlbGYucGFyYW1zWydwb2xsX2ludGVydmFsJ10udmFsdWUgPD0gMDoKICAgICAgICAgICAgcGFyYW1fZXJyb3JzLmFwcGVuZCgKICAgICAgICAgICAgICAgICJwb2xsX2ludGVydmFsIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAuIgogICAgICAgICAgICApCgogICAgICAgIGlmIChzZWxmLnBhcmFtc1sncG9sbF9pbnRlcnZhbCddLnZhbHVlID4KICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zWydub3RpZmljYXRpb25fY3JpdGljYWwnXS52YWx1ZSk6CiAgICAgICAgICAgIHBhcmFtX2Vycm9ycy5hcHBlbmQoCiAgICAgICAgICAgICAgICAicG9sbF9pbnRlcnZhbCBpcyB0b28gbGFyZ2UuIgogICAgICAgICAgICApCgogICAgICAgIGlmIHBhcmFtX2Vycm9yczoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdQYXJhbWV0ZXIgZXJyb3JzOiB7fScuZm9ybWF0KCcgJy5qb2luKHBhcmFtX2Vycm9ycykpCiAgICAgICAgICAgICkKCiAgICAgICAgIyBwb2xsX2NvdW50ZXIgd2lsbCBpbmNyZWFzZSBpbiBldmVyeSBjaGVjayB0aGF0IHRoZSBjb3VudCBpcyBpbiBtYWpvcgogICAgICAgICMgb3IgY3JpdGljYWwgc3RhdGUuIEl0IHdpbGwgZ2V0IHJlc2V0IHRvIDAgZXZlcnl0aW1lIGEgc3lzbG9nCiAgICAgICAgIyBtZXNzYWdlIGlzIHNlbnQKICAgICAgICBzZWxmLnZhcmlhYmxlc1sicG9sbF9jb3VudGVyIl0gPSBzdHIoMCkKICAgICAgICBzZWxmLnZhcmlhYmxlc1siY3VycmVudF9hbGVydCJdID0gQWxlcnRMZXZlbC5OT05FCgogICAgZGVmIGdldF9yZXF1ZXN0KHNlbGYsIHVybCwgcmV0cnk9MTIsIHdhaXRfYmV0d2Vlbl9yZXRyaWVzPTEwKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdGhhdCB3aWxsIHRyeSB0byBnZXQgdGhlIHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gKICAgICAgICB0aHJvdWdoIGEgcmVzdCByZXF1ZXN0LiBGdW5jdGlvbiB3aWxsIHJldHJ5IHVwIHRvIDIgbWludXRlcyBpbiBjYXNlCiAgICAgICAgdGhlIGRhdGEgaXMgbm90IGF2YWlsYWJsZS4KCiAgICAgICAgOnBhcmFtIHVybDogdXJsIGZvciB0aGUgcmVzdCByZXF1ZXN0CiAgICAgICAgOnBhcmFtIHJldHJ5OiBudW1iZXIgb2YgdGltZXMgZm9yIHRoZSBmdW5jdGlvbiB0byByZXRyeQogICAgICAgIDpwYXJhbSB3YWl0X2JldHdlZW5fcmV0cmllczogaG93IGxvbmcgdG8gc2xlZXAgaW4gYmV0d2VlbiByZXRyaWVzCiAgICAgICAgOnJldHVybiBkaWN0OiBkYXRhIGZyb20gdGhlIHJlc3QgcmVxdWVzdCBpcyByZXR1cm5lZAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICAgICAgaWYgcmV0cnkgPCAyOgogICAgICAgICAgICAgICAgZXJyb3JfbXNnID0gKAogICAgICAgICAgICAgICAgICAgICJVbmFibGUgdG8gYSBwZXJmb3JtIFJFU1QgR0VUIGNhbGwgdG86ICIgKyB1cmwgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIGlmIGludChyLnN0YXR1c19jb2RlKSAhPSAyMDA6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiUkVTVCBjYWxsOiAiICsgdXJsICsgIlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJldHVybmVkIHdpdGggc3RhdHVzIGNvZGU6ICIgKyBzdHIoci5zdGF0dXNfY29kZSkgKyAiXG4iKQogICAgICAgICAgICAgICAgcmFpc2UgTkFFRXhjZXB0aW9uKGVycm9yX21zZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNsZWVwKHdhaXRfYmV0d2Vlbl9yZXRyaWVzKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X3JlcXVlc3QodXJsLCByZXRyeT1yZXRyeS0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9iZXR3ZWVuX3JldHJpZXM9d2FpdF9iZXR3ZWVuX3JldHJpZXMpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IHIuanNvbigpCiAgICAgICAgZXhjZXB0IGpzb24uZGVjb2Rlci5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgIGlmIHJldHJ5IDwgMjoKICAgICAgICAgICAgICAgIGVycm9yX21zZyA9ICgiVW5hYmxlIHRvIGNvbnZlcnQgUkVTVCByZXNwb25zZSBpbnRvIEpTT04gZm9ybWF0LlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRyYWNlYmFjazogIiArIHRyYWNlYmFjay5mb3JtYXRfZXhjKCkpCiAgICAgICAgICAgICAgICByYWlzZSBOQUVFeGNlcHRpb24oZXJyb3JfbXNnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2xlZXAod2FpdF9iZXR3ZWVuX3JldHJpZXMpCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfcmVxdWVzdCh1cmwsIHJldHJ5PXJldHJ5LTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0X2JldHdlZW5fcmV0cmllcz13YWl0X2JldHdlZW5fcmV0cmllcykKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgY2hhbmdlX2FsZXJ0X2xldmVsKHNlbGYsIGFsZXJ0X2xldmVsKToKICAgICAgICAiIiIKICAgICAgICBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGJvdGggdGhlIGFnZW50IHN0YXR1cyBhbmQga2VlcCB0cmFjayBvZgogICAgICAgIHRoZSBzdGF0dXMgd2l0aCB0aGUgbG9jYWwgdmFyaWFibGVzCgogICAgICAgIDpwYXJhbSBhbGVydF9sZXZlbDogYWxlcnRfbGV2ZWwgdG8gYmUgc2V0LCBzaG91bGQgYmUgZnJvbSBjbGFzcyBBbGVydExldmVsCiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHNlbGYuc2V0X2FsZXJ0X2xldmVsKGFsZXJ0X2xldmVsKQogICAgICAgIHNlbGYudmFyaWFibGVzWydjdXJyZW50X2FsZXJ0J10gPSBhbGVydF9sZXZlbAoKICAgIGRlZiByb3V0ZV9jb3VudF9wb2xsZXIoc2VsZiwgZXZlbnQpOgogICAgICAgICIiIgogICAgICAgIE1haW4gYWN0aW9uIGZ1bmN0aW9uOiBHZXRzIHRoZSBjdXJyZW50IHJvdXRlIGNvdW50IG9uIHRoZSBzd2l0Y2gsIGFuZAogICAgICAgIGlmIHRoZSBjb3VudCBpcyBoaWdoZXIgdGhhbiBlaXRoZXIgb2YgdGhlIGxpbWl0cyBkZWZpbmVkLCBpdCB3aWxsCiAgICAgICAgZGV0ZXJtaW5lIGlmIHRoZSBhZ2VudCBpcyBhbHJlYWR5IGluIHRoZSBhY2N1cmF0ZSBzdGF0ZS4gSWYgbm90LAogICAgICAgIHRoZSBhbGVydCBsZXZlbCB3aWxsIGJlIGNoYW5nZWQgYW5kIGEgc3lzbG9nIHdhcm5pbmcgbWVzc2FnZSBzZW50CiAgICAgICAgc3RhdGluZyB0aGUgY2hhbmdlIG9mIHJvdXRlIGNvdW50LiBJZiB0aGUgYWdlbnQgaXMgaW4gdGhlIHJpZ2h0IHN0YXRlLAogICAgICAgIGl0IHdpbGwga2VlcCBjb3VudCBvZiB0aGUgYW1vdW50IG9mIHRpbWVzIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkCiAgICAgICAgdW50aWwgYW5vdGhlciBzeXNsb2cgd2FybmluZyBtZXNzYWdlIHNob3VsZCBiZSBzZW50LgoKICAgICAgICA6cGFyYW0gZXZlbnQ6IE5BRSBldmVudCBkaWN0aW9uYXJ5CiAgICAgICAgOnJldHVybiBOb25lOgogICAgICAgICIiIgogICAgICAgIHVyaSA9ICcvcmVzdC92MS9zeXN0ZW0vdnJmcy8qL3JvdXRlcz9jb3VudCcKICAgICAgICByb3V0ZV9jb3VudCA9IHNlbGYuZ2V0X3JlcXVlc3QoSFRUUF9BRERSRVNTICsgdXJpKVsnY291bnQnXQoKICAgICAgICBjdXJyZW50X2FsZXJ0ID0gc2VsZi52YXJpYWJsZXNbJ2N1cnJlbnRfYWxlcnQnXQogICAgICAgIGNvdW50ZXIgPSBpbnQoc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddKQoKICAgICAgICBsaW1pdF9tYWpvciA9IHNlbGYucGFyYW1zWydsaW1pdF9tYWpvciddLnZhbHVlCiAgICAgICAgbGltaXRfY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbGltaXRfY3JpdGljYWwnXS52YWx1ZQoKICAgICAgICBub3RpZmljYXRpb25fbWFqb3IgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX21ham9yJ10udmFsdWUKICAgICAgICBub3RpZmljYXRpb25fY3JpdGljYWwgPSBzZWxmLnBhcmFtc1snbm90aWZpY2F0aW9uX2NyaXRpY2FsJ10udmFsdWUKICAgICAgICBwb2xsX2ludGVydmFsID0gc2VsZi5wYXJhbXNbJ3BvbGxfaW50ZXJ2YWwnXS52YWx1ZQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgY3JpdGljYWwgbGltaXQKICAgICAgICBpZiByb3V0ZV9jb3VudCA+IGxpbWl0X2NyaXRpY2FsOgogICAgICAgICAgICAjIExldCB0aGUgQ3JpdGljYWwgbW9uaXRvciBydWxlIGhhbmRsZSB0aGlzIGV2ZW50CiAgICAgICAgICAgIGlmICJNYWpvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgY3JpdGljYWwsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLkNSSVRJQ0FMKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgIEFjdGlvblN5c2xvZygKICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgY3JpdGljYWwgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICMgb3RoZXJ3aXNlLCBpbmNyZWFzZSBjb3VudGVyIGFuZCBjaGVjayBpZiBlbm91Z2ggdGltZSBoYXMgcGFzc2VkCiAgICAgICAgICAgICMgZm9yIGFub3RoZXIgc3lzbG9nLiBPbmx5IGRvIHRoaXMgZm9yIHBvbGxpbmcgZXZlbnRzCiAgICAgICAgICAgIGVsaWYgJ1BvbGxlcicgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgIGNvdW50ZXIgKz0gMQogICAgICAgICAgICAgICAgaWYgKGNvdW50ZXIgKiBwb2xsX2ludGVydmFsKSA+PSBub3RpZmljYXRpb25fY3JpdGljYWw6CiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IDAKICAgICAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaXMgc3RpbGwgb3ZlciBjcml0aWNhbCBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCksCiAgICAgICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAjIFJvdXRlIGNvdW50IGlzIG92ZXIgbWFqb3IgbGltaXQgb25seQogICAgICAgIGVsaWYgcm91dGVfY291bnQgPiBsaW1pdF9tYWpvcjoKICAgICAgICAgICAgIyBpZiBjdXJyZW50IGFsZXJ0IGlzbid0IGFscmVhZHkgbWFqb3IsIHNldCBpdCBpbW1lZGlhdGVseQogICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTUFKT1I6CiAgICAgICAgICAgICAgICAjIHN5c2xvZyBtZXNzYWdlIHdpbGwgdmFyeSBkZXBlbmRpbmcgb24gd2hhdCBzdGF0ZSB0aGUgYWdlbnQKICAgICAgICAgICAgICAgICMgaXMgdHJhbnNpdGlvbmluZyBmcm9tCiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2FsZXJ0ID09IEFsZXJ0TGV2ZWwuQ1JJVElDQUw6CiAgICAgICAgICAgICAgICAgICAgaWYgIk1vbml0b3IiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICAgICAgICAgICMgTW9uaXRvciBydWxlIHNob3VsZCBvbmx5IFVQR1JBREUgdGhlIHN0YXRlLCBub3QgZG93bmdyYWRlCiAgICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBldmVudCB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG5leHQgcG9sbGVyIGV2ZW50CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAoCiAgICAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50IHJvdXRlIGNvdW50ICh7fSkgaGFzIGRyb3BwZWQgYmVsb3cgdGhlIGNyaXRpY2FsICIKICAgICAgICAgICAgICAgICAgICAgICAgImxpbWl0ICh7fSksIGJ1dCBpcyBzdGlsbCBvdmVyIHRoZSBtYWpvciBsaW1pdCAoe30pIgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHJvdXRlX2NvdW50LCBsaW1pdF9jcml0aWNhbCwgbGltaXRfbWFqb3IpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGhhcyBwYXNzZWQgdGhlIG1ham9yIGxpbWl0ICh7fSkiCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQsIGxpbWl0X21ham9yKQogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZV9hbGVydF9sZXZlbChBbGVydExldmVsLk1BSk9SKQogICAgICAgICAgICAgICAgY291bnRlciA9IDAKCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2cobWVzc2FnZSwgc2V2ZXJpdHk9U1lTTE9HX1dBUk5JTkcpCgogICAgICAgICAgICAjIG90aGVyd2lzZSwgaW5jcmVhc2UgY291bnRlciBhbmQgY2hlY2sgaWYgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZAogICAgICAgICAgICAjIGZvciBhbm90aGVyIHN5c2xvZy4gT25seSBkbyB0aGlzIGZvciBwb2xsaW5nIGV2ZW50cwogICAgICAgICAgICBlbGlmICJQb2xsZXIiIGluIGV2ZW50WyJydWxlX2Rlc2NyaXB0aW9uIl06CiAgICAgICAgICAgICAgICBjb3VudGVyICs9IDEKICAgICAgICAgICAgICAgIGlmIChjb3VudGVyICogcG9sbF9pbnRlcnZhbCkgPj0gbm90aWZpY2F0aW9uX21ham9yOgogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICAgICAgQWN0aW9uU3lzbG9nKAogICAgICAgICAgICAgICAgICAgICAgICAiQ3VycmVudCByb3V0ZSBjb3VudCAoe30pIGlzIHN0aWxsIG92ZXIgbWFqb3IgbGltaXQgKHt9KSIKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChyb3V0ZV9jb3VudCwgbGltaXRfbWFqb3IpLAogICAgICAgICAgICAgICAgICAgICAgICBzZXZlcml0eT1TWVNMT0dfV0FSTklORwogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgIyBSb3V0ZSBjb3VudCBpcyB1bmRlciB0aGUgZGVmaW5lZCBsaW1pdHMKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAiTW9uaXRvciIgaW4gZXZlbnRbInJ1bGVfZGVzY3JpcHRpb24iXToKICAgICAgICAgICAgICAgICMgT25seSBhbGxvdyBwb2xsZXIgdG8gaGFuZGxlIHRoaXMgZXZlbnQKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZWxpZiBjdXJyZW50X2FsZXJ0ICE9IEFsZXJ0TGV2ZWwuTk9ORToKICAgICAgICAgICAgICAgIHNlbGYuY2hhbmdlX2FsZXJ0X2xldmVsKEFsZXJ0TGV2ZWwuTk9ORSkKICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICBBY3Rpb25TeXNsb2coCiAgICAgICAgICAgICAgICAgICAgIkN1cnJlbnQgcm91dGUgY291bnQgKHt9KSBoYXMgZHJvcHBlZCBiZWxvdyBhbGwgbGltaXRzIgogICAgICAgICAgICAgICAgICAgIC5mb3JtYXQocm91dGVfY291bnQpLAogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5PVNZU0xPR19XQVJOSU5HCiAgICAgICAgICAgICAgICApCiAgICAgICAgc2VsZi52YXJpYWJsZXNbJ3BvbGxfY291bnRlciddID0gc3RyKGNvdW50ZXIpCg==
nae-agent Routing_BGP_Agent_Monitor Routing_BGP_Agent_Monitor false cpu_threshold:ODA= cpu_time_interval:NjA= cpu_cooldown_interval:MzAw poll_interval:NjA= vrf:ZGVmYXVsdA== bgp_neighbor:Kg==
nae-agent route_count_monitor route_count_monitor false limit_critical:NDgwMDA= notification_major:MzM2 notification_critical:MTIw limit_major:MzIwMDA= poll_interval:NA==
nae-agent system_resource_monitor system_resource_monitor.default true
dhcp-server vrf default
    no authoritative
    disable

! TEMPLATE NAME: FW VERSION 13 6300_us_mdf -- VERSION: 105 -- PILOT_BRANCH
